{"version":3,"sources":["../../src/charts/SeriaBuilder.js"],"names":["findMinY","seriaFns","C","SERIA","visible","marker","symbol","AREA_RANGE","type","color","fillColor","linearGradient","x1","x2","y1","y2","stops","radius","TREE_MAP","layoutAlgorithm","borderColor","dataLabels","align","verticalAlign","style","fontFamily","fontSize","fontWeight","textShadow","states","hover","brightness","SCATTER","_isArr","Array","isArray","_isObj","obj","_crLegendItem","index","name","is","isVisible","_addSeriesImpl","to","series","_legend","forEach","seria","zhValueText","push","SeriaBuilder","initSeria","option","_type","config","ChartConfig","crSeria","splineSeria","_seria","CONFIG","tooltip","add","Chart","fTooltip","areaRangeSeria","treeMapSeria","scatterSeria","stockSeria","id","data","minY","addPoints","addSeriaBy","Object","assign","addSeriaTo","_addSeriaPoints","points","maxVisible","getColor","seriaName","length","addLegend","_addPointsToConfig","text","clearSeries","addSeries","isWithoutLegend","_to","toSeria"],"mappings":"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","sourcesContent":["import seriaFns from '../math/seriaFn'\r\n\r\nimport Chart from './Chart'\r\nimport ChartConfig from './ChartConfig'\r\n\r\nconst { findMinY } = seriaFns\r\n\r\nconst C = {\r\n  SERIA: {\r\n     //type: 'spline',\r\n     visible: true,\r\n     marker: {\r\n       symbol: 'circle'\r\n     }\r\n  },\r\n  AREA_RANGE: {\r\n    type: 'arearange',\r\n    color: '#7cb5ec',\r\n    fillColor: {\r\n      linearGradient: { x1: 0, x2: 0, y1: 0, y2: 1 },\r\n      stops: [\r\n         [0, \"rgba(69, 114, 167, 1)\"],\r\n         [1, \"rgba(2, 0, 0, 0)\"]\r\n      ]\r\n    },\r\n    marker: {\r\n      radius: 0\r\n    }\r\n  },\r\n  TREE_MAP: {\r\n        type : 'treemap',\r\n        layoutAlgorithm: 'squarified',\r\n        //layoutAlgorithm : 'sliceAndDice',\r\n        borderColor : 'gray',\r\n        dataLabels : {\r\n          align : 'left',\r\n          verticalAlign : 'top',\r\n          style : {\r\n            fontFamily: '\"Roboto\", \"Arial\", \"Lato\", sans-serif',\r\n            fontSize: '14px',\r\n            fontWeight: 'bold',\r\n            color : 'black',\r\n            textShadow: 'none'\r\n          }\r\n        },\r\n        //data : data,\r\n        states : {\r\n          hover : {\r\n            borderColor : 'yellow',\r\n            brightness: 0\r\n          }\r\n        }\r\n    },\r\n    SCATTER: {\r\n      type: 'scatter'\r\n    }\r\n};\r\n\r\nconst _isArr = Array.isArray;\r\nconst _isObj = obj => obj && typeof obj === 'object';\r\n\r\nconst _crLegendItem = ({ index, color, name, is=false }) => ({\r\n  index, color, name,\r\n  isVisible: is\r\n});\r\n\r\nconst _addSeriesImpl = (to, series) => {\r\n  const _legend = [];\r\n  series.forEach((seria, index) => {\r\n    const { color, zhValueText='', visible } = seria;\r\n    to.push(seria)\r\n    _legend.push(_crLegendItem({\r\n       index, color, name:zhValueText, is:visible\r\n     }))\r\n  })\r\n  return _legend;\r\n}\r\n\r\nconst SeriaBuilder = {\r\n\r\n  initSeria(option){\r\n    this._type = 'S'\r\n    this.config = ChartConfig.crSeria(option)\r\n    return this;\r\n  },\r\n  splineSeria(option){\r\n    return this.initSeria({ ...C.SERIA, ...option });\r\n  },\r\n  _seria(CONFIG, tooltip, option){\r\n    this._type = 'S'\r\n    this.config = { ...CONFIG, ...option }\r\n    this.add('tooltip', Chart.fTooltip(tooltip))\r\n    return this;\r\n  },\r\n  areaRangeSeria(tooltip, option){\r\n    return this._seria(C.AREA_RANGE, tooltip, option);\r\n  },\r\n  treeMapSeria(tooltip, option){\r\n    return this._seria(C.TREE_MAP, tooltip, option);\r\n  },\r\n  scatterSeria(tooltip, option){\r\n    return this._seria(C.SCATTER, tooltip, option);\r\n  },\r\n  stockSeria(id, data){\r\n    return this\r\n      .initSeria({ minY: findMinY(data) })\r\n      .addPoints(id, data);\r\n  },\r\n\r\n  addSeriaBy(index, obj) {\r\n    if (this.config.series[index]) {\r\n      Object.assign(this.config.series[index], obj)\r\n    } else {\r\n      this.config.series.push(obj)\r\n    }\r\n    return this;\r\n  },\r\n  addSeriaTo(index, seria) {\r\n    this.config.series[index] = seria\r\n    return this;\r\n  },\r\n\r\n  _addSeriaPoints(points, { maxVisible=6 }={}){\r\n    const _legend = [];\r\n    points.forEach((data, index) => {\r\n      const is = index<maxVisible ? true : false\r\n          , color = ChartConfig.getColor(index)\r\n          , { seriaName } = data;\r\n      _legend.push(_crLegendItem({\r\n        index, color, name: seriaName, is\r\n      }))\r\n      this.addSeriaBy(index, {\r\n           type: 'spline',\r\n           data: data,\r\n           name: seriaName,\r\n           zhValueText: seriaName,\r\n           visible: is\r\n        })\r\n    })\r\n    if (_legend.length !== 0){\r\n      this.addLegend(_legend);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  _addPointsToConfig(points){\r\n    if (points[0]\r\n        && _isArr(points[0])\r\n        && points[0][0]\r\n        && typeof points[0][0] !== 'number'\r\n    ) {\r\n      this._addSeriaPoints(points)\r\n    } else {\r\n      this.addSeriaBy(0, {\r\n         type: 'spline',\r\n         data: points\r\n      });\r\n    }\r\n  },\r\n\r\n  addPoints(id, points, text){\r\n    if (this._type !== 'S') {\r\n      this._addPointsToConfig(points)\r\n    } else {\r\n      this.add({\r\n        data: points,\r\n        zhValueText: text ? text : id\r\n      })\r\n    }\r\n    return this;\r\n  },\r\n\r\n  clearSeries(){\r\n    this.config.series = []\r\n    return this;\r\n  },\r\n\r\n  addSeries(series, isWithoutLegend=false){\r\n    const _to =_isArr(this.config.series)\r\n       ? this.config.series\r\n       : this.config.series = [];\r\n    if (_isArr(series)){\r\n      const _legend = _addSeriesImpl(_to, series);\r\n      if (!isWithoutLegend) {\r\n        this.addLegend(_legend)\r\n      }\r\n    } else if (_isObj(series)) {\r\n      _to[0] = series\r\n    }\r\n    return this;\r\n  },\r\n\r\n  toSeria(){\r\n    return this.config;\r\n  }\r\n\r\n}\r\n\r\nexport default SeriaBuilder\r\n"],"file":"SeriaBuilder.js"}