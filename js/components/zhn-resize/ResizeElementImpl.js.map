{"version":3,"sources":["../../../src/components/zhn-resize/ResizeElementImpl.js"],"names":["_isFn","fn","_isNaN","Number","isNaN","_assign","Object","assign","_initResizeProperties","inst","id","deltaStep","countStep","ResizeElementImpl","constructor","elementRef","initWidth","minWidth","maxWidth","step","onResizeAfter","_increaseDeltaStep","maxDelta","delta","minDelta","_getElementStyle","current","style","_setElementWidth","width","_getElementWidth","parseInt","_onResizeAfter","clearInterval","toWidth","isOnResizeAfter","resizeBy","hStopResize","hKdLeft","event","stopPropagation","_resizeLeft","hKdRight","_resizeRight","_updateDelta","w","_startResize","fnResize","_stopResize","setInterval","hStartResizeLeft","bind","hStartResizeRight"],"mappings":"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","sourcesContent":["import isKeyEnter from '../zhn/isKeyEnter';\r\n\r\nconst _isFn = fn => typeof fn === 'function'\r\n, _isNaN = Number.isNaN\r\n, _assign = Object.assign\r\n, _initResizeProperties = inst => {\r\n  _assign(inst, {\r\n    id: null,\r\n    deltaStep: 1,\r\n    countStep: 0\r\n  })\r\n};\r\n\r\nclass ResizeElementImpl {\r\n\r\n  constructor({\r\n    elementRef,\r\n    initWidth,\r\n    minWidth,\r\n    maxWidth,\r\n    step=10,\r\n    onResizeAfter\r\n  }){\r\n    this.elementRef = elementRef\r\n    this.step = step\r\n    this.onResizeAfter = onResizeAfter\r\n\r\n    this.initWidth = initWidth\r\n    this.minWidth = minWidth\r\n    this.maxWidth = maxWidth\r\n    this.minDelta = minWidth - initWidth\r\n    this.maxDelta = maxWidth - initWidth\r\n\r\n    this.delta = 0;\r\n    _initResizeProperties(this)\r\n\r\n    this.hStartResizeLeft = this._startResize.bind(null, this._resizeLeft)\r\n    this.hStartResizeRight = this._startResize.bind(null, this._resizeRight)\r\n  }\r\n\r\n  _increaseDeltaStep = () => {\r\n    this.countStep +=1;\r\n    if (this.countStep > 30){\r\n      this.deltaStep = 3;\r\n    } else if (this.countStep > 15){\r\n      this.deltaStep = 2;\r\n    }\r\n    if ( (this.maxDelta - this.delta) < 20 ||\r\n         (this.delta - this.minDelta) < 20) {\r\n      this.deltaStep = 1;\r\n    }\r\n  }\r\n\r\n  _getElementStyle = () => {\r\n    const { current } = this.elementRef || {}\r\n    , { style } = current || {};\r\n    return style || {};\r\n  }\r\n\r\n  _setElementWidth = (width) => {\r\n    this._getElementStyle().width = width + 'px';\r\n  }\r\n\r\n  _getElementWidth = () => {\r\n    return parseInt(this._getElementStyle().width, 10)\r\n  }\r\n\r\n  _onResizeAfter = () => {\r\n    const { onResizeAfter } = this;\r\n    if (_isFn(onResizeAfter)) {\r\n      onResizeAfter(this._getElementWidth());\r\n    }\r\n  }\r\n\r\n  clearInterval = () => {\r\n    clearInterval(this.id)\r\n  }\r\n\r\n  toWidth = (width, isOnResizeAfter) => {\r\n    const {\r\n      minWidth,\r\n      maxWidth,\r\n      initWidth\r\n    } = this;\r\n    if (width >= minWidth && width <= maxWidth) {\r\n      this.delta = width - initWidth\r\n      this._setElementWidth(width)\r\n      if (isOnResizeAfter) {\r\n        this._onResizeAfter()\r\n      }\r\n    }\r\n  }\r\n\r\n  resizeBy = (step) => {\r\n    if ( (step < 0 && this.delta > this.minDelta)\r\n      || (step > 0 && this.delta < this.maxDelta) ) {\r\n      this.delta += step;\r\n      this._setElementWidth(this.initWidth + this.delta)\r\n    } else {\r\n      this.hStopResize()\r\n    }\r\n  }\r\n\r\n  hKdLeft = (event) => {\r\n    if (isKeyEnter(event)) {\r\n      event.stopPropagation()\r\n      this.resizeBy(-this.step)\r\n    }\r\n  }\r\n  _resizeLeft = () => {\r\n     this.resizeBy(-this.deltaStep)\r\n     this._increaseDeltaStep();\r\n  }\r\n  hKdRight = (event) => {\r\n    if (isKeyEnter(event)) {\r\n      event.stopPropagation()\r\n      this.resizeBy(this.step)\r\n    }\r\n  }\r\n  _resizeRight = () => {\r\n    this.resizeBy(this.deltaStep)\r\n    this._increaseDeltaStep();\r\n  }\r\n\r\n  _updateDelta = () => {\r\n    const w = parseInt(this._getElementStyle().width, 10);\r\n    if (!_isNaN(w)) {\r\n      this.delta = w - this.initWidth\r\n    }\r\n  }\r\n\r\n  _startResize = (fnResize) => {\r\n    if (this.id !== null){\r\n      this._stopResize();\r\n    }\r\n    this._updateDelta()\r\n    this.id = setInterval(fnResize, 5);\r\n  }\r\n\r\n  _stopResize = () => {\r\n    this.clearInterval()\r\n    _initResizeProperties(this)\r\n  }\r\n\r\n  hStopResize = () => {\r\n    this._stopResize()\r\n    this._onResizeAfter()\r\n  }\r\n}\r\n\r\nexport default ResizeElementImpl\r\n"],"file":"ResizeElementImpl.js"}