{"version":3,"sources":["../../../src/components/zhn-table/Table.jsx"],"names":["CL_LINK","CL_GRID","TOKEN_NAN","C","UP","DOWN","ASC","DESC","_crLinkEl","id","title","fn","_href","undefined","Table","props","_hSort","pn","setState","prevState","rows","sortBy","sortTo","_compBy","F","compBy","_rows","_sortTo","sort","opCompBy","_hThKeyPressed","evt","preventDefault","which","_hToggleMoreStyle","stopPropagation","isMoreStyle","_hCheckGridLine","isGridLine","_hUnCheckGridLine","_renderHeader","gridId","thMoreStyle","headers","state","map","h","hIndex","name","FN","crAppearance","S","style","ariaSort","ariaLabel","_elMore1","SVG_MORE","_thStyle","TH","bind","_renderRows","tableFn","numberFormat","valueToHref","r","rIndex","_elTd","isR","isHref","_key","v","_v","toFormatValue","_tdStyle","crTdStyle","_elValueOrTitle","TD","render","className","_className","ROOT","THEAD","STYLE_MORE","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport SvgMore from '../zhn/SvgMore'\r\nimport StylePopup from './StylePopup'\r\n\r\nimport F from './compFactory'\r\nimport FN from './tableFn'\r\nimport S from './Style'\r\n\r\nconst CL_LINK = \"native-link\";\r\nconst CL_GRID = \"grid\";\r\nconst TOKEN_NAN = 'â€•';\r\n\r\nconst C = {\r\n  UP: 'UP',\r\n  DOWN: 'DOWN',\r\n\r\n  ASC: 'ascending',\r\n  DESC: 'descending'\r\n};\r\n\r\nconst _crLinkEl = (id, title, fn) => {\r\n  const _href = (typeof fn === 'function')\r\n           ? fn(id)\r\n           : undefined;\r\n  return (\r\n    <a\r\n      className={CL_LINK}\r\n      href={_href}\r\n    >\r\n      {title}\r\n    </a>\r\n  );\r\n};\r\n\r\n\r\nclass Table extends Component {\r\n  /*\r\n  static propTypes = {\r\n    gridId: PropTypes.string,\r\n    thMoreStyle: PropTypes.object,\r\n    rows: PropTypes.array,\r\n    headers: PropTypes.arrayOf(\r\n       PropTypes.shape({\r\n        name: PropTypes.string,\r\n        pn: PropTypes.string,\r\n        isR: PropTypes.bool,\r\n        isF: PropTypes.bool,\r\n        isHref: PropTypes.bool,\r\n        style: PropTypes.object\r\n      })\r\n    ),\r\n    tableFn: PropTypes.shape({\r\n       numberFormat: PropTypes.func,\r\n       valueToHref: PropTypes.func\r\n    })\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    className: '',\r\n    rows: [],\r\n    headers: [],\r\n    tableFn: {}\r\n  }\r\n\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      isGridLine: true,\r\n      rows: props.rows,\r\n      sortBy: void 0,\r\n      sortTo: void 0,\r\n      isMoreStyle: false\r\n    }\r\n  }\r\n\r\n _hSort = (pn) => {\r\n   this.setState(prevState => {\r\n     const { rows, sortBy, sortTo } = prevState\r\n         , _compBy = F.compBy(TOKEN_NAN, pn)\r\n    let _rows, _sortTo;\r\n    if (pn === sortBy && sortTo === C.UP) {\r\n      _rows = rows.sort(F.opCompBy(pn, _compBy))\r\n      _sortTo = C.DOWN\r\n    } else {\r\n      _rows = rows.sort(_compBy)\r\n      _sortTo = C.UP\r\n    }\r\n    return {\r\n       rows: _rows,\r\n       sortBy: pn,\r\n       sortTo: _sortTo\r\n     };\r\n   })\r\n }\r\n _hThKeyPressed = (pn, evt) => {\r\n   evt.preventDefault()\r\n   const { which } = evt;\r\n   if ( which === 13 || which === 32) {\r\n     this._hSort(pn)\r\n   }\r\n }\r\n\r\n _hToggleMoreStyle = (evt) => {\r\n   evt.stopPropagation()\r\n   this.setState(prevState => {\r\n     return {\r\n       isMoreStyle: !prevState.isMoreStyle\r\n     };\r\n   })\r\n }\r\n\r\n _hCheckGridLine = () => {\r\n   this.setState({ isGridLine: true })\r\n }\r\n _hUnCheckGridLine = () => {\r\n   this.setState({ isGridLine: false })\r\n }\r\n\r\n\r\n  _renderHeader = () => {\r\n    const { gridId, thMoreStyle, headers } = this.props\r\n        , { sortBy, sortTo } = this.state;\r\n    return headers.map((h, hIndex) => {\r\n      const { name, pn } = h\r\n          , {\r\n              style,\r\n              ariaSort, ariaLabel\r\n            } = FN.crAppearance({\r\n                  S, C, pn, name, sortBy, sortTo\r\n                })\r\n          , _elMore1 = hIndex === 0\r\n                ? <SvgMore svgStyle={S.SVG_MORE} onClick={this._hToggleMoreStyle}/>\r\n                : null\r\n          , _thStyle = hIndex === 0\r\n                ? thMoreStyle\r\n                : null;\r\n\r\n      return (\r\n        <th\r\n          key={h.name}\r\n          style={{...S.TH, ..._thStyle, ...style }}\r\n          rowSpan=\"1\"\r\n          colSpan=\"1\"\r\n          tabIndex=\"0\"\r\n          arial-controls={gridId}\r\n          aria-label={ariaLabel}\r\n          aria-sort={ariaSort}\r\n          onClick={this._hSort.bind(null, pn)}\r\n          onKeyPress={this._hThKeyPressed.bind(null, pn)}\r\n        >\r\n          {_elMore1}\r\n          {name}\r\n        </th>\r\n      );\r\n    });\r\n  }\r\n\r\n  _renderRows = () => {\r\n    const { headers, tableFn } = this.props\r\n         , {\r\n             numberFormat,\r\n             valueToHref\r\n           } = tableFn\r\n         , { rows } = this.state;\r\n\r\n    return rows.map((r, rIndex) => {\r\n      const _elTd = headers.map((h, hIndex) => {\r\n        const { pn, style, isR, isHref } = h\r\n            , _key = r.id+hIndex\r\n            , v = r[pn]\r\n            , _v = FN.toFormatValue({ TOKEN_NAN, h, v, fn: numberFormat })\r\n            , _tdStyle = FN.crTdStyle({ S, v, isR })\r\n            , _elValueOrTitle = isHref\r\n                  ? _crLinkEl(r.id, _v, valueToHref)\r\n                  : _v;\r\n        return (\r\n          <td\r\n            key={_key}\r\n            style={{...S.TD, ...style, ..._tdStyle}}\r\n          >\r\n            {_elValueOrTitle}\r\n          </td>\r\n        );\r\n      })\r\n      return (\r\n        <tr key={r.id} role=\"row\">\r\n          {_elTd}\r\n        </tr>\r\n      );\r\n    });\r\n  }\r\n\r\n  render(){\r\n    const { gridId, className } = this.props\r\n        , { isGridLine, isMoreStyle } = this.state\r\n        , _className = isGridLine\r\n               ? CL_GRID\r\n               : '';\r\n    return (\r\n      <table\r\n        className={`${_className} ${className}`}\r\n        id={gridId}\r\n        style={S.ROOT}\r\n        role=\"grid\"\r\n      >        \r\n        <thead style={S.THEAD}>\r\n           <tr>\r\n             {this._renderHeader()}\r\n           </tr>\r\n           <StylePopup\r\n             isShow={isMoreStyle}\r\n             style={S.STYLE_MORE}\r\n             onClose={this._hToggleMoreStyle}\r\n             isGridLine={isGridLine}\r\n             onCheck={this._hCheckGridLine}\r\n             onUnCheck={this._hUnCheckGridLine}\r\n           />\r\n        </thead>\r\n        <tbody>\r\n          {this._renderRows()}\r\n        </tbody>\r\n      </table>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Table\r\n"],"file":"Table.js"}