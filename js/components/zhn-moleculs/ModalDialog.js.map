{"version":3,"sources":["../../../src/components/zhn-moleculs/ModalDialog.jsx"],"names":["TH_ID","CL","MD","SHOWING","HIDING","S","STYLE","ROOT_DIV_MODAL","display","position","top","left","width","marginLeft","zIndex","HIDE_POPUP","opacity","transform","ModalDialog","props","wasClosing","_renderCommandButton","commandButtons","withoutClose","COMMAND_DIV","BT_ROOT","_hClose","_rootNode","_refRootNode","bind","_hKeyDown","componentDidMount","focus","_hasHiddenStill","nextProps","isShow","shouldComponentUpdate","nextState","isNotUpdate","_hasShowed","prevProps","componentDidUpdate","prevState","setTimeout","setState","timeout","_hClick","event","stopPropagation","evt","preventDefault","onClose","focusPrev","n","render","theme","isWithButton","style","caption","styleCaption","children","TS","getStyle","_className","_style","HIDE","SHOW","ROOT_DIV","ROOT","EL_BORDER","CAPTION_DIV","EL","SVG_CLOSE","_prevFocused","document","activeElement","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport withThemeRef from '../hoc/withThemeRef'\r\n\r\nimport {\r\n  isKeyEscape,\r\n  focusNode\r\n} from '../zhn-utils/utils'\r\n\r\nimport SvgClose from '../zhn/SvgClose'\r\nimport FlatButton from '../zhn-m/FlatButton'\r\n\r\nimport STYLE from './Dialog.Style'\r\n\r\nconst TH_ID = 'MODAL_DIALOG';\r\n\r\nconst CL = {\r\n  MD: 'modal-dialog',\r\n  SHOWING: 'show-popup',\r\n  HIDING: 'hide-popup'\r\n};\r\n\r\nconst S = {\r\n  ...STYLE,\r\n  ROOT_DIV_MODAL: {\r\n    display: 'block',\r\n    position: 'absolute',\r\n    top: '20%',\r\n    //left: '30%',\r\n    left: '50%',\r\n    width: 380,\r\n    marginLeft: -190,    \r\n    zIndex: 10\r\n  },\r\n  HIDE_POPUP: {\r\n    opacity: 0,\r\n    transform: 'scaleY(0)'\r\n  },\r\n};\r\n\r\nclass ModalDialog extends Component {\r\n  /*\r\n   static propTypes = {\r\n     isShow: PropTypes.bool,\r\n     isWithButton: PropTypes.bool,\r\n     isNotUpdate: PropTypes.bool,\r\n     withoutClose: PropTypes.bool,\r\n     style: PropTypes.object,\r\n     caption: PropTypes.string,\r\n     timeout: PropTypes.number,\r\n     commandButtons: PropTypes.arrayOf(PropTypes.element),\r\n     onClose: PropTypes.func\r\n   }\r\n   */\r\n   static defaultProps = {\r\n     isWithButton: true,\r\n     isNotUpdate: false,\r\n     timeout: 450,\r\n     onClose: () => {}\r\n   }\r\n\r\n   wasClosing = false\r\n\r\n   constructor(props){\r\n     super(props)\r\n\r\n     this.wasClosing = false\r\n\r\n     this._rootNode = null\r\n     this._refRootNode = this._refRootNode.bind(this)\r\n\r\n     this._hKeyDown = this._hKeyDown.bind(this)\r\n     this._hClose = this._hClose.bind(this)\r\n   }\r\n\r\n   componentDidMount(){\r\n     this.focus()\r\n   }\r\n\r\n\r\n   _hasHiddenStill(nextProps) {\r\n     return !this.props.isShow\r\n       && !nextProps.isShow\r\n   }\r\n\r\n   shouldComponentUpdate(nextProps, nextState){\r\n     if (nextProps !== this.props){\r\n       if (nextProps.isNotUpdate\r\n          || this._hasHiddenStill(nextProps) ){\r\n         return false;\r\n       }\r\n     }\r\n     return true;\r\n   }\r\n\r\n   _hasShowed(prevProps){\r\n      return !prevProps.isShow\r\n        && this.props.isShow;\r\n    }\r\n\r\n   componentDidUpdate(prevProps, prevState){\r\n     if (this.wasClosing){\r\n       setTimeout(\r\n         () => { this.setState({}) },\r\n         this.props.timeout\r\n       )\r\n     } else if (this._hasShowed(prevProps)) {\r\n       this.focus()\r\n     }\r\n   }\r\n\r\n  _hClick(event) {\r\n    event.stopPropagation()\r\n   }\r\n\r\n  _hKeyDown(evt) {\r\n    if ( isKeyEscape(evt) ) {\r\n      evt.preventDefault()\r\n      evt.stopPropagation()\r\n      this._hClose()\r\n    }\r\n  }\r\n\r\n  _hClose() {\r\n     this.props.onClose()\r\n     this.focusPrev()\r\n  }\r\n\r\n  _renderCommandButton = () => {\r\n    const {\r\n      commandButtons,\r\n      withoutClose\r\n    } = this.props;\r\n    return (\r\n      <div style={S.COMMAND_DIV}>\r\n        {commandButtons}\r\n        { !withoutClose &&\r\n            <FlatButton\r\n              key=\"close\"\r\n              rootStyle={S.BT_ROOT}\r\n              caption=\"Close\"\r\n              title=\"Close Modal Dialog\"\r\n              onClick={this._hClose}\r\n            />\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  _refRootNode(n) {\r\n    this._rootNode = n\r\n  }\r\n\r\n  render(){\r\n    const {\r\n      theme,\r\n      isShow, isWithButton, style,\r\n      caption, styleCaption,\r\n      children\r\n    } = this.props\r\n    , TS = theme.getStyle(TH_ID);\r\n\r\n    let _className, _style;\r\n\r\n    if (this.wasClosing){\r\n      _style = S.HIDE\r\n      this.wasClosing = false\r\n    } else {\r\n      _className = isShow ? CL.SHOWING : CL.HIDING\r\n      _style = isShow ? S.SHOW : S.HIDE_POPUP\r\n      if (!isShow){\r\n        this.wasClosing = true\r\n      }\r\n    }\r\n    return (\r\n      /*eslint-disable jsx-a11y/no-noninteractive-element-interactions*/\r\n       <div\r\n          ref={this._refRootNode}\r\n          role=\"dialog\"\r\n          tabIndex=\"-1\"\r\n          aria-label={caption}\r\n          aria-hidden={!isShow}\r\n          className={`${CL.MD} ${_className}`}\r\n          style={{\r\n            ...S.ROOT_DIV, ...S.ROOT_DIV_MODAL,\r\n            ...style, ..._style,\r\n            ...TS.ROOT, ...TS.EL_BORDER\r\n          }}\r\n          onClick={this._hClick}\r\n          onKeyDown={this._hKeyDown}\r\n       >\r\n      {/*eslint-enable jsx-a11y/no-noninteractive-element-interactions*/}\r\n           <div style={{...S.CAPTION_DIV, ...TS.EL}}>\r\n              <span style={styleCaption}>{caption}</span>\r\n              <SvgClose\r\n                style={S.SVG_CLOSE}\r\n                onClose={this._hClose}\r\n              />\r\n           </div>\r\n           <div>\r\n             {children}\r\n           </div>\r\n          {isWithButton && this._renderCommandButton()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  focus() {\r\n    this._prevFocused = document.activeElement\r\n    focusNode(this._rootNode)\r\n  }\r\n\r\n  focusPrev() {\r\n    focusNode(this._prevFocused)\r\n    this._prevFocused = null\r\n  }\r\n}\r\n\r\nexport default withThemeRef(ModalDialog)\r\n"],"file":"ModalDialog.js"}