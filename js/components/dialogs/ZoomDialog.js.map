{"version":3,"sources":["../../../src/components/dialogs/ZoomDialog.jsx"],"names":["S_DIALOG","width","marginLeft","S_DATE","_isFn","fn","_getFromToDates","chart","zhGetFromToDates","format","mlsToDmy","_getMinYear","strDmy","split","_crErrMsg","minYear","ZoomDialog","Component","constructor","props","_getChart","data","onClose","_hZoom","zhZoomX","_dates","getValidation","isValid","fromDate","toDate","getValues","from","to","_hZoomBy","month","_fromMls","getTime","_toMls","setFromTo","_hZoomYTD","_refDates","c","_hZoom1M","bind","_hZoom3M","_hZoom6M","_hZoom1Y","_commandButtons","shouldComponentUpdate","nextProps","nextState","isShow","render","_minYear","_onTestDate","str","_errMsgDateFrom","id","zhGetId","_isDaily","zhIsDaily","isDmyPeriod","defaultProps"],"mappings":"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","sourcesContent":["import { Component } from 'react'\r\n\r\nimport {\r\n  isDmy,\r\n  dmyToUTC,\r\n  isDmyPeriod,\r\n  mlsToDmy,\r\n  addToDmy,\r\n  getYTDfromDmy\r\n} from '../../utils/DateUtils';\r\n\r\nimport ModalDialog from '../zhn-moleculs/ModalDialog';\r\nimport D from './DialogCell';\r\nimport ZoomDailyRow from './ZoomDailyRow'\r\n\r\nconst S_DIALOG = {\r\n  width: 244,\r\n  marginLeft: -122\r\n}\r\n, S_DATE = { width: 120 };\r\n\r\nconst _isFn = fn => typeof fn === 'function';\r\n\r\nconst _getFromToDates = (chart) => chart\r\n  .zhGetFromToDates?.({ format: mlsToDmy })\r\n  ?? {};\r\n\r\nconst _getMinYear = (strDmy) => strDmy.split('-')[2];\r\nconst _crErrMsg = minYear => `DD-MM-YYYY format must be, min 01-01-${minYear}`;\r\n\r\nclass ZoomDialog extends Component {\r\n  /*\r\n  static propTypes = {\r\n    isShow: PropTypes.bool,\r\n    data: PropTypes.object,\r\n    onClose: PropTypes.func\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    data: {}\r\n  }\r\n\r\n  constructor(props){\r\n    super(props)\r\n\r\n    this._hZoom1M = this._hZoomBy.bind(null, -1)\r\n    this._hZoom3M = this._hZoomBy.bind(null, -3)\r\n    this._hZoom6M = this._hZoomBy.bind(null, -6)\r\n    this._hZoom1Y = this._hZoomBy.bind(null, -12)\r\n\r\n    this._commandButtons = [\r\n      <D.Button.Flat\r\n         key=\"zoom\"\r\n         caption=\"Zoom\"\r\n         isPrimary={true}\r\n         onClick={this._hZoom}\r\n      />\r\n    ]\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if (nextProps !== this.props\r\n      && nextProps.isShow === this.props.isShow) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  _getChart = () => {\r\n    const { data, onClose } = this.props\r\n    , { chart={} } = data;\r\n    return { chart, onClose };\r\n  }\r\n\r\n  _hZoom = () => {\r\n    const { chart, onClose } = this._getChart();\r\n    if ( _isFn(chart.zhZoomX)\r\n         && this._dates.getValidation().isValid ) {\r\n      const { fromDate, toDate } = this._dates.getValues()\r\n      , from = dmyToUTC(fromDate)\r\n      , to = dmyToUTC(toDate);\r\n      chart.zhZoomX({ from, to })\r\n    }\r\n    onClose()\r\n  }\r\n\r\n  _hZoomBy = (month) => {\r\n    const { chart } = this._getChart();\r\n    if (_isFn(chart.zhZoomX)) {\r\n      const { to } = _getFromToDates(chart)\r\n      , _fromMls = addToDmy(to, month).getTime()\r\n      , _toMls = dmyToUTC(to);\r\n      if (chart.zhZoomX({\r\n        from: _fromMls,\r\n        to: _toMls\r\n      })) {\r\n        this._dates.setFromTo(mlsToDmy(_fromMls), to)\r\n      }\r\n    }\r\n  }\r\n\r\n  _hZoomYTD = () => {\r\n    const { chart } = this._getChart()\r\n    if (_isFn(chart.zhZoomX)) {\r\n      const { to } = _getFromToDates(chart)\r\n      , _fromMls = getYTDfromDmy(to)\r\n      , _toMls = dmyToUTC(to);\r\n      if (chart.zhZoomX({\r\n        from: _fromMls,\r\n        to: _toMls\r\n      })) {\r\n        this._dates.setFromTo(mlsToDmy(_fromMls), to)\r\n      }\r\n    }\r\n  }\r\n\r\n  _refDates = c => this._dates = c\r\n\r\n  render(){\r\n    const {\r\n      isShow,\r\n      data,\r\n      onClose\r\n    } = this.props\r\n    , { chart={} } = data\r\n    , { from, to } = _getFromToDates(chart)\r\n    , _minYear = _getMinYear(from)\r\n    , _onTestDate = (str) => isDmy(str, _minYear)\r\n    , _errMsgDateFrom = _crErrMsg(_minYear)\r\n    , id = chart.zhGetId?.()\r\n    , _isDaily = chart.zhIsDaily?.();\r\n    return (\r\n      <ModalDialog\r\n        caption=\"Zoom Chart\"\r\n        style={S_DIALOG}\r\n        isShow={isShow}\r\n        commandButtons={this._commandButtons}\r\n        onClose={onClose}\r\n      >\r\n        <D.DatesFragment\r\n           key={id}\r\n           ref={this._refDates}\r\n           dateStyle={S_DATE}\r\n           placeholder=\"DD-MM-YYYY\"\r\n           initFromDate={from}\r\n           initToDate={to}\r\n           errMsg={_errMsgDateFrom}\r\n           isPeriodValid={isDmyPeriod}\r\n           onTestDate={_onTestDate}\r\n           onEnter={this._hZoom}\r\n        />\r\n        { _isDaily && <ZoomDailyRow\r\n             onZoom1M={this._hZoom1M}\r\n             onZoom3M={this._hZoom3M}\r\n             onZoom6M={this._hZoom6M}\r\n             onZoomYTD={this._hZoomYTD}\r\n             onZoom1Y={this._hZoom1Y}\r\n          />\r\n        }\r\n      </ModalDialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ZoomDialog\r\n"],"file":"ZoomDialog.js"}