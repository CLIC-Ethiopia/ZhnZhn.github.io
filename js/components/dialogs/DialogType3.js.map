{"version":3,"sources":["../../../src/components/dialogs/DialogType3.jsx"],"names":["DF_TIMEOUT","transformOptions","caption","value","DialogType3","Decor","dialog","props","_handleClickTransform","setState","prevState","isShowTransform","_handleSelectTransform","option","transform","_clearLoaded","one","isLoaded","_handleSelectStock","_handleLoad","setTimeout","_handleWithValidationLoad","_createValidationMessages","_createLoadOption","msgOnNotSelected","oneCaption","itemCaption","msg","push","datesFragment","getValidation","isValid","datesMsg","concat","length","getValues","fromDate","toDate","loadFn","_handleClose","_handleWithValidationClose","_menuMore","toggleToolBar","_toggleWithToolbar","onAbout","_clickInfoWithToolbar","noDate","isTransform","toolbarButtons","_createType2WithToolbar","onClick","_commandButtons","_crCommandsWithLoad","state","_isWithInitialState","shouldComponentUpdate","nextProps","nextState","isShow","render","onShow","onFront","oneURI","optionURI","optionsJsonProp","optionNames","onePlaceholder","isWithInputStock","initFromDate","initToDate","msgOnNotValidFormat","onTestDate","_oneCaption","_oneURI","isToolbar","isShowLabels","isShowDate","validationMessages","c","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport D from './DialogCell'\r\nimport crMenuMore from './MenuMore'\r\nimport Decor from './decorators/Decorators'\r\n\r\nconst DF_TIMEOUT = 4000;\r\n\r\nconst transformOptions = [\r\n  { caption: \"NO EFFECT: z[t]=y[t]\", value: \"none\" },\r\n  { caption: \"ROW-ON-ROW CHANGE: z[t]=y[t]–y[t-1]\", value: \"diff\" },\r\n  { caption: \"ROW-ON-ROW % CHANGE: z[t]=(y[t]–y[t-1])/y[t-1]\", value: \"rdiff\" },\r\n  { caption: \"LATEST VALUE AS % INCREMENT: z[t]=(y[latest]–y[t])/y[t]\", value: \"rdiff_from\" },\r\n  { caption: \"SCALE SERIES TO START AT 100: z[t]=y[t]÷y[0]*100\", value: \"normalize\" }\r\n];\r\n\r\n\r\n@Decor.dialog\r\nclass DialogType3 extends Component {\r\n  /*\r\n  static propTypes = {\r\n    isShow: PropTypes.bool,\r\n    caption: PropTypes.string,\r\n    itemCaption: PropTypes.string,\r\n    optionURI: PropTypes.string,\r\n    optionsJsonProp: PropTypes.string,\r\n    optionNames: PropTypes.string,\r\n    initFromDate: PropTypes.string,\r\n    initToDate: PropTypes.string,\r\n    msgOnNotValidFormat: PropTypes.func,\r\n    onTestDate: PropTypes.func,\r\n    onShow: PropTypes.func,\r\n\r\n    descrUrl: PropTypes.string,\r\n    isTransform: PropTypes.bool,\r\n    onClickInfo: PropTypes.func,\r\n    loadFn: PropTypes.func\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    itemCaption: 'Stock',\r\n    optionNames: 'Stocks'\r\n  }\r\n\r\n  constructor(props){\r\n    super(props);\r\n\r\n    //this.one = undefined\r\n    //this.transform = undefined\r\n    this.isLoaded = false\r\n\r\n    this._menuMore = crMenuMore(this, {\r\n      toggleToolBar: this._toggleWithToolbar,\r\n      onAbout: this._clickInfoWithToolbar\r\n    })\r\n\r\n    const { noDate, isTransform } = props;\r\n    this.toolbarButtons = this._createType2WithToolbar(\r\n       props, { noDate }\r\n    )\r\n    if (isTransform){\r\n      this.toolbarButtons.push({\r\n        caption: 'T', onClick: this._handleClickTransform\r\n      })\r\n    }\r\n    this._commandButtons = this._crCommandsWithLoad(this)\r\n\r\n\r\n    this.state = {\r\n       ...this._isWithInitialState(),\r\n       isShowTransform: false\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if (this.props !== nextProps){\r\n       if (this.props.isShow === nextProps.isShow){\r\n          return false;\r\n       }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  _handleClickTransform = () => {\r\n    this.setState(prevState => ({\r\n      isShowTransform: !prevState.isShowTransform\r\n    }))\r\n  }\r\n  _handleSelectTransform = (option) => {\r\n    this.transform = option\r\n  }\r\n\r\n  _clearLoaded = (one) => {\r\n    if (this.isLoaded && this.one === one) {\r\n      this.isLoaded = false\r\n    }\r\n  }\r\n  _handleSelectStock = (one) => {\r\n    if (one && this.one === one && !this.isLoaded) {\r\n      this._handleLoad()\r\n      this.isLoaded = true\r\n      setTimeout(this._clearLoaded, DF_TIMEOUT, one)\r\n    } else {\r\n      this.one = one\r\n      this.isLoaded = false\r\n    }\r\n  }\r\n\r\n  _handleLoad = () => {\r\n    //event.target.focus();\r\n    this._handleWithValidationLoad(\r\n      this._createValidationMessages(),\r\n      this._createLoadOption\r\n    );\r\n  }\r\n  _createValidationMessages = () => {\r\n    const {\r\n            msgOnNotSelected, oneCaption, itemCaption,\r\n          } = this.props;\r\n    let msg = [];\r\n\r\n    if (!this.one) {\r\n      msg.push(msgOnNotSelected(oneCaption || itemCaption));\r\n    }\r\n\r\n    if (this.datesFragment) {\r\n       const {\r\n               isValid, datesMsg\r\n             } = this.datesFragment.getValidation();\r\n       if (!isValid) {\r\n         msg = msg.concat(datesMsg);\r\n       }\r\n    }\r\n\r\n    msg.isValid = (msg.length === 0)\r\n         ? true\r\n         : false;\r\n    return msg;\r\n  }\r\n\r\n  _createLoadOption = () => {\r\n    const { fromDate, toDate } = this.datesFragment\r\n              ? this.datesFragment.getValues()\r\n              : {};\r\n    return this.props.loadFn(\r\n      this.props, {\r\n        one: this.one,\r\n        fromDate, toDate,\r\n        transform: this.transform\r\n      }\r\n    );\r\n  }\r\n\r\n  _handleClose = () => {\r\n    this._handleWithValidationClose()\r\n  }\r\n\r\n  render(){\r\n    const {\r\n            caption, isShow, onShow, onFront,\r\n            oneURI, optionURI, optionsJsonProp,\r\n            oneCaption, itemCaption, optionNames,\r\n            onePlaceholder,\r\n            isWithInputStock,\r\n            noDate,\r\n            initFromDate, initToDate,\r\n            msgOnNotValidFormat, onTestDate\r\n          } = this.props\r\n        , _oneCaption = oneCaption || itemCaption\r\n        , _oneURI = oneURI || optionURI\r\n        , {\r\n            isToolbar,\r\n            isShowLabels, isShowTransform, isShowDate,\r\n            validationMessages\r\n          } = this.state;\r\n\r\n    return (\r\n       <D.DraggableDialog\r\n           isShow={isShow}\r\n           menuModel={this._menuMore}\r\n           caption={caption}\r\n           commandButtons={this._commandButtons}\r\n           onShowChart={onShow}\r\n           onFront={onFront}\r\n           onClose={this._handleClose}\r\n       >\r\n         <D.Toolbar\r\n           isShow={isToolbar}\r\n           buttons={this.toolbarButtons}\r\n         />\r\n         <D.SelectWithLoad\r\n           isShow={isShow}\r\n           isShowLabels={isShowLabels}\r\n           placeholder={onePlaceholder}\r\n           uri={_oneURI}\r\n           jsonProp={optionsJsonProp}\r\n           caption={_oneCaption}\r\n           optionNames={optionNames}\r\n           isWithInput={isWithInputStock}\r\n           onSelect={this._handleSelectStock}\r\n         />\r\n         <D.ShowHide isShow={isShowTransform}>\r\n           <D.RowInputSelect\r\n             isShowLabels={isShowLabels}\r\n             caption=\"Transform\"\r\n             options={transformOptions}\r\n             onSelect={this._handleSelectTransform}\r\n           />\r\n         </D.ShowHide>\r\n         {\r\n           !noDate &&\r\n           <D.ShowHide isShow={isShowDate}>\r\n             <D.DatesFragment\r\n                ref={c => this.datesFragment = c}\r\n                isShowLabels={isShowLabels}\r\n                initFromDate={initFromDate}\r\n                initToDate={initToDate}\r\n                msgOnNotValidFormat={msgOnNotValidFormat}\r\n                onTestDate={onTestDate}\r\n             />\r\n           </D.ShowHide>\r\n         }\r\n         <D.ValidationMessages\r\n            validationMessages={validationMessages}\r\n         />\r\n      </D.DraggableDialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DialogType3\r\n"],"file":"DialogType3.js"}