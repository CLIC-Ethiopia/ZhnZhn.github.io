{"version":3,"sources":["../../../src/components/dialogs/DialogType3.jsx"],"names":["DialogType3","props","_handleClickInfo","descrUrl","onClickInfo","_handleSelectStock","stock","_handleLoad","event","target","focus","_handleWithValidationLoad","_createValidationMessages","_createLoadOption","itemCaption","msg","push","msgOnNotSelected","datesFragment","getValidation","isValid","datesMsg","concat","length","getValues","fromDate","toDate","_handleClose","_handleWithValidationClose","onClose","toolbarButtons","caption","onClick","state","validationMessages","nextProps","nextState","isShow","onShow","optionURI","optionsJsonProp","optionNames","initFromDate","initToDate","msgOnNotValidFormat","onTestDate","_commandButtons","c","propTypes","bool","string","func"],"mappings":"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","file":"DialogType3.js","sourcesContent":["import React, { Component, PropTypes } from 'react';\r\n\r\nimport createLoadOptions from '../../flux/creaters/type3';\r\n\r\nimport DraggableDialog from '../zhn-moleculs/DraggableDialog';\r\nimport ToolbarButtonCircle from './ToolbarButtonCircle';\r\nimport SelectWithLoad from './SelectWithLoad';\r\nimport ActionButton from '../zhn/ActionButton';\r\nimport DatesFragment from '../zhn-moleculs/DatesFragment';\r\nimport ValidationMessages from '../zhn/ValidationMessages';\r\n\r\nimport withValidationLoad from './decorators/withValidationLoad';\r\n\r\n@withValidationLoad\r\nclass DialogType3 extends Component {\r\n  static propTypes = {\r\n    isShow: PropTypes.bool,\r\n    caption: PropTypes.string,\r\n    itemCaption: PropTypes.string,\r\n    optionURI: PropTypes.string,\r\n    optionsJsonProp: PropTypes.string,\r\n    optionNames: PropTypes.string,\r\n    initFromDate: PropTypes.string,\r\n    initToDate: PropTypes.string,\r\n    msgOnNotValidFormat: PropTypes.func,\r\n    onTestDate: PropTypes.func,\r\n    onShow: PropTypes.func,\r\n\r\n    descrUrl: PropTypes.string,\r\n    onClickInfo: PropTypes.func\r\n  }\r\n\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.stock = null;\r\n    this.toolbarButtons = (props.descrUrl)\r\n         ?  [{ caption: 'I', onClick: this._handleClickInfo }]\r\n         : [];\r\n    this.state = {\r\n           validationMessages: []\r\n         }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if (this.props !== nextProps){\r\n       if (this.props.isShow === nextProps.isShow){\r\n          return false;\r\n       }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  _handleClickInfo = () => {\r\n    const {descrUrl, onClickInfo} = this.props;\r\n    onClickInfo({ descrUrl });\r\n  }\r\n\r\n  _handleSelectStock = (stock) => {\r\n    this.stock = stock;\r\n  }\r\n\r\n  _handleLoad = (event) => {\r\n    event.target.focus();\r\n    this._handleWithValidationLoad(\r\n      this._createValidationMessages(),\r\n      this._createLoadOption\r\n    );\r\n  }\r\n  _createValidationMessages = () => {\r\n    const { itemCaption='Stock' } = this.props;\r\n    let msg = [];\r\n    if (!this.stock) { msg.push(this.props.msgOnNotSelected(itemCaption));}\r\n    const {isValid, datesMsg} = this.datesFragment.getValidation();\r\n    if (!isValid) { msg = msg.concat(datesMsg); }\r\n    msg.isValid = (msg.length === 0) ? true : false;\r\n    return msg;\r\n  }\r\n  _createLoadOption = () => {\r\n    const { fromDate, toDate } = this.datesFragment.getValues()\r\n    return createLoadOptions(\r\n        this.props,\r\n        { stock : this.stock, fromDate, toDate }\r\n    );\r\n  }\r\n  _handleClose = () => {\r\n    this._handleWithValidationClose(this._createValidationMessages);\r\n    this.props.onClose();\r\n  }\r\n\r\n  render(){\r\n    const {\r\n            caption, isShow, onShow,\r\n            optionURI, optionsJsonProp,\r\n            itemCaption='Stock:', optionNames='Stocks',\r\n            initFromDate, initToDate, msgOnNotValidFormat, onTestDate\r\n          } = this.props\r\n        , { validationMessages } = this.state\r\n        , _commandButtons = [\r\n       <ActionButton\r\n          key=\"a\"\r\n          type=\"TypeC\"\r\n          caption=\"Load\"\r\n          onClick={this._handleLoad}\r\n       />\r\n    ];\r\n\r\n    return (\r\n       <DraggableDialog\r\n           caption={caption}\r\n           isShow={isShow}\r\n           commandButtons={_commandButtons}\r\n           onShowChart={onShow}\r\n           onClose={this._handleClose}\r\n       >\r\n         <ToolbarButtonCircle\r\n           buttons={this.toolbarButtons}\r\n         />\r\n         <SelectWithLoad\r\n           isShow={isShow}\r\n           uri={optionURI}\r\n           jsonProp={optionsJsonProp}\r\n           caption={itemCaption}\r\n           optionNames={optionNames}\r\n           onSelect={this._handleSelectStock}\r\n         />\r\n\r\n         <DatesFragment\r\n            ref={c => this.datesFragment = c}\r\n            initFromDate={initFromDate}\r\n            initToDate={initToDate}\r\n            msgOnNotValidFormat={msgOnNotValidFormat}\r\n            onTestDate={onTestDate}\r\n         />\r\n         <ValidationMessages\r\n            validationMessages={validationMessages}\r\n         />\r\n      </DraggableDialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DialogType3\r\n"]}