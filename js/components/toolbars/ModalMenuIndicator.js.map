{"version":3,"sources":["../../../src/components/toolbars/ModalMenuIndicator.jsx"],"names":["growthRate","seriaFn","normalize","crMomAthConfig","IndicatorBuilder","C_GROW","STYLE","PANE","width","margin","CAPTION","display","color","fontWeight","ROW_MOM_ATH","paddingRight","ROW","paddingTop","N2","MOM_ATH","_isFn","fn","_isSeriaInst","s","setVisible","FNS","GR","NORM","NORM_CAPTION_EL","ModalMenuIndicator","props","_handleAddMomAth","chart","getChart","config","chartId","onAddMfi","setState","isMomAth","_handleRemoveMomAth","onRemoveMfi","_isMfi","zhIsMfi","_isMomAth","zhIsMomAth","_addGrowRate","_addSeriaBy","bind","_removeGrowRate","_hideSeriaBy","_addNormalize","undefined","_removeNormalize","state","isGrowthRate","isNormalize","confArr","seriaOptions","fnOptions","seriaPropName","statePropName","_seria","_chart","data","series","seriaData","zhAddSeriaToYAxis","yIndex","isRemove","yAxis","remove","render","isShow","style","onClose","zhConfig","isWithoutSma","S","ROOT","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react';\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport seriaFn from '../../math/seriaFn'\r\nimport IndicatorBuilder from '../../charts/IndicatorBuilder'\r\n\r\nimport ModalPopup from '../zhn-moleculs/ModalPopup'\r\n\r\nimport RowGrowthRate from './RowGrowthRate'\r\nimport RowPlusMinus from './RowPlusMinus'\r\nimport RowSma from './RowSma'\r\nimport RowMfi from './RowMfi'\r\n\r\nimport S from './ModalMenu.Style'\r\n\r\nconst {\r\n  growthRate,\r\n  normalize\r\n } = seriaFn;\r\n\r\nconst {\r\n  crMomAthConfig\r\n} = IndicatorBuilder;\r\n\r\nconst C_GROW = '#90ed7d';\r\n\r\nconst STYLE = {\r\n  PANE: {\r\n    width: 230,\r\n    margin: 8\r\n  },\r\n  CAPTION: {\r\n    display: 'inline-block',\r\n    color: 'black',\r\n    width: 48,\r\n    fontWeight: 'bold'\r\n  },\r\n  ROW_MOM_ATH: {\r\n    paddingRight: 10\r\n  },\r\n  ROW: {\r\n    paddingTop: 5\r\n  },\r\n  N2: {\r\n    width: 48\r\n  }\r\n};\r\n\r\nconst MOM_ATH = 'MOM_ATH';\r\n\r\n\r\nconst _isFn = fn => typeof fn === 'function';\r\n\r\nconst _isSeriaInst = (s) => s && _isFn(s.setVisible);\r\n\r\nconst FNS = {\r\n  GR: ['_grSeria', 'isGrowthRate', C_GROW, growthRate, true],\r\n  NORM: ['_normSeria', 'isNormalize', C_GROW, normalize, false]\r\n};\r\n\r\nconst NORM_CAPTION_EL = (\r\n  <Fragment>\r\n    Normalize (100*y<sub>t</sub>/y<sub>0</sub>)\r\n  </Fragment>\r\n);\r\n\r\nclass ModalMenuIndicator extends Component {\r\n  /*\r\n  static propTypes = {\r\n    rootStyle: PropTypes.object,\r\n    chartId: PropTypes.string,\r\n    config: PropTypes.object,\r\n    getChart: PropTypes.func,\r\n    onAddMfi: PropTypes.func,\r\n    onRemoveMfi: PropTypes.func,\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    getChart: () => {}\r\n  }\r\n\r\n  constructor(props){\r\n    super(props)\r\n\r\n    const { config } = props;\r\n    this._isMfi = !!config.zhIsMfi\r\n    this._isMomAth = !!config.zhIsMomAth\r\n\r\n    this._addGrowRate = this._addSeriaBy\r\n     .bind(this, FNS.GR)\r\n    this._removeGrowRate = this._hideSeriaBy\r\n     .bind(this, FNS.GR)\r\n\r\n     this._addNormalize = this._addSeriaBy\r\n      .bind(this, FNS.NORM, {}, undefined)\r\n     this._removeNormalize = this._hideSeriaBy\r\n      .bind(this, FNS.NORM)\r\n\r\n    this.state = {\r\n      isGrowthRate: false,\r\n      isNormalize: false,\r\n      isMomAth: false\r\n    }\r\n  }\r\n\r\n\r\n  _addSeriaBy(confArr, seriaOptions, fnOptions) {\r\n    const seriaPropName = confArr[0]\r\n    , statePropName = confArr[1]\r\n    , color = confArr[2]\r\n    , fn = confArr[3];\r\n\r\n    const _seria = this[seriaPropName];\r\n    if (!this._chart) {\r\n      this._chart = this.props.getChart()\r\n    }\r\n    if (this._chart) {\r\n      if ( _isSeriaInst(_seria) ) {\r\n        _seria.setVisible(true)\r\n      } else {\r\n        const data = this._chart.series[0].data\r\n            , seriaData = fn(data, fnOptions);\r\n        this[seriaPropName] = this._chart.zhAddSeriaToYAxis({\r\n          data: seriaData,\r\n          color: seriaOptions.color || color,\r\n          yIndex: -1\r\n        }, seriaOptions)\r\n      }\r\n      this.setState({ [statePropName]: true })\r\n    }\r\n  }\r\n\r\n  _hideSeriaBy(confArr) {\r\n    const seriaPropName = confArr[0]\r\n    , statePropName = confArr[1]\r\n    , isRemove = confArr[4]\r\n    , _seria = this[seriaPropName];\r\n    if (_isSeriaInst(_seria)) {\r\n      if (isRemove) {\r\n        _seria.yAxis.remove()\r\n        this[seriaPropName] = null\r\n      } else {\r\n        _seria.setVisible(false)\r\n      }\r\n      this.setState({ [statePropName]: false })\r\n    }\r\n  }\r\n\r\n  _handleAddMomAth = () => {\r\n    const chart = this.props.getChart()\r\n    , config = crMomAthConfig(chart, this.props.chartId)\r\n    if (config) {\r\n      this.props.onAddMfi(config, MOM_ATH)\r\n      this.setState({ isMomAth: true })\r\n    }\r\n  }\r\n  _handleRemoveMomAth = () => {\r\n    this.props.onRemoveMfi(MOM_ATH)\r\n    this.setState({ isMomAth: false })\r\n  }\r\n\r\n render(){\r\n    const {\r\n      isShow, style, config,\r\n      getChart, onClose,\r\n      onAddMfi, onRemoveMfi\r\n    } = this.props\r\n    , { zhConfig={} } = config\r\n    , { isWithoutSma } = zhConfig\r\n    , {\r\n      isGrowthRate,\r\n      isNormalize,\r\n      isMomAth\r\n    } = this.state;\r\n    return (\r\n      <ModalPopup\r\n        style={{...S.ROOT, ...style}}\r\n        isShow={isShow}\r\n        onClose={onClose}\r\n      >\r\n        <div style={STYLE.PANE}>\r\n          <RowGrowthRate\r\n            is={isGrowthRate}\r\n            onMinus={this._removeGrowRate}\r\n            onPlus={this._addGrowRate}\r\n          />\r\n          <RowPlusMinus\r\n            is={isNormalize}\r\n            caption={NORM_CAPTION_EL}\r\n            onMinus={this._removeNormalize}\r\n            onPlus={this._addNormalize}\r\n          />\r\n          {!isWithoutSma && <RowSma\r\n              config={config}\r\n              getChart={getChart}\r\n            />\r\n          }\r\n          {this._isMfi && <RowMfi\r\n              getChart={getChart}\r\n              onAddMfi={onAddMfi}\r\n              onRemoveMfi={onRemoveMfi}\r\n           />\r\n          }\r\n          {this._isMomAth && <RowPlusMinus\r\n             is={isMomAth}\r\n             styleCaption={S.ROW_MOM_ATH}\r\n             caption=\"MOM(1) & ATH\"\r\n             onPlus={this._handleAddMomAth}\r\n             onMinus={this._handleRemoveMomAth}\r\n           />\r\n          }\r\n        </div>\r\n      </ModalPopup>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ModalMenuIndicator\r\n"],"file":"ModalMenuIndicator.js"}