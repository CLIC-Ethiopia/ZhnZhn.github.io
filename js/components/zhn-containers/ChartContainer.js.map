{"version":3,"sources":["../../../src/components/zhn-containers/ChartContainer.jsx"],"names":["SHOW_POPUP","CHILD_MARGIN","RESIZE_INIT_WIDTH","RESIZE_MIN_WIDTH","RESIZE_MAX_WIDTH","styles","rootDiv","backgroundColor","padding","position","borderRadius","width","height","minHeight","marginLeft","boxShadow","overflowY","overflowX","hrzResize","top","right","scrollDiv","paddingRight","chartDiv","inlineBlock","display","none","isInArray","array","value","i","len","length","compActions","SHOW_CHART","LOAD_STOCK_COMPLETED","CLOSE_CHART","ChartContainer","props","_onStore","actionType","data","chartType","spComp","scrollTop","setState","CLOSE_CHART_CONTAINER_2","_handleHide","browserType","onCloseContainer","isShow","_handleResizeAfter","parentWidth","max","state","configs","_propName","refs","reflowChart","childMargin","_renderCharts","onCloseItem","_isAdminMode","isAdminMode","bind","map","config","index","zhConfig","id","createItem","store","option","unsubscribe","listen","_initState","getConfigs","caption","_styleIsShow","_classIsShow","undefined","Object","assign","node"],"mappings":"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","file":"ChartContainer.js","sourcesContent":["import React, { Component } from 'react';\r\n\r\nimport ChartStore from '../../flux/stores/ChartStore';\r\nimport { ChartActionTypes } from '../../flux/actions/ChartActions';\r\n\r\nimport { ComponentActionTypes } from '../../flux/actions/ComponentActions';\r\n\r\nimport BrowserCaption from '../zhn/BrowserCaption';\r\nimport SvgHrzResize from '../zhn/SvgHrzResize';\r\nimport ScrollPane from '../zhn/ScrollPane';\r\n\r\nimport ItemFactory from '../factories/ItemFactory';\r\n\r\nconst SHOW_POPUP = \"show-popup\"\r\n    , CHILD_MARGIN = 36\r\n    , RESIZE_INIT_WIDTH = 635\r\n    , RESIZE_MIN_WIDTH = 540\r\n    , RESIZE_MAX_WIDTH = 1200;\r\n\r\nconst styles = {\r\n  rootDiv : {\r\n    backgroundColor: '#4D4D4D',\r\n    padding : '0px 0px 3px 0px',\r\n    position: 'relative',\r\n    borderRadius: '4px',\r\n    width: '635px',\r\n    height: 'calc(100vh - 71px)',\r\n    minHeight: '500px',\r\n    marginLeft: '16px',\r\n    boxShadow: '1px 4px 6px 1px rgba(0,0,0,0.6)',\r\n    overflowY: 'hidden',\r\n    overflowX : 'hidden'\r\n  },\r\n  hrzResize : {\r\n    position : 'absolute',\r\n    top : '30px',\r\n    right: '0'\r\n  },\r\n  scrollDiv : {\r\n    overflowY: 'auto',\r\n    height: '92%',\r\n    paddingRight: '10px'\r\n  },\r\n  chartDiv : {\r\n    overflowY: 'auto',\r\n    height : '680px'\r\n  },\r\n  /*\r\n  transitionOption : {\r\n    transitionName : \"scaleY\",\r\n    transitionEnterTimeout : 400,\r\n    transitionLeave : false\r\n  },\r\n  */\r\n  inlineBlock : {\r\n    display : 'inline-block'\r\n  },\r\n  none : {\r\n    display: 'none'\r\n  }\r\n};\r\n\r\nconst isInArray = function(array=[], value){\r\n  let i=0, len=array.length;\r\n  for (; i<len; i++){\r\n    if (array[i] === value){\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nconst compActions = [\r\n  ChartActionTypes.SHOW_CHART,\r\n  ChartActionTypes.LOAD_STOCK_COMPLETED,\r\n  ChartActionTypes.CLOSE_CHART\r\n];\r\n\r\n\r\nclass ChartContainer extends Component {\r\n\r\n  constructor(props){\r\n    super();\r\n    this.childMargin = CHILD_MARGIN;\r\n    this.state = {};\r\n  }\r\n\r\n  componentDidMount(){\r\n    this.unsubscribe = ChartStore.listen(this._onStore);\r\n    const _initState = ChartStore.getConfigs(this.props.chartType)\r\n    if (_initState) {\r\n       this.setState(_initState);\r\n    }\r\n  }\r\n  componentWillUnmount(){\r\n    this.unsubscribe();\r\n  }\r\n\r\n   _onStore = (actionType, data) => {\r\n      if (isInArray(compActions, actionType)) {\r\n        if (data && data.chartType === this.props.chartType){\r\n          this.spComp.scrollTop()\r\n          this.setState(data);\r\n        }\r\n      } else if (actionType === ComponentActionTypes.CLOSE_CHART_CONTAINER_2){\r\n         if (data === this.props.chartType){\r\n           this._handleHide();\r\n         }\r\n      }\r\n   }\r\n\r\n   _handleHide = () => {\r\n      const { chartType, browserType, onCloseContainer } = this.props;\r\n      onCloseContainer(chartType, browserType);\r\n      this.setState({ isShow: false });\r\n   }\r\n\r\n   _handleResizeAfter = (parentWidth) => {\r\n     let i=0\r\n       , max = this.state.configs.length\r\n       , _propName;\r\n     for (; i<max; i++) {\r\n        _propName = 'chart' + i\r\n        if (this.refs[_propName] && typeof this.refs[_propName].reflowChart === 'function'){\r\n          this.refs[_propName].reflowChart(parentWidth - this.childMargin)\r\n        }\r\n     }\r\n   }\r\n\r\n   _renderCharts = () => {\r\n     const { chartType, browserType, onCloseItem } = this.props\r\n         , { configs=[] } = this.state\r\n         , _isAdminMode = (typeof ChartStore.isAdminMode == 'function')\r\n              ? ChartStore.isAdminMode.bind(ChartStore)\r\n              : false ;\r\n     return configs.map((config, index) => {\r\n       const { zhConfig={} } = config\r\n           , { id } = zhConfig;\r\n       return ItemFactory.createItem({\r\n          store: ChartStore,\r\n          config, index,\r\n          option: { chartType },\r\n          props: {\r\n            onCloseItem : onCloseItem.bind(null, chartType, browserType, id),\r\n            isAdminMode : _isAdminMode\r\n          }\r\n       });\r\n     });\r\n   }\r\n\r\n   render(){\r\n     const  { caption } = this.props\r\n          , { isShow } = this.state\r\n          , _styleIsShow = (isShow)\r\n               ? styles.inlineBlock\r\n               : styles.none\r\n         , _classIsShow = (isShow)\r\n               ? SHOW_POPUP\r\n               : undefined;\r\n     return(\r\n        <div\r\n           className={_classIsShow}\r\n           style={Object.assign({}, styles.rootDiv, _styleIsShow)}\r\n        >\r\n          <BrowserCaption\r\n             caption={caption}\r\n             onClose={this._handleHide}\r\n          >\r\n             <SvgHrzResize\r\n               initWidth={RESIZE_INIT_WIDTH}\r\n               minWidth={RESIZE_MIN_WIDTH}\r\n               maxWidth={RESIZE_MAX_WIDTH}\r\n               comp={this}\r\n               onResizeAfter={this._handleResizeAfter}\r\n             />\r\n          </BrowserCaption>\r\n\r\n          <ScrollPane\r\n             ref={ node => this.spComp = node}\r\n             style={styles.scrollDiv}\r\n          >\r\n            <div>\r\n              { this._renderCharts() }\r\n            </div>\r\n          </ScrollPane>\r\n\r\n        </div>\r\n     )\r\n   }\r\n}\r\n\r\nexport default ChartContainer\r\n"]}