{"version":3,"sources":["../../../src/components/zhn-containers/DialogContainer.jsx"],"names":["S","ROOT","zIndex","position","top","left","width","_findCompIndex","arr","key","i","length","undefined","_doVisible","keyValue","_index","slice","_updateVisible","state","maxDialog","hmIs","visibleDialogs","_keyIndex","indexOf","splice","push","_findCompByKey","comps","index","DialogContainer","props","_onStore","actionType","option","showAction","setState","prevState","Comp","data","compDialogs","hmData","_handleToggleDialog","onCloseDialog","_Comp","elHtml","style","cursor","_handleToFront","_renderDialogs","map","React","cloneElement","isShow","optionData","onFront","bind","onClose","document","getElementsByTagName","componentDidMount","unsubscribe","store","listen","componentWillUnmount","componentDidCatch","error","info","render","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n\r\nconst S = {\r\n  ROOT: {\r\n    zIndex: 1030,\r\n    position: 'absolute',\r\n    top: '70px',\r\n    left: '10px',\r\n    width: '98%'\r\n  }\r\n};\r\n\r\nconst _findCompIndex = (arr, key) => {\r\n  for (let i=0; i<arr.length; i++){\r\n    if (arr[i].key === key){\r\n      return i;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\n\r\nconst _doVisible = function(arr, keyValue){\r\n  const _index = _findCompIndex(arr, keyValue) || 0;\r\n  return [\r\n    ...arr.slice(0, _index),\r\n    ...arr.slice(_index+1),\r\n    arr[_index]\r\n  ];\r\n};\r\n\r\nconst _updateVisible = (state, key, maxDialog) => {\r\n  const { hmIs, visibleDialogs } = state\r\n      , _keyIndex = visibleDialogs.indexOf(key);\r\n  if (_keyIndex !== -1) {\r\n    visibleDialogs.splice(_keyIndex, 1)\r\n  }\r\n  visibleDialogs.push(key)\r\n  hmIs[key] = true\r\n  if (visibleDialogs.length > maxDialog ){\r\n    hmIs[visibleDialogs[0]] = false\r\n    visibleDialogs.splice(0, 1)\r\n  }\r\n};\r\n\r\nconst _findCompByKey = (comps, key) => {\r\n  const index = _findCompIndex(comps, key);\r\n  return typeof index !== 'undefined'\r\n     ? comps[index]\r\n     : undefined;\r\n};\r\n\r\nclass DialogContainer extends Component {\r\n  static defaultProps = {\r\n    maxDialog: 3\r\n  }\r\n\r\n  constructor(props){\r\n    super()\r\n    this.elHtml = document.getElementsByTagName('html')[0]\r\n    this.state = {\r\n      hmIs: {},\r\n      compDialogs: [],\r\n      hmData: {},\r\n      visibleDialogs: []\r\n    }\r\n  }\r\n\r\n   componentDidMount(){\r\n     this.unsubscribe = this.props.store.listen(this._onStore)\r\n   }\r\n   componentWillUnmount(){\r\n     this.unsubscribe()\r\n   }\r\n\r\n\r\n   componentDidCatch(error, info){\r\n     /*\r\n     console.log(error)\r\n     console.log(info)\r\n     */\r\n   }\r\n\r\n\r\n   _onStore = (actionType, option) => {\r\n      const { showAction } = this.props;\r\n      if (actionType === showAction){\r\n         this.setState(prevState => {\r\n           const { key, Comp, data } = option\r\n               , { maxDialog } = this.props;\r\n            if (Comp && typeof _findCompIndex(prevState.compDialogs, key) !== 'undefined') {\r\n              return null;\r\n            }\r\n           _updateVisible(prevState, key, maxDialog)\r\n           if (!Comp){\r\n              prevState.compDialogs = _doVisible(prevState.compDialogs, key)\r\n           } else {\r\n              prevState.compDialogs.push(Comp)\r\n           }\r\n           prevState.hmData[key] = data\r\n           return prevState;\r\n         })\r\n      }\r\n   }\r\n\r\n  _handleToggleDialog = (key) => {\r\n    const { hmIs, compDialogs } = this.state;\r\n    if (hmIs[key]){\r\n      const { onCloseDialog } = this.props\r\n          , _Comp = _findCompByKey(compDialogs, key);\r\n      if (typeof onCloseDialog === 'function' && _Comp){\r\n        onCloseDialog(_Comp)\r\n      }\r\n    }\r\n\r\n    this.setState(prevState => {\r\n      const { hmIs } = prevState;\r\n      hmIs[key] = !hmIs[key]\r\n      if (!hmIs[key]) {\r\n        const visibleDialogs = prevState.visibleDialogs\r\n            , _keyIndex = visibleDialogs.indexOf(key);\r\n        visibleDialogs.splice(_keyIndex, 1)\r\n        this.elHtml.style.cursor = ''\r\n      }\r\n      return prevState;\r\n    })\r\n  }\r\n\r\n  _handleToFront = (key) => {\r\n    const { visibleDialogs } = this.state;\r\n    if (visibleDialogs[visibleDialogs.length-1] !== key) {\r\n      this.setState(prevState => {\r\n        prevState.compDialogs = _doVisible(prevState.compDialogs, key)\r\n        const visibleDialogs = prevState.visibleDialogs\r\n            , _keyIndex = visibleDialogs.indexOf(key);\r\n        visibleDialogs.splice(_keyIndex, 1)\r\n        visibleDialogs.push(key)\r\n        return prevState;\r\n      })\r\n    }\r\n  }\r\n\r\n  _renderDialogs = () => {\r\n    const { hmIs, compDialogs, hmData } = this.state;\r\n    return compDialogs.map(Comp => {\r\n       const key = Comp.key;\r\n       return React.cloneElement(Comp, {\r\n          key: key,\r\n          isShow: hmIs[key],\r\n          optionData: hmData[key],\r\n          onFront: this._handleToFront.bind(this, key),\r\n          onClose: this._handleToggleDialog.bind(this, key)\r\n       });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={S.ROOT}>\r\n        {this._renderDialogs()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DialogContainer\r\n"],"file":"DialogContainer.js"}