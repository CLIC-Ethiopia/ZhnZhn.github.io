{"version":3,"sources":["../../../src/flux/watch-list/WatchListSlice.js"],"names":["STORAGE_KEY","DIALOG_CAPTION","WatchListSlice","watchList","isWatchEdited","initWatchList","getItem","then","value","trigger","UPDATE_WATCH_BROWSER","catch","getWatchList","getWatchGroups","groups","getWatchListsByGroup","groupCaption","group","findGroup","lists","onAddItem","item","_onEditWatch","addItem","ADD_ITEM","onRemoveItem","option","removeItem","_onDragDrop","result","isDone","showAlertDialog","onDragDropItem","dragDropItem","onDragDropList","dragDropList","onDragDropGroup","dragDropGroup","onSaveWatch","setItem","onShowModalDialog","INFO","caption","descr","WATCH_SAVED","error","console","log","WATCH_PREV","forActionType","EDIT_WATCH_COMPLETED","EDIT_WATCH_FAILED","messages","message","onAddGroup","addGroup","ADD_GROUP","onRenameGroup","renameGroup","RENAME_GROUP","onDeleteGroup","deleteGroup","DELETE_GROUP","onCreateList","createList","CREATE_LIST","onRenameList","renameList","RENAME_LIST","onDeleteList","deleteList","DELETE_LIST"],"mappings":"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","file":"WatchListSlice.js","sourcesContent":["import LocalForage from 'localforage';\r\n\r\nimport { BrowserActionTypes } from '../actions/BrowserActions';\r\nimport { WatchActionTypes } from '../actions/WatchActions';\r\nimport WatchDefault from '../../constants/WatchDefault';\r\nimport { ModalDialog }  from '../../constants/Type';\r\nimport Msg from '../../constants/Msg';\r\n\r\nimport Logic from './Logic';\r\n\r\nconst STORAGE_KEY = 'WATCH_LIST_ERC'\r\n    , DIALOG_CAPTION ='Watch List:';\r\n\r\nconst WatchListSlice = {\r\n\r\n  watchList : WatchDefault,\r\n  isWatchEdited : false,\r\n\r\n  initWatchList(){\r\n    LocalForage.getItem(STORAGE_KEY).then((value) => {\r\n      this.watchList = (value)\r\n              ? value\r\n              : WatchDefault;\r\n      this.trigger(BrowserActionTypes.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n    .catch(() => {\r\n      this.watchList = WatchDefault;\r\n      this.trigger(BrowserActionTypes.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n  },\r\n  getWatchList(){\r\n    return this.watchList;\r\n  },\r\n  getWatchGroups(){\r\n    return this.watchList.groups;\r\n  },\r\n  getWatchListsByGroup(groupCaption){\r\n    const group = Logic.findGroup(this.watchList, groupCaption);\r\n    if (!group) { return []; }\r\n    return group.lists;\r\n  },\r\n\r\n  onAddItem(item){\r\n    this._onEditWatch(\r\n      Logic.addItem(this.watchList, item), WatchActionTypes.ADD_ITEM\r\n    );\r\n  },\r\n  onRemoveItem(option){\r\n    Logic.removeItem(this.watchList, option);\r\n    this.isWatchEdited = true;\r\n    this.trigger(BrowserActionTypes.UPDATE_WATCH_BROWSER, this.watchList);\r\n  },\r\n\r\n\r\n  _onDragDrop(result){\r\n    if (result.isDone){\r\n       this.isWatchEdited = true;\r\n       this.trigger(BrowserActionTypes.UPDATE_WATCH_BROWSER, this.watchList);\r\n    } else {\r\n      this.showAlertDialog(result);\r\n    }\r\n  },\r\n\r\n\r\n  onDragDropItem(option){\r\n    this._onDragDrop(Logic.dragDropItem(this.watchList, option) );\r\n  },\r\n  onDragDropList(option){\r\n    this._onDragDrop(Logic.dragDropList(this.watchList, option) );\r\n  },\r\n  onDragDropGroup(option){\r\n    this._onDragDrop(Logic.dragDropGroup(this.watchList, option));\r\n  },\r\n\r\n\r\n  onSaveWatch(){\r\n    if (this.isWatchEdited){\r\n       LocalForage.setItem(STORAGE_KEY , this.watchList)\r\n          .then(()=>{\r\n             this.isWatchEdited = false;\r\n             this.onShowModalDialog(ModalDialog.INFO, {\r\n                caption : DIALOG_CAPTION,\r\n                descr : Msg.WATCH_SAVED\r\n             })             \r\n          })\r\n          .catch((error) => {\r\n             console.log(error);\r\n          })\r\n    } else {\r\n       this.onShowModalDialog(ModalDialog.INFO, {\r\n          caption : DIALOG_CAPTION,\r\n          descr : Msg.WATCH_PREV\r\n       })\r\n    }\r\n  },\r\n\r\n  _onEditWatch(result, forActionType){\r\n    if (result.isDone){\r\n      this.isWatchEdited = true;\r\n      this.trigger(BrowserActionTypes.UPDATE_WATCH_BROWSER, this.watchList);\r\n      this.trigger(WatchActionTypes.EDIT_WATCH_COMPLETED, {forActionType});\r\n    } else {\r\n      this.trigger(WatchActionTypes.EDIT_WATCH_FAILED, {\r\n          messages:[result.message],\r\n          forActionType\r\n      });\r\n    }\r\n  },\r\n  onAddGroup(option){\r\n    this._onEditWatch(\r\n      Logic.addGroup(this.watchList, option),\r\n      WatchActionTypes.ADD_GROUP\r\n    );\r\n  },\r\n  onRenameGroup(option){\r\n    this._onEditWatch(\r\n      Logic.renameGroup(this.watchList, option),\r\n      WatchActionTypes.RENAME_GROUP\r\n    );\r\n  },\r\n  onDeleteGroup(option){\r\n    this._onEditWatch(\r\n      Logic.deleteGroup(this.watchList, option),\r\n      WatchActionTypes.DELETE_GROUP\r\n    );\r\n  },\r\n\r\n  onCreateList(option){\r\n    this._onEditWatch(\r\n      Logic.createList(this.watchList, option),\r\n      WatchActionTypes.CREATE_LIST\r\n    );\r\n  },\r\n  onRenameList(option){\r\n    this._onEditWatch(\r\n      Logic.renameList(this.watchList, option),\r\n      WatchActionTypes.RENAME_LIST\r\n    );\r\n  },\r\n  onDeleteList(option){\r\n    this._onEditWatch(\r\n      Logic.deleteList(this.watchList, option),\r\n      WatchActionTypes.DELETE_LIST\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default WatchListSlice\r\n"]}