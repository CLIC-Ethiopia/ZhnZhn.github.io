{"version":3,"sources":["../../../src/flux/stores/BrowserSlice.js"],"names":["C","FAILED","fnFindObj","menu","chartType","undefined","i","maxPart","length","j","maxItem","items","id","fnSetIsOpen","browserMenu","browserType","value","obj","isOpen","fnAddCounter","counter","_addDialogProps","Object","keys","forEach","item","propName","addProps","dialogProps","assign","BrowserSlice","routeDialog","QE","WL","getBrowserMenu","isWithItemCounter","_config","withoutItemCounter","setMenuItemOpen","setMenuItemClose","addMenuItemCounter","minusMenuItemCounter","getSourceConfig","browserId","sourceId","indexOf","STOCKS_BY_SECTORS","_r","onShowBrowser","trigger","SHOW_BROWSER","onShowBrowserDynamicCompleted","option","crAsyncBrowser","then","INIT_BROWSER_DYNAMIC","elBrowser","catch","console","log","err","SHOW_BROWSER_DYNAMIC","onShowBrowserDynamicFailed","showAlertDialog","onLoadBrowserDynamicCompleted","json","elMenu","createMenu","LOAD_BROWSER_DYNAMIC_COMPLETED","menuItems","onLoadBrowserDynamicFailed","alertItemId","caption"],"mappings":"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","file":"BrowserSlice.js","sourcesContent":["\r\nimport BrowserMenu from '../../constants/BrowserMenu';\r\nimport BrowserConfig from '../../constants/BrowserConfig';\r\nimport { BrowserType } from '../../constants/Type';\r\n\r\nimport Factory from '../logic/Factory';\r\nimport { BrowserActionTypes as BA } from '../actions/BrowserActions';\r\n\r\nimport DataQE from '../../constants/DataQE';\r\nimport DataWL from '../../constants/DataWL';\r\n\r\nconst C = {\r\n  FAILED: 'Failed'\r\n};\r\n\r\nconst fnFindObj = function(menu, chartType){\r\n  if (!menu) {\r\n    return undefined;\r\n  }\r\n\r\n  for (var i=0, maxPart=menu.length; i<maxPart; i++){\r\n    for(var j=0, maxItem=menu[i].items.length; j<maxItem; j++){\r\n      if (menu[i].items[j].id === chartType){\r\n        return menu[i].items[j];\r\n      }\r\n    }\r\n  }\r\n\r\n};\r\n\r\nconst fnSetIsOpen = function(chartType, browserMenu, browserType, value){\r\n  const obj = fnFindObj(browserMenu[browserType], chartType);\r\n  if (obj) {\r\n    obj.isOpen = value;\r\n  }\r\n};\r\n\r\nconst fnAddCounter = function(chartType, browserType, browserMenu, value){\r\n  const obj = fnFindObj(browserMenu[browserType], chartType);\r\n  if (obj){\r\n    obj.counter += value;\r\n    obj.isOpen = true;\r\n  }\r\n};\r\n\r\nconst _addDialogProps = (items) => {\r\n  Object.keys(items).forEach(propName => {\r\n    const item = items[propName]\r\n        , addProps = item.addProps;\r\n    if (addProps !== undefined) {\r\n      //Object.assign(item.dialogProps, items[addProps].dialogProps)\r\n      item.dialogProps = Object.assign({},\r\n        items[addProps].dialogProps,\r\n        item.dialogProps\r\n      )\r\n    }\r\n  })\r\n}\r\n\r\nconst BrowserSlice = {\r\n  browserMenu : BrowserMenu,\r\n  routeDialog : {\r\n    QE : DataQE,\r\n    WL : DataWL\r\n  },\r\n\r\n  getBrowserMenu(browserType){\r\n     return this.browserMenu[browserType];\r\n  },\r\n  isWithItemCounter(browserType){\r\n    const _config = BrowserConfig[browserType]\r\n    if (typeof _config === 'undefined'){\r\n      return false;\r\n    } else {\r\n      return !_config.withoutItemCounter;\r\n    }\r\n    //return !BrowserConfig[browserType].withoutItemCounter;\r\n  },\r\n  setMenuItemOpen(chartType, browserType){\r\n    if (this.isWithItemCounter(browserType)){\r\n       fnSetIsOpen(chartType, this.browserMenu, browserType, true);\r\n    }\r\n  },\r\n  setMenuItemClose(chartType, browserType){\r\n    if (this.isWithItemCounter(browserType)){\r\n      fnSetIsOpen(chartType, this.browserMenu, browserType, false);\r\n    }\r\n  },\r\n  addMenuItemCounter(chartType, browserType){\r\n    if (this.isWithItemCounter(browserType)){\r\n      fnAddCounter(chartType, browserType, this.browserMenu, 1);\r\n    }\r\n  },\r\n  minusMenuItemCounter(chartType, browserType){\r\n    if (this.isWithItemCounter(browserType)){\r\n      fnAddCounter(chartType, browserType, this.browserMenu, -1);\r\n    }\r\n  },\r\n\r\n  getSourceConfig(browserId, sourceId){\r\n    if (sourceId.indexOf(BrowserType.STOCKS_BY_SECTORS) > 0){\r\n      return BrowserConfig[browserId];\r\n    }\r\n    const _r = this.routeDialog[browserId];\r\n    return _r ? _r[sourceId] : undefined;\r\n  },\r\n\r\n  onShowBrowser(browserType){\r\n    this.trigger(BA.SHOW_BROWSER, browserType);\r\n  },\r\n\r\n  onShowBrowserDynamicCompleted(option){\r\n    const { browserType } = option;\r\n    if (!this.browserMenu[browserType]) {\r\n      Factory.crAsyncBrowser(option)\r\n        .then(elBrowser => {\r\n           this.browserMenu[browserType] = [];\r\n           this.trigger(\r\n              BA.INIT_BROWSER_DYNAMIC,\r\n              elBrowser\r\n           );\r\n        })\r\n        .catch(err => {\r\n          //this.showAlertDialog(option);\r\n          console.log(err)\r\n        })\r\n    } else {\r\n       this.trigger(BA.SHOW_BROWSER_DYNAMIC, browserType);\r\n    }\r\n  },\r\n  onShowBrowserDynamicFailed(option){\r\n      this.showAlertDialog(option)\r\n      this.trigger(BA.SHOW_BROWSER_DYNAMIC + C.FAILED)\r\n  },\r\n\r\n  onLoadBrowserDynamicCompleted(option){\r\n    const { json, browserType } = option;\r\n    if (this.isWithItemCounter(browserType)){\r\n      const { menu, items } = json\r\n          , elMenu = BrowserMenu.createMenu(menu, items, browserType);\r\n      _addDialogProps(items);\r\n\r\n      this.routeDialog[browserType] = items;\r\n      this.browserMenu[browserType] = elMenu;\r\n      this.trigger(BA.LOAD_BROWSER_DYNAMIC_COMPLETED, {\r\n         menuItems : elMenu, browserType: browserType\r\n      })\r\n    } else {\r\n      this.trigger(BA.LOAD_BROWSER_DYNAMIC_COMPLETED, {\r\n               json, browserType\r\n      })\r\n    }\r\n  },\r\n  onLoadBrowserDynamicFailed(option){\r\n    const { alertItemId, caption } = option;\r\n    option.alertItemId = alertItemId || caption\r\n    this.showAlertDialog(option);\r\n  }\r\n\r\n}\r\n\r\nexport default BrowserSlice\r\n"]}