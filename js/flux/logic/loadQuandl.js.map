{"version":3,"sources":["../../../src/flux/logic/loadQuandl.js"],"names":["_loadToChartComp","option","onCompleted","onFailed","uri","getRequestUrl","onCheckResponse","checkResponse","onFetch","fnFetchToChartComp","onCatch","json","toConfig","config","_loadToChart","onAdded","fnFetchToChart","series","toSeries","chart","getActiveChart","addSeriaWithRenderLabel","value","loadQuandl","parentId","isLoadToChart"],"mappings":";;;;;;;AACA;;AACA;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,mBAAmB,SAAnBA,gBAAmB,CAASC,MAAT,EAAiBC,WAAjB,EAA8BC,QAA9B,EAAuC;AAC9D,mBAAQ;AACNC,SAAM,oBAAUC,aAAV,CAAwBJ,MAAxB,CADA;AAENA,YAASA,MAFH;AAGNK,qBAAkB,oBAAUC,aAHtB;AAINC,aAAUC,kBAJJ;AAKNP,iBAAcA,WALR;AAMNQ,6BANM;AAONP,cAAWA;AAPL,GAAR;AASD,CAVD;;AAYA,IAAMM,qBAAqB,SAArBA,kBAAqB,OAAqC;AAAA,MAA3BE,IAA2B,QAA3BA,IAA2B;AAAA,MAArBV,MAAqB,QAArBA,MAAqB;AAAA,MAAbC,WAAa,QAAbA,WAAa;;AAAA,8BAC7C,wBAAcU,QAAd,CAAuBD,IAAvB,EAA6BV,MAA7B,CAD6C;AAAA,MACvDY,MADuD,yBACvDA,MADuD;;AAE9DX,cAAYD,MAAZ,EAAoBY,MAApB;AACD,CAHD;;AAKA,IAAMC,eAAe,SAAfA,YAAe,CAASb,MAAT,EAAiBc,OAAjB,EAA0BZ,QAA1B,EAAmC;AACtD,mBAAQ;AACNC,SAAM,oBAAUC,aAAV,CAAwBJ,MAAxB,CADA;AAENA,YAASA,MAFH;AAGNK,qBAAkB,oBAAUC,aAHtB;AAINC,aAAUQ,cAJJ;AAKNd,iBAAca,OALR;AAMNL,6BANM;AAONP,cAAWA;AAPL,GAAR;AASD,CAVD;;AAYA,IAAMa,iBAAiB,SAAjBA,cAAiB,QAAuC;AAAA,MAA5BL,IAA4B,SAA5BA,IAA4B;AAAA,MAAtBV,MAAsB,SAAtBA,MAAsB;AAAA,MAAdC,WAAc,SAAdA,WAAc;;AAC5D,MAAMe,SAAS,wBAAcC,QAAd,CAAuBP,IAAvB,EAA6BV,MAA7B,CAAf;AAAA,MACMkB,QAAQ,qBAAWC,cAAX,EADd;;AAGA,oBAAQC,uBAAR,CAAgCF,KAAhC,EAAuCF,MAAvC,EAA+ChB,OAAOqB,KAAtD;AACApB,cAAYD,MAAZ;AACD,CAND;;AAQA,IAAMsB,aAAa,SAAbA,UAAa,CAAStB,MAAT,EAAiBC,WAAjB,EAA8Ba,OAA9B,EAAuCZ,QAAvC,EAAgD;AACjE,MAAMqB,WAAW,qBAAWC,aAAX,EAAjB;AACA,MAAI,CAACD,QAAL,EAAc;AACXxB,qBAAiBC,MAAjB,EAAyBC,WAAzB,EAAsCC,QAAtC;AACF,GAFD,MAEO;AACJF,WAAOuB,QAAP,GAAkBA,QAAlB;AACAV,iBAAab,MAAb,EAAqBc,OAArB,EAA8BZ,QAA9B;AACF;AACF,CARD;;QAUSoB,U,GAAAA,U;QAAYd,kB,GAAAA,kB;QAAoBO,c,GAAAA,c","file":"loadQuandl.js","sourcesContent":["\r\nimport {fnFetch} from '../../utils/fn';\r\nimport {fnCatch} from './fnCatch';\r\nimport ChartStore from '../stores/ChartStore';\r\n\r\nimport ChartFn from '../../charts/ChartFn';\r\nimport QuandlApi from '../../api/QuandlApi';\r\nimport QuandlAdapter from '../../adapters/QuandlAdapter';\r\n\r\nconst _loadToChartComp = function(option, onCompleted, onFailed){\r\n  fnFetch({\r\n    uri : QuandlApi.getRequestUrl(option),\r\n    option : option,\r\n    onCheckResponse : QuandlApi.checkResponse,\r\n    onFetch : fnFetchToChartComp,\r\n    onCompleted : onCompleted,\r\n    onCatch : fnCatch,\r\n    onFailed : onFailed\r\n  })\r\n}\r\n\r\nconst fnFetchToChartComp = function({json, option, onCompleted}){\r\n  const {config} = QuandlAdapter.toConfig(json, option);\r\n  onCompleted(option, config);\r\n}\r\n\r\nconst _loadToChart = function(option, onAdded, onFailed){\r\n  fnFetch({\r\n    uri : QuandlApi.getRequestUrl(option),\r\n    option : option,\r\n    onCheckResponse : QuandlApi.checkResponse,\r\n    onFetch : fnFetchToChart,\r\n    onCompleted : onAdded,\r\n    onCatch : fnCatch,\r\n    onFailed : onFailed\r\n  })\r\n}\r\n\r\nconst fnFetchToChart = function({ json, option, onCompleted }){\r\n  const series = QuandlAdapter.toSeries(json, option)\r\n      , chart = ChartStore.getActiveChart();\r\n\r\n  ChartFn.addSeriaWithRenderLabel(chart, series, option.value);\r\n  onCompleted(option);\r\n}\r\n\r\nconst loadQuandl = function(option, onCompleted, onAdded, onFailed){\r\n  const parentId = ChartStore.isLoadToChart();\r\n  if (!parentId){\r\n     _loadToChartComp(option, onCompleted, onFailed);\r\n  } else {\r\n     option.parentId = parentId;\r\n     _loadToChart(option, onAdded, onFailed);\r\n  }\r\n}\r\n\r\nexport { loadQuandl, fnFetchToChartComp, fnFetchToChart }\r\n"]}