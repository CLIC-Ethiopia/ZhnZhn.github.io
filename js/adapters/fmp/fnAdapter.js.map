{"version":3,"sources":["../../../src/adapters/fmp/fnAdapter.js"],"names":["_isNaN","Number","isNaN","_crHistoricalItemConf","data","option","itemCaption","dataSource","items","dfT","dfPn","_itemKey","_crHistZhConfig","itemConf","_crName","map","getCaption","join","_crInfo","_itemUrl","name","fnAdapter","crError","getFromDate","getValue","crData","json","_propName","_metrics","_data","forEach","item","_v","parseFloat","push","date","reverse","sort","compareByDate","crCaption","title","subtitle","addConfOption","info","crHistOption","zhConfig"],"mappings":"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","sourcesContent":["import {\r\n  crZhConfig,\r\n  getFromDate,\r\n  getCaption,\r\n  getValue,\r\n  joinBy,\r\n  ymdToUTC\r\n} from '../AdapterFn';\r\nimport { compareByDate } from '../compareByFn';\r\nimport {\r\n  crError,\r\n  crItemConf,\r\n  crValueConf\r\n} from '../crFn';\r\n\r\nconst _isNaN = Number.isNaN;\r\n\r\nconst _crHistoricalItemConf = (data, option) => {\r\n  const {\r\n    itemCaption, dataSource,\r\n    items, dfT, dfPn\r\n  } = option;\r\n  return {\r\n    ...crItemConf(option),\r\n    ...crValueConf(data),\r\n    _itemKey: 'FMP/' + itemCaption,\r\n    dataSource,\r\n    items, dfT, dfPn\r\n  };\r\n}\r\n\r\nconst _crHistZhConfig = (data, option) => ({\r\n  ...crZhConfig(option),\r\n  itemConf: _crHistoricalItemConf(data, option)\r\n});\r\n\r\nconst _crName = items => items\r\n  .map(getCaption)\r\n  .join(': ');\r\n\r\nconst _crInfo = ({ items, _itemUrl }) => ({\r\n  name: _crName(items)\r\n});\r\n\r\nconst fnAdapter = {\r\n  crError,\r\n  getFromDate,\r\n  getCaption,\r\n  getValue,\r\n\r\n  crData: (json, option) => {\r\n    const { dfPn, _propName } = option\r\n    , _metrics = dfPn ? json[dfPn] : json\r\n    , _data = [];\r\n    _metrics.forEach(item => {\r\n      const _v = parseFloat(item[_propName]);\r\n      if (!_isNaN(_v)) {\r\n        _data.push([ymdToUTC(item.date), _v])\r\n      }\r\n    })\r\n    return _data.reverse().sort(compareByDate);\r\n  },\r\n\r\n  crCaption: ({ items }) => ({\r\n    title: getCaption(items[0]),\r\n    subtitle: joinBy(': ',\r\n       getCaption(items[1]),\r\n       getCaption(items[2])\r\n    )\r\n  }),\r\n  addConfOption: (option) => ({\r\n    info: _crInfo(option)\r\n  }),\r\n  crHistOption: ({ option, data }) => ({\r\n    info: _crInfo(option),\r\n    zhConfig: _crHistZhConfig(data, option),\r\n  })\r\n};\r\n\r\nexport default fnAdapter\r\n"],"file":"fnAdapter.js"}