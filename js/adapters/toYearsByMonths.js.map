{"version":3,"sources":["../../src/adapters/toYearsByMonths.js"],"names":["CATEGORIES","C","NOW","index","color","PREV","AVG","isVisible","RANGE","crValueMoving","fns","roundBy","numberFormat","_getYear","str","split","_getMonth","_crSeria","name","type","data","visible","_crItem","_crPoint","item","c","y","status","_crValuePoint","_crValueYearPoint","v","_findHighLow","arr","h","Number","NEGATIVE_INFINITY","l","POSITIVE_INFINITY","forEach","high","yHigh","yHs","low","yLow","yLs","_crHighLowPoint","key","_calcAvg","sum","reduce","acc","a","length","_crAvgPoint","_crSeriaData","i","year","crPoint","max","push","reverse","_crSeries","firtsItem","_yearNow","_dNow","prevItem","_yearPrev","_dPrev","nowSeria","nowItem","prevSeria","_hmToSeriaData","hm","_crBaseHm","Object","create","_crMonthHm","stopYear","isBreaked","_item","_y","_m","_crRangeSeria","refYear","parseFloat","_stopYear","_data","rangeSeria","areaRangeSeria","Tooltip","categoryRHLY","point","toSeria","rangeItem","_findStartYearIndex","yearStop","_crAvgSeria","yearNow","fromYear","startIndex","avgSeria","avgItem","_crZhConfig","option","legend","value","itemCaption","dataSource","linkFn","_id","id","isWithoutIndicator","_crValueAndDate","seria","date","_crValueMoving","bNowValue","bPrevValue","dateTo","moving","valueTo","isDenyToChange","_checkIfEnoughData","_len","errCaption","message","toMonthly","toConfig","title","subtitle","config","categoryConfig","addCaption","addSeriaBy","addTooltip","categorySimple","add","chart","spacingTop","marginTop","zhConfig","valueMoving"],"mappings":"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","sourcesContent":["import Builder from '../charts/ConfigBuilder'\r\nimport Tooltip from '../charts/Tooltip'\r\n\r\nimport fns from './AdapterFn'\r\n\r\nconst CATEGORIES = [\r\n  '01', '02', '03', '04', '05', '06',\r\n  '07', '08', '09', '10', '11', '12'\r\n];\r\n\r\nconst C = {\r\n  NOW: {\r\n    index: 3,\r\n    color: 'yellow',\r\n  },\r\n  PREV: {\r\n    index: 2,\r\n    color: '#f45b5b'\r\n  },\r\n  AVG: {\r\n    index: 1,\r\n    color: 'black',\r\n    isVisible: false\r\n  },\r\n  RANGE: {\r\n    index: 0,\r\n    color: '#7cb5ec'\r\n  }\r\n};\r\n\r\nconst {\r\n  crValueMoving,\r\n  roundBy,\r\n  numberFormat\r\n} = fns;\r\n\r\nconst _getYear = str => str.split(\"-\")[0];\r\nconst _getMonth = str => str.split(\"-\")[1];\r\n\r\nconst _crSeria = (\r\n  name, { type='spline', data, color, isVisible=true }\r\n) => ({\r\n  type, name, data, color, visible: isVisible\r\n});\r\nconst _crItem = (\r\n  name, { index, color, isVisible=true }\r\n) => ({\r\n   name, index, color, isVisible\r\n});\r\n\r\nconst _crPoint = item => ({\r\n  c: _getMonth(item[0]),\r\n  y: item[1],\r\n  status: item[2]\r\n});\r\nconst _crValuePoint = item => item[1];\r\nconst _crValueYearPoint = item => ({\r\n  v: item[1],\r\n  y: _getYear(item[0]),\r\n  status: item[2]\r\n});\r\nconst _findHighLow = (arr) => {\r\n  let h = { v: Number.NEGATIVE_INFINITY, y: '' },\r\n      l = { v: Number.POSITIVE_INFINITY, y: '' };\r\n  arr.forEach(item => {\r\n    if (item.v > h.v) {\r\n      h = item\r\n    }\r\n    if (item.v < l.v ) {\r\n      l = item\r\n    }\r\n  })\r\n  return {\r\n    high: h.v, yHigh: h.y, yHs: h.status,\r\n    low: l.v, yLow: l.y, yLs: l.status\r\n  };\r\n}\r\nconst _crHighLowPoint = (key, arr) => {\r\n  return {\r\n      c: key,\r\n      ..._findHighLow(arr)\r\n  };\r\n}\r\nconst _calcAvg = (arr) => {\r\n  const sum = arr.reduce((acc, a) => acc + a, 0)\r\n  return arr.length !== 0\r\n    ? roundBy(sum/arr.length, 4)\r\n    : 0;\r\n};\r\nconst _crAvgPoint = (key, arr) => ({\r\n  y: _calcAvg(arr),\r\n  c: key\r\n});\r\n\r\nconst _crSeriaData = (data, i, year, crPoint=_crPoint) => {\r\n  const arr=[], max=data.length;\r\n  for (; i<max; i++){\r\n    const item = data[i]\r\n    if (_getYear(item[0]) !== year) {\r\n      break;\r\n    }\r\n    arr.push( crPoint(item) )\r\n  }\r\n  return { i, arr: arr.reverse() };\r\n}\r\n\r\nconst _crSeries = (data) => {\r\n  const firtsItem = data[0][0]\r\n  , _yearNow = _getYear(firtsItem)\r\n  , { i, arr:_dNow } = _crSeriaData(data, 0, _yearNow)\r\n  , prevItem = data[i][0]\r\n  , _yearPrev = _getYear(prevItem)\r\n  , { arr:_dPrev } = _crSeriaData(data, i, _yearPrev);\r\n\r\n  return {\r\n    nowSeria: _crSeria(_yearNow, { ...C.NOW, ...{data: _dNow} } ),\r\n    nowItem: _crItem(_yearNow, C.NOW),\r\n    prevSeria: _crSeria(_yearPrev, { ...C.PREV, ...{data: _dPrev} }),\r\n    prevItem: _crItem(_yearPrev, C.PREV)\r\n  };\r\n}\r\n\r\nconst _hmToSeriaData = (hm, crPoint) => {\r\n  const data = [];\r\n  CATEGORIES.forEach(key => {\r\n    data.push(crPoint(key, hm[key]))\r\n  })\r\n  return data;\r\n}\r\n\r\nconst _crBaseHm = () => {\r\n  const hm = Object.create(null);\r\n  CATEGORIES.forEach(key => {\r\n    hm[key] = []\r\n  })\r\n  return hm;\r\n}\r\nconst _crMonthHm = (i, data, stopYear, crPoint=_crValuePoint) => {\r\n  const hm = _crBaseHm()\r\n      , max = data.length;\r\n  let isBreaked = false;\r\n  for (;i<max;i++){\r\n    const _item = data[i]\r\n        , _y = _item[0];\r\n    if (_y === stopYear ) {\r\n      isBreaked = true\r\n      break;\r\n    }\r\n    const _m = _getMonth(_item[0])\r\n    //hm[_m].push(_item[1])\r\n    hm[_m].push(crPoint(_item))\r\n  }\r\n\r\n  return { hm, isBreaked };\r\n}\r\n\r\n\r\nconst _crRangeSeria = (data) => {\r\n  const refYear = parseFloat(_getYear(data[0][0]))\r\n      , stopYear = '' + (refYear - 5)\r\n      , { hm, isBreaked } = _crMonthHm(\r\n            0, data, stopYear, _crValueYearPoint\r\n        )\r\n      , max = data.length\r\n      , _stopYear = isBreaked\r\n           ? stopYear\r\n           : _getYear(data[max-1][0])\r\n      , name = `Range ${refYear}:${_stopYear}`\r\n      , _data = _hmToSeriaData(hm, _crHighLowPoint);\r\n\r\n  return {\r\n    rangeSeria: Builder()\r\n      .areaRangeSeria(\r\n         Tooltip.categoryRHLY, {\r\n           data: _data,\r\n           name: name,\r\n           point: {}\r\n         }\r\n       ).toSeria(),\r\n    rangeItem: _crItem(name, C.RANGE)\r\n  };\r\n}\r\n\r\nconst _findStartYearIndex = (data, yearStop) => {\r\n  const max = data.length;\r\n  let i = 0;\r\n  for(;i<max;i++){\r\n    if (_getYear(data[i][0]) !== yearStop ) {\r\n       break;\r\n    }\r\n  }\r\n  return i;\r\n}\r\n\r\nconst _crAvgSeria = (data) => {\r\n  const yearNow = _getYear(data[0][0])\r\n      , fromYear = parseFloat(yearNow) - 1\r\n      , stopYear = '' + (parseFloat(yearNow) - 5)\r\n      , max = data.length\r\n      , startIndex = _findStartYearIndex(data, yearNow)\r\n      , { hm, isBreaked } = _crMonthHm(startIndex, data, stopYear)\r\n      , _stopYear = isBreaked\r\n           ? stopYear\r\n           : _getYear(data[max-1][0])\r\n      , _data = _hmToSeriaData(hm, _crAvgPoint)\r\n      , name = `Avg ${fromYear}:${_stopYear}`;\r\n\r\n  return {\r\n    avgSeria: _crSeria(name, {...C.AVG, ...{data: _data}}),\r\n    avgItem: _crItem(name, C.AVG)\r\n  };\r\n}\r\n\r\nconst _crZhConfig = (option, { legend }) => {\r\n  const {\r\n    value, itemCaption,\r\n    dataSource, linkFn, item,\r\n  } = option\r\n  , _id = value + '_' + 'YEARLY';\r\n  return {\r\n    id: _id,\r\n    key: _id,\r\n    itemCaption,\r\n    isWithoutIndicator: true,\r\n    legend, dataSource, linkFn, item\r\n  };\r\n}\r\n\r\n\r\nconst _crValueAndDate = (seria, index) => {\r\n  const { data=[], name } = seria\r\n      , { y:value, c } = data[index];\r\n  return {\r\n    value,\r\n    date: `${c}-${name}`\r\n  };\r\n}\r\nconst _crValueMoving = (nowSeria, prevSeria) => {\r\n  const { data=[] } = nowSeria\r\n      , max = data.length - 1\r\n      , {\r\n          value:bNowValue,\r\n          date\r\n        } = _crValueAndDate(nowSeria, max)\r\n      , {\r\n          value:bPrevValue,\r\n          date:dateTo\r\n        } = _crValueAndDate(prevSeria, max)\r\n      , moving = crValueMoving({\r\n            bNowValue,\r\n            bPrevValue\r\n        });\r\n\r\n  return {\r\n    ...moving, date, dateTo,\r\n    valueTo: numberFormat(bPrevValue),\r\n    isDenyToChange: true\r\n  };\r\n};\r\n\r\nconst _checkIfEnoughData = data => {\r\n  const _len = data?.length;\r\n  if (_len<=12) {\r\n    throw {\r\n      errCaption: \"Data Error\",\r\n      message: `Not enough data for chart (${_len})`\r\n    };\r\n  }\r\n};\r\n\r\nconst toMonthly = {\r\n  toConfig(data, option) {\r\n    _checkIfEnoughData(data)\r\n    const { title, subtitle } = option\r\n    , {\r\n        nowSeria, nowItem,\r\n        prevSeria, prevItem\r\n      } = _crSeries(data)\r\n    , { rangeSeria, rangeItem } = _crRangeSeria(data)\r\n    , { avgSeria, avgItem } = _crAvgSeria(data)\r\n    , legend = [ nowItem, prevItem, rangeItem, avgItem ]\r\n    , config = Builder()\r\n       .categoryConfig(CATEGORIES)\r\n       .addCaption(title, subtitle)\r\n       .addSeriaBy(0, rangeSeria)\r\n       .addSeriaBy(1, avgSeria)\r\n       .addSeriaBy(2, prevSeria)\r\n       .addSeriaBy(3, nowSeria)\r\n       .addTooltip(Tooltip.categorySimple)\r\n       .add({\r\n         chart: { spacingTop: 25, marginTop: 45 },\r\n         zhConfig: _crZhConfig(option, { legend }),\r\n         valueMoving:  _crValueMoving(nowSeria, prevSeria)\r\n       })\r\n       .toConfig();\r\n\r\n    return config;\r\n  }\r\n}\r\n\r\nexport default toMonthly\r\n"],"file":"toYearsByMonths.js"}