{"version":3,"sources":["../../../src/adapters/uncomtrade/Api.js"],"names":["C","PERIOD","ALL","BU_ALL_PARAMS","NU_ALL_PARAMS","BU_PREFIX","NU_PREFIX","DF_RG","DF_MEASURE","_crPeriod","period","yearNow","Date","getUTCFullYear","arr","i","push","reverse","join","UnComtradeApi","getRequestUrl","option","one","two","rg","_ps","nativeHref","checkResponse","json","addPropsTo","v","measure","substring","split","Object","assign"],"mappings":"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","sourcesContent":["\r\nconst C = {\r\n  PERIOD: 5,\r\n  ALL: 'all',\r\n  BU_ALL_PARAMS: 'p=0&max=3000',\r\n  NU_ALL_PARAMS: 'p=0',\r\n  //rg=2 Export\r\n  BU_PREFIX: 'https://comtrade.un.org/api/get?fmt=JSON&head=M&freq=A&px=H4',\r\n  NU_PREFIX: 'https://comtrade.un.org/db/dqBasicQueryResults.aspx?px=H4&y=2017&so=1001',\r\n\r\n  DF_RG: 2,\r\n  DF_MEASURE: 'NetWeight'\r\n};\r\n\r\n\r\nconst _crPeriod = (period) => {\r\n  const yearNow = (new Date()).getUTCFullYear()\r\n  , arr = [];\r\n  for(let i=1; i<=period; i++) {\r\n    arr.push(yearNow-i)\r\n  }\r\n  return arr.reverse().join(',');\r\n};\r\n\r\nconst UnComtradeApi = {\r\n  getRequestUrl(option){\r\n    const { one=C.ALL, two, rg=2 } = option\r\n    , _ps = _crPeriod(C.PERIOD);\r\n    if (one !== C.ALL) {\r\n      option.nativeHref = `${C.NU_PREFIX}&r=${one}&cc=${two}`;\r\n      return `${C.BU_PREFIX}&rg=${rg}&r=${one}&cc=${two}&ps=${_ps}`;\r\n    } else {\r\n      option.nativeHref = `${C.NU_PREFIX}&${C.NU_ALL_PARAMS}&r=${one}&cc=${two}`;\r\n      return `${C.BU_PREFIX}&${C.BU_ALL_PARAMS}&rg=${rg}&r=${one}&cc=${two}&ps=${_ps}`;\r\n    }\r\n  },\r\n\r\n  checkResponse(json){\r\n    return true;\r\n  },\r\n\r\n  addPropsTo(option){\r\n    const {\r\n            one, v,\r\n            rg=C.DF_RG,\r\n            measure=C.DF_MEASURE\r\n          } = option;\r\n\r\n    if (!one) {\r\n      const arr = v.substring(3).split('_')\r\n      Object.assign(option, {\r\n        one: arr[0],\r\n        two: arr[1]\r\n      })\r\n    }\r\n\r\n    Object.assign(option, { rg, measure })\r\n  }\r\n};\r\n\r\nexport default UnComtradeApi\r\n"],"file":"Api.js"}