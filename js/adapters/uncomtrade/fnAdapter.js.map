{"version":3,"sources":["../../../src/adapters/uncomtrade/fnAdapter.js"],"names":["fnAdapter","crChartId","option","value","rg","measure","crSeriaOption","id","zhSeriaId","crMarker","color","fillColor","lineColor","lineWidth","radius","symbol","crInfo","json","description","fnDescr","toDescr","frequency","crZhConfig","dataSource","nativeHref","_id","key","isWithoutAdd","isWithLegend","legend","linkFn","item","addSeriaTo","config","hm","name","i","seriaOption","isShow","zhConfig","_color","ChartConfig","getColor","_seriaColor","marker","_seriaOption","C","SPLINE","SPLINE_NOT_VISIBLE","setSerieData","push","AdapterFn","legendItem","addSeriesFromHmTo","fromIndex","fnHm","toSeriaNames","compareByValue","forEach","_isShow","MAX_SHOW","addSeriasTo","one","dataset","ALL","toHmCategories","pnValue","pnCountry","categories","WORLD","WORLD_COLOR","fnLegend","toWorldLegend","toAllLegend","Object","assign","xAxis","crBaseConfig","title","subtitle","areaConfig","add","CHART","addCaption","X_AXIS","Y_AXIS","addTooltip","Tooltip","categorySimple","toConfig"],"mappings":"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","sourcesContent":["import ChartConfig from '../../charts/ChartConfig'\r\nimport Builder from '../../charts/ConfigBuilder'\r\nimport Tooltip from '../../charts/Tooltip'\r\n\r\nimport AdapterFn from '../AdapterFn'\r\n\r\nimport fnDescr from './fnDescr'\r\nimport fnHm from './fnHm'\r\nimport fnLegend from './fnLegend'\r\n\r\nimport C from './conf'\r\n\r\nconst fnAdapter = {\r\n\r\n  crChartId: option => {\r\n    const { value, rg=2, measure=\"A\" } = option;\r\n    return value + '_' + rg + '_' + measure;\r\n  },\r\n\r\n  crSeriaOption: id => {\r\n    return { zhSeriaId: id };\r\n  },\r\n\r\n  crMarker: color => {\r\n    return {\r\n      fillColor: color,\r\n      lineColor: color,\r\n      lineWidth: 1,\r\n      radius: 4,\r\n      symbol: 'circle'\r\n    };\r\n  },\r\n\r\n  crInfo: json => ({\r\n    description: fnDescr.toDescr(json),\r\n    frequency: \"Annual\"\r\n  }),\r\n\r\n  crZhConfig(option) {\r\n    const { dataSource, nativeHref } = option\r\n        , _id = this.crChartId(option);\r\n    return {\r\n      id: _id,\r\n      key: _id,\r\n      isWithoutAdd: true,\r\n      isWithLegend: true,\r\n      legend: [],\r\n      dataSource: dataSource,\r\n      linkFn: \"UN_COMTRADE\",\r\n      item: nativeHref\r\n    };\r\n  },\r\n\r\n  addSeriaTo({\r\n    config, hm,\r\n    name, i, color,\r\n    seriaOption, isShow=false\r\n  }) {\r\n    const { key, legend } = config.zhConfig\r\n        , _color = color || ChartConfig.getColor(i)\r\n        , _seriaColor = {\r\n             color: _color,\r\n             marker: this.crMarker(_color)\r\n          }\r\n        , _seriaOption = (seriaOption !== null)\r\n               ? isShow\r\n                  ? { ...C.SPLINE, ..._seriaColor }\r\n                  : { ...C.SPLINE_NOT_VISIBLE, ..._seriaColor }\r\n               : null;\r\n\r\n    ChartConfig.setSerieData(\r\n      config, hm[name], i, name, _seriaOption,\r\n      this.crSeriaOption(key + '_' + name)\r\n    )\r\n    legend.push(\r\n       AdapterFn.legendItem(i, _color, name, isShow)\r\n    )\r\n  },\r\n\r\n  addSeriesFromHmTo({ config, hm, fromIndex }) {\r\n    let i=fromIndex;\r\n\r\n    fnHm.toSeriaNames(hm, AdapterFn.compareByValue)\r\n      .forEach(item => {\r\n         const name = item.name\r\n             , _isShow = i<C.MAX_SHOW ? true : false ;\r\n         this.addSeriaTo({ config, hm, name, i, isShow: _isShow })\r\n         i++\r\n      })\r\n  },\r\n\r\n  addSeriasTo(config, json, option) {\r\n    const { one, measure } = option\r\n        , { dataset=[] } = json\r\n        , { hm, categories } = (one !== C.ALL)\r\n              ? fnHm.toHmCategories({\r\n                   dataset,\r\n                   pnValue: measure\r\n                })\r\n              : fnHm.toHmCategories({\r\n                   dataset,\r\n                   pnValue: measure,\r\n                   pnCountry: 'rtTitle'\r\n                });\r\n\r\n    if (hm[C.WORLD] && one !== C.ALL) {\r\n      this.addSeriaTo({\r\n         config, hm,\r\n         i: 0, name: C.WORLD, color: C.WORLD_COLOR,\r\n         seriaOption: null, isShow: true\r\n      })\r\n      this.addSeriesFromHmTo({ config, hm, fromIndex: 1 });\r\n    } else {\r\n      this.addSeriesFromHmTo({ config, hm, fromIndex: 0 });\r\n    }\r\n\r\n    const legend = config.zhConfig.legend;\r\n    config.zhConfig.legend = (one !== C.ALL)\r\n       ? fnLegend.toWorldLegend(legend, hm)\r\n       : fnLegend.toAllLegend(legend, hm, measure)\r\n\r\n    Object.assign(config.xAxis, { categories })\r\n  },\r\n\r\n  crBaseConfig(json, option) {\r\n    const { title, subtitle } = option;\r\n    return Builder()\r\n      .areaConfig()\r\n      .add('chart', C.CHART)\r\n      .addCaption(title, subtitle)\r\n      .add('xAxis', C.X_AXIS)\r\n      .add('yAxis', C.Y_AXIS)\r\n      .addTooltip(Tooltip.categorySimple)\r\n      .add('info', this.crInfo(json))\r\n      .add('zhConfig', this.crZhConfig(option))\r\n      .toConfig();\r\n  },\r\n\r\n  toConfig(json, option){\r\n    const config = this.crBaseConfig(json, option);\r\n    this.addSeriasTo(config, json, option)\r\n\r\n    return config;\r\n  }\r\n\r\n};\r\n\r\nexport default fnAdapter\r\n"],"file":"fnAdapter.js"}