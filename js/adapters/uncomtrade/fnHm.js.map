{"version":3,"sources":["../../../src/adapters/uncomtrade/fnHm.js"],"names":["fnHm","crAvgPricePoint","TradeValue","item","NetWeight","_y","parseFloat","toFixed","undefined","y","forSort","fValue","pnValue","AVG_PRICE","fPoint","_crValue","isCategory","x","period","toArr","obj","arr","propName","push","sort","toSeriaNames","hm","WORLD","points","value","length","name","compareByValue","reverse","toHmCategories","dataset","pnCountry","Object","create","_category","_crPoint","forEach","ptTitle","categories"],"mappings":";;;;;;;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,OAAO;;AAEXC,mBAAiB,+BAAQ;AAAA,QACfC,UADe,GACWC,IADX,CACfD,UADe;AAAA,QACHE,SADG,GACWD,IADX,CACHC,SADG;AAAA,QAEjBC,EAFiB,GAEXD,aAAaF,cAAc,IAA5B,GACAI,WAAW,CAACJ,aAAWE,SAAZ,EAAuBG,OAAvB,CAA+B,CAA/B,CAAX,CADA,GAEAC,SAJY;;AAKvB,WAAO;AACLC,SAAGJ,EADE;AAELK,eAASN;AAFJ,KAAP;AAID,GAXU;;AAaXO,QAbW,kBAaJC,OAbI,EAaK;AACd,YAAOA,OAAP;AACE,WAAK,eAAEC,SAAP;AACE,eAAO,KAAKZ,eAAZ;AACF;AACE,eAAO,gBAAQ;AACZ,iBAAO;AACLQ,eAAGN,KAAKS,OAAL,CADE;AAELF,qBAASP,KAAKS,OAAL;AAFJ,WAAP;AAIF,SALD;AAJJ;AAWD,GAzBU;AA2BXE,QA3BW,kBA2BJF,OA3BI,EA2BK;AACd,QAAMG,WAAW,KAAKJ,MAAL,CAAYC,OAAZ,CAAjB;AACA,WAAO,gBAAQ;AACb;AACEI,oBAAY,IADd;AAEEC,WAAGd,KAAKe;AAFV,SAIKH,SAASZ,IAAT,CAJL;AAMD,KAPD;AAQD,GArCU;;;AAuCXgB,SAAO,eAACC,GAAD,EAAS;AACd,QAAMC,MAAM,EAAZ;AACA,QAAIC,iBAAJ;AACA,SAAKA,QAAL,IAAiBF,GAAjB,EAAqB;AACnBC,UAAIE,IAAJ,CAASH,IAAIE,QAAJ,CAAT;AACD;AACD,WAAOD,IAAIG,IAAJ,EAAP;AACD,GA9CU;;AAgDXC,gBAAc,sBAACC,EAAD,EAAQ;AACpB,QAAML,MAAM,EAAZ;AACA;AACA,SAAK,IAAIC,QAAT,IAAqBI,EAArB,EAAwB;AACtB,UAAIJ,aAAa,eAAEK,KAAnB,EAA0B;AACxB,YAAMC,SAASF,GAAGJ,QAAH,CAAf;AACAD,YAAIE,IAAJ,CAAS;AACPM,iBAAOD,OAAOA,OAAOE,MAAP,GAAc,CAArB,EAAwBpB,OADxB;AAEPqB,gBAAMT;AAFC,SAAT;AAID;AACF;AACD,WAAOD,IAAIG,IAAJ,CAAS,oBAAUQ,cAAnB,EAAmCC,OAAnC,EAAP;AACD,GA7DU;;AA+DXC,gBA/DW,gCAmER;AAAA,QAHDC,OAGC,QAHDA,OAGC;AAAA,8BAFDC,SAEC;AAAA,QAFDA,SAEC,kCAFS,SAET;AAAA,4BADDxB,OACC;AAAA,QADDA,OACC,gCADO,YACP;;AACD,QAAMc,KAAKW,OAAOC,MAAP,CAAc,IAAd,CAAX;AAAA,QACMC,YAAYF,OAAOC,MAAP,CAAc,IAAd,CADlB;AAAA,QAEME,WAAW,KAAK1B,MAAL,CAAYF,OAAZ,CAFjB;;AAIAuB,YAAQM,OAAR,CAAgB,gBAAQ;AACtB,UAAMC,UAAUvC,KAAKiC,SAAL,CAAhB;AACA,UAAIV,GAAGgB,OAAH,MAAgBlC,SAApB,EAA+B;AAC7BkB,WAAGgB,OAAH,IAAc,EAAd;AACD;AACDhB,SAAGgB,OAAH,EAAYnB,IAAZ,CAAiBiB,SAASrC,IAAT,CAAjB;;AAEA,UAAMe,SAASf,KAAKe,MAApB;AACA,UAAIqB,UAAUrB,MAAV,MAAsBV,SAA1B,EAAqC;AACnC+B,kBAAUrB,MAAV,IAAoBA,MAApB;AACD;AACF,KAXD;;AAaA,QAAMyB,aAAa,KAAKxB,KAAL,CAAWoB,SAAX,CAAnB;;AAEA,WAAO,EAAEb,MAAF,EAAMiB,sBAAN,EAAP;AACD;AAxFU,CAAb;;kBA4Fe3C,I","file":"fnHm.js","sourcesContent":["\r\nimport AdapterFn from '../AdapterFn'\r\nimport C from './conf'\r\n\r\nconst fnHm = {\r\n\r\n  crAvgPricePoint: item => {\r\n    const { TradeValue, NetWeight } = item\r\n        , _y = (NetWeight && TradeValue != null)\r\n             ? parseFloat((TradeValue/NetWeight).toFixed(2))\r\n             : undefined;\r\n    return {\r\n      y: _y,\r\n      forSort: NetWeight\r\n    };\r\n  },\r\n\r\n  fValue(pnValue) {\r\n    switch(pnValue) {\r\n      case C.AVG_PRICE:\r\n        return this.crAvgPricePoint;\r\n      default:\r\n        return item => {\r\n           return {\r\n             y: item[pnValue],\r\n             forSort: item[pnValue]\r\n           };\r\n        };\r\n    }\r\n  },\r\n\r\n  fPoint(pnValue) {\r\n    const _crValue = this.fValue(pnValue);\r\n    return item => {\r\n      return {\r\n        isCategory: true,\r\n        x: item.period,\r\n        //x: AdapterFn.ymdToUTC('' + item.period + C.MM_DD),\r\n        ..._crValue(item)\r\n      };\r\n    };\r\n  },\r\n\r\n  toArr: (obj) => {\r\n    const arr = [];\r\n    let propName;\r\n    for (propName in obj){\r\n      arr.push(obj[propName])\r\n    }\r\n    return arr.sort();\r\n  },\r\n\r\n  toSeriaNames: (hm) => {\r\n    const arr = [];\r\n    //let propName;\r\n    for (let propName in hm){\r\n      if (propName !== C.WORLD) {\r\n        const points = hm[propName];\r\n        arr.push({\r\n          value: points[points.length-1].forSort,\r\n          name: propName\r\n        })\r\n      }\r\n    }\r\n    return arr.sort(AdapterFn.compareByValue).reverse();\r\n  },\r\n\r\n  toHmCategories({\r\n    dataset,\r\n    pnCountry='ptTitle',\r\n    pnValue='TradeValue'\r\n  }) {\r\n    const hm = Object.create(null)\r\n        , _category = Object.create(null)\r\n        , _crPoint = this.fPoint(pnValue);\r\n\r\n    dataset.forEach(item => {\r\n      const ptTitle = item[pnCountry];\r\n      if (hm[ptTitle] === undefined) {\r\n        hm[ptTitle] = []\r\n      }\r\n      hm[ptTitle].push(_crPoint(item))\r\n\r\n      const period = item.period;\r\n      if (_category[period] === undefined) {\r\n        _category[period] = period\r\n      }\r\n    })\r\n\r\n    const categories = this.toArr(_category);\r\n\r\n    return { hm, categories };\r\n  }\r\n\r\n};\r\n\r\nexport default fnHm\r\n"]}