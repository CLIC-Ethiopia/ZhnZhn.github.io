{"version":3,"sources":["../../../src/adapters/uncomtrade/fnLegend.js"],"names":["fnLegend","fItemWithRatio","hm","sum","item","name","_points","_p","length","_ratio","y","toFixed","calcRecentSum","key","indexOf","WORLD","points","toAllLegend","arr","measure","crItemWithRatio","AVG_PRICE","map","toWorldLegend","world"],"mappings":";;;;;;;;;;AACA;;;;;;AAEA,IAAMA,WAAW;;AAEfC,kBAAgB,wBAACC,EAAD,EAAKC,GAAL;AAAA,WAAa,UAACC,IAAD,EAAU;AAC/B,UAAEC,IAAF,GAAWD,IAAX,CAAEC,IAAF;AAAA,UACAC,OADA,GACUJ,GAAGG,IAAH,CADV;AAAA,UAEAE,EAFA,GAEKD,QAAQA,QAAQE,MAAR,GAAe,CAAvB,CAFL;AAAA,UAGAC,MAHA,GAGSF,KACH,MAAM,CAAEA,GAAGG,CAAH,GAAKP,GAAN,GAAW,GAAZ,EAAiBQ,OAAjB,CAAyB,CAAzB,CAAN,GAAkC,GAD/B,GAEH,EALN;;AAMN,wCACMP,IADN;AAEGC,cAAMA,OAAOI;AAFhB;AAID,KAXe;AAAA,GAFD;;AAefG,iBAAe,uBAACV,EAAD,EAAQ;AACrB,QAAIW,YAAJ;AAAA,QAASV,MAAM,CAAf;AACA,SAAKU,GAAL,IAAYX,EAAZ,EAAgB;AACd,UACKW,IAAIC,OAAJ,CAAY,OAAZ,MAAyB,CAAC,CAA1B,IACGD,IAAIC,OAAJ,CAAY,eAAEC,KAAd,MAAyB,CAAC,CAFlC,EAGE;AACA,YAAMC,SAASd,GAAGW,GAAH,CAAf;AACAV,eAAOa,OAAOA,OAAOR,MAAP,GAAc,CAArB,EAAwBE,CAA/B;AACD;AACF;AACD,WAAOP,GAAP;AACD,GA3Bc;;AA6Bfc,eAAa,qBAACC,GAAD,EAAMhB,EAAN,EAAUiB,OAAV,EAAsB;AACjC,QAAMhB,MAAMH,SAASY,aAAT,CAAuBV,EAAvB,CAAZ;AAAA,QACMkB,kBAAkBpB,SAASC,cAAT,CAAwBC,EAAxB,EAA4BC,GAA5B,CADxB;AAEA,WAAQA,QAAQ,CAAR,IAAagB,YAAY,eAAEE,SAA5B,GACFH,IAAII,GAAJ,CAAQF,eAAR,CADE,GAEFF,GAFL;AAGD,GAnCc;;AAqCfK,iBAAe,uBAACL,GAAD,EAAMhB,EAAN,EAAa;AAC1B,QAAMsB,QAAQtB,GAAG,eAAEa,KAAL,CAAd;AAAA,QACMZ,MAAMqB,QACFA,MAAMA,MAAMhB,MAAN,GAAa,CAAnB,EAAsBE,CADpB,GAEFV,SAASY,aAAT,CAAuBV,EAAvB,CAHV;AAAA,QAIMkB,kBAAkBpB,SAASC,cAAT,CAAwBC,EAAxB,EAA4BC,GAA5B,CAJxB;;AAMA,WAAQA,QAAQ,CAAR,IAAaA,OAAO,IAArB,GACFe,IAAII,GAAJ,CAAQF,eAAR,CADE,GAEFF,GAFL;AAGD;AA/Cc,CAAjB;;kBAkDelB,Q","file":"fnLegend.js","sourcesContent":["\r\nimport C from './conf'\r\n\r\nconst fnLegend = {\r\n\r\n  fItemWithRatio: (hm, sum) => (item) => {\r\n    const { name } = item\r\n        , _points = hm[name]\r\n        , _p = _points[_points.length-1]\r\n        , _ratio = _p\r\n              ? ' ' + ((_p.y/sum)*100).toFixed(1)+'%'\r\n              : '';\r\n    return {\r\n       ...item,\r\n       name: name + _ratio\r\n    };\r\n  },\r\n\r\n  calcRecentSum: (hm) => {\r\n    let key, sum = 0;\r\n    for (key in hm) {\r\n      if (\r\n           key.indexOf(', nes') === -1\r\n           && key.indexOf(C.WORLD) === -1\r\n      ) {\r\n        const points = hm[key];\r\n        sum += points[points.length-1].y\r\n      }\r\n    }\r\n    return sum;\r\n  },\r\n\r\n  toAllLegend: (arr, hm, measure) => {\r\n    const sum = fnLegend.calcRecentSum(hm)\r\n        , crItemWithRatio = fnLegend.fItemWithRatio(hm, sum);\r\n    return (sum !== 0 && measure !== C.AVG_PRICE)\r\n       ? arr.map(crItemWithRatio)\r\n       : arr;\r\n  },\r\n\r\n  toWorldLegend: (arr, hm) => {\r\n    const world = hm[C.WORLD]\r\n        , sum = world\r\n            ? world[world.length-1].y\r\n            : fnLegend.calcRecentSum(hm)\r\n        , crItemWithRatio = fnLegend.fItemWithRatio(hm, sum);\r\n\r\n    return (sum !== 0 && sum != null)\r\n       ? arr.map(crItemWithRatio)\r\n       : arr;\r\n  }\r\n};\r\n\r\nexport default fnLegend\r\n"]}