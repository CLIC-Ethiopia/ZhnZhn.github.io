{"version":3,"sources":["../../../src/adapters/quandl/QuandlAdapter.js"],"names":["getData","QuandlFn","getColumnNames","crDividendSeria","ChartConfig","crSplitRatioSeria","setMinMaxPlotLines","ChartFn","_assign","Object","assign","C","OPEN","CLOSE","PRICE","LOW","HIGH","VOLUME","EX_DIVIDEND","SPLIT_RATIO","UNKNOWN","COLOR_BLUE","_notNull2","a","b","_fnConvertToUTC","point","result","arrDate","split","dateUTC","Date","UTC","parseInt","_fnCheckExtrems","yPointIndex","maxPoint","minPoint","_fnAddToSeria","seria","push","_fnAddSplitRatio","splitRationIndex","dataSplitRatio","x","splitRatio","AdapterFn","roundBy","price","crMarkerSplitRatio","_fnAddExDividend","exDividendIndex","dataExDividend","exValue","marker","crMarkerExDividend","isPrevDateAfter","dataLabels","y","_fnAddVolume","optionIndex","volume","open","close","low","high","dataVolume","dataVolumeColumn","_open","undefined","crVolumePoint","date","option","_low","_high","_fnAddATH","dataATH","len","length","_prevPoint","crAthPoint","_fnAddHighLow","dataHighLow","_closeValue","_openValue","_bHigh","minus","_bLow","_dayHigh","_dayLow","parseFloat","dayHigh","dayLow","_fnAddCustomSeries","columns","legendSeries","i","max","data","_fLegendConfig","seriaColumnNames","column_names","j","_len","ChartLegend","fLegendConfig","columnName","columnIndex","findColumnIndex","_fnCreatePointFlow","json","fnStep","dataset","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","_closeIndex","exDividend","bind","_isTransform","transform","fnPointsFlow","pipe","_fnSeriesPipe","points","sort","compareByDate","_max","zhPoints","minY","Chart","calcMinY","_fnSetYForPoints","_fnAddSeriesExDivident","config","series","chart","spacingBottom","_fnAddSeriesSplitRatio","_fnCheckIsMfi","names","zhIsMfi","_fnCheckIsMomAth","zhIsMomAth","_fnSetChartTitle","title","subtitle","setDefaultTitle","_fnSetLegendSeriesToConfig","legend","name","zhValueText","index","color","isVisible","symbol","isSecondAxes","crSeria","visible","fSeriaMarker","zhConfig","fnGetSeries","dataColumn","chartId","value","isDrawDeltaExtrems","isNotZoomToMinMax","dfR","createZhConfig","info","createDatasetInfo","init","add","valueMoving","addMiniVolume","id","dColumn","dVolume","addMiniATH","addMiniHL","toConfig","fnConfigAxes","plotLines","yAxis","_data","_maxIndex","_recentValue","min","fnQuandlFlow","_fCreateAreaConfig","crAreaConfig","getDataColumnIndex","_fToConfig","builder","_fToSeria","toSeria","_rToConfig","ChartType","AREA","SEMI_DONUT","toSemiDonut","STACKED_AREA","toStackedArea","STACKED_AREA_PERCENT","STACKED_COLUMN","toStackedColumn","STACKED_COLUMN_PERCENT","TREE_MAP","toTreeMap","YEARLY","toYearly","SCATTER","toScatter","SCATTER_UP","SCATTER_DOWN","_crSeriaData","yIndex","map","p","ymdToUTC","_toSeria","substring","findMinY","_rToSeria","DF","QuandlAdapter","seriaType","toSeries"],"mappings":"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","sourcesContent":["\r\nimport Big from 'big.js';\r\n\r\nimport pipe from '../../utils/pipe'\r\n\r\nimport {ChartType} from '../../constants/Type';\r\nimport Chart from '../../charts/Chart';\r\nimport ChartFn from '../../charts/ChartFn'\r\nimport ChartConfig from '../../charts/ChartConfig';\r\nimport ChartLegend from '../../charts/ChartLegend';\r\nimport ConfigBuilder from '../../charts/ConfigBuilder';\r\n\r\nimport AdapterFn from '../AdapterFn';\r\nimport QuandlFn from './QuandlFn';\r\n\r\nimport toSemiDonut from './toSemiDonut'\r\nimport toStackedArea  from './toStackedArea'\r\nimport toStackedColumn from './toStackedColumn'\r\nimport toTreeMap from './toTreeMap'\r\nimport toYearly from '../toYearsByMonths'\r\nimport toScatter from './toScatter'\r\n\r\nconst { getData, getColumnNames } = QuandlFn;\r\n\r\nconst {\r\n  crDividendSeria,\r\n  crSplitRatioSeria\r\n} = ChartConfig;\r\nconst {\r\n  setMinMaxPlotLines\r\n} = ChartFn;\r\nconst _assign = Object.assign;\r\n\r\nconst C = {\r\n  OPEN : \"Open\",\r\n  CLOSE : \"Close\",\r\n  PRICE: 'Price',\r\n  LOW : \"Low\",\r\n  HIGH : \"High\",\r\n  VOLUME : \"Volume\",\r\n  EX_DIVIDEND : \"Ex-Dividend\",\r\n  SPLIT_RATIO : \"Split Ratio\",\r\n  UNKNOWN : \"Unknown\",\r\n\r\n  COLOR_BLUE: '#2f7ed8',\r\n}\r\n\r\n\r\nconst _notNull2 = (a, b) => a !== null && b !== null;\r\n\r\nconst _fnConvertToUTC = function(point, result){\r\n   const arrDate = point[0].split('-');\r\n   result.dateUTC = Date.UTC(arrDate[0], (parseInt(arrDate[1], 10)-1), arrDate[2]);\r\n   result.point = point;\r\n   return result;\r\n}\r\n\r\nconst _fnCheckExtrems = function(result){\r\n  const {point, yPointIndex, maxPoint, minPoint} = result;\r\n  if (!(point[yPointIndex] == null) && point[yPointIndex]>=maxPoint){\r\n    result.maxPoint = point[yPointIndex];\r\n  }\r\n  if (!(point[yPointIndex] == null) && point[yPointIndex]<=minPoint) {\r\n    result.minPoint = point[yPointIndex];\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst _fnAddToSeria = function(result){\r\n   const {seria, dateUTC, point, yPointIndex} = result;\r\n   seria.push([dateUTC, point[yPointIndex]]);\r\n\r\n   return result;\r\n}\r\n\r\nconst _fnAddSplitRatio = function(splitRationIndex, result){\r\n  const { point, dateUTC, yPointIndex, dataSplitRatio } = result;\r\n  if (point[splitRationIndex] !== 1){\r\n    const x = dateUTC\r\n    , splitRatio = AdapterFn.roundBy(point[splitRationIndex])\r\n    , price = point[yPointIndex];\r\n\r\n    dataSplitRatio.push(_assign(ChartConfig.crMarkerSplitRatio(), {x, splitRatio, price}));\r\n  }\r\n  return result;\r\n}\r\n\r\nconst _fnAddExDividend = function(exDividendIndex, result){\r\n     const { point, dateUTC, yPointIndex, dataExDividend } = result;\r\n\r\n     if (point[exDividendIndex] !== 0){\r\n       const x = dateUTC\r\n           , exValue = point[exDividendIndex]\r\n           , price = point[yPointIndex]\r\n           , marker = _assign(\r\n                ChartConfig.crMarkerExDividend(),\r\n                { x, exValue, price }\r\n             );\r\n       if (!QuandlFn.isPrevDateAfter(dataExDividend, x , 14)) {\r\n         marker.dataLabels.y = 0;\r\n       }\r\n       dataExDividend.push(marker);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nconst _fnAddVolume = function(optionIndex, result){\r\n  const { volume, open, close=4, low=3, high=2 } = optionIndex\r\n      , { point, dateUTC, dataVolume, dataVolumeColumn } = result\r\n      , _open = (open) ? point[open] : undefined;\r\n\r\n  dataVolume.push([dateUTC, point[volume]]);\r\n  dataVolumeColumn.push( AdapterFn.crVolumePoint({\r\n    open: _open, close: point[close], date: dateUTC, volume: point[volume],\r\n    option: {_low: point[low], _high: point[high]},\r\n  }))\r\n\r\n  return result;\r\n}\r\n\r\nconst _fnAddATH = function(optionIndex, result){\r\n  const { open=1 } = optionIndex\r\n      , { dateUTC, point, seria, dataATH } = result\r\n      , len = seria.length;\r\n\r\n  if (len>1) {\r\n    const _prevPoint = seria[len-2];\r\n    dataATH.push(AdapterFn.crAthPoint({\r\n      date: dateUTC,\r\n      close: _prevPoint[1],\r\n      open: point[open]\r\n    }))\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst _fnAddHighLow = function(optionIndex, result){\r\n  const { open=1, high=2, low=3 } = optionIndex\r\n  , { dateUTC, yPointIndex, point, dataHighLow } = result\r\n  , _closeValue = point[yPointIndex]\r\n  , _openValue = _notNull2(point[open], _closeValue)\r\n       ? point[open]\r\n       : C.UNKNOWN\r\n  , _bHigh = _notNull2(point[high], _closeValue)\r\n       ? Big(point[high]).minus(_closeValue)\r\n       : Big('0.0')\r\n  , _bLow = _notNull2(point[low], _closeValue)\r\n       ? Big(point[low]).minus(_closeValue)\r\n       : Big('0.0')\r\n  , _dayHigh = point[high] || C.UNKNOWN\r\n  , _dayLow = point[low] || C.UNKNOWN;\r\n\r\n  dataHighLow.push({\r\n    x : dateUTC,\r\n    high : parseFloat(_bHigh),\r\n    low : parseFloat(_bLow),\r\n    open : _openValue,\r\n    dayHigh : _dayHigh,\r\n    dayLow : _dayLow,\r\n    close : _closeValue\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\nconst _fnAddCustomSeries = function(columns, result){\r\n   const { dateUTC, point, legendSeries } = result;\r\n   let i=0, max=columns.length;\r\n   for (; i<max; i++ ){\r\n      legendSeries[i].data.push([dateUTC, point[columns[i]]])\r\n   }\r\n}\r\n\r\nconst _fLegendConfig = function(seriaColumnNames, column_names){\r\n  const legendSeries = []\r\n      , columns =[];\r\n\r\n  if (seriaColumnNames[0] === 'All'){\r\n    let j=1, _len = column_names.length;\r\n    for (j; j<_len; j++){\r\n      legendSeries.push(\r\n        ChartLegend.fLegendConfig(column_names[j])\r\n      )\r\n      columns.push(j)\r\n    }\r\n  } else {\r\n    let i=0, max=seriaColumnNames.length;\r\n    for (; i<max; i++ ){\r\n       const columnName = seriaColumnNames[i]\r\n           , columnIndex = QuandlFn.findColumnIndex(column_names, columnName);\r\n       if (columnIndex) {\r\n          legendSeries.push(\r\n            ChartLegend.fLegendConfig(columnName)\r\n          )\r\n          columns.push(columnIndex)\r\n       }\r\n    }\r\n  }\r\n\r\n  return { legendSeries, columns };\r\n}\r\n\r\nconst _fnCreatePointFlow = function(json, yPointIndex, option){\r\n\r\n  const fnStep = [_fnConvertToUTC, _fnCheckExtrems, _fnAddToSeria]\r\n      , { dataset={} } = json\r\n      , column_names = getColumnNames(json)\r\n      , result = {\r\n         yPointIndex : yPointIndex,\r\n         minPoint : Number.POSITIVE_INFINITY,\r\n         maxPoint : Number.NEGATIVE_INFINITY,\r\n         seria : [],\r\n         dataVolume : [], dataVolumeColumn : [],\r\n         dataExDividend : [], dataSplitRatio : [],\r\n         dataATH : [], dataHighLow : []\r\n      };\r\n\r\n  const open = QuandlFn.findColumnIndex(column_names, C.OPEN)\r\n      , _closeIndex = QuandlFn.findColumnIndex(column_names, C.CLOSE)\r\n      , close = ( typeof _closeIndex !== 'undefined')\r\n          ? _closeIndex\r\n          : QuandlFn.findColumnIndex(column_names, C.PRICE)\r\n      , low = QuandlFn.findColumnIndex(column_names, C.LOW)\r\n      , high = QuandlFn.findColumnIndex(column_names, C.HIGH)\r\n      , volume = QuandlFn.findColumnIndex(column_names, C.VOLUME)\r\n      , exDividend = QuandlFn.findColumnIndex(column_names, C.EX_DIVIDEND)\r\n      , splitRatio = QuandlFn.findColumnIndex(column_names, C.SPLIT_RATIO);\r\n\r\n\r\n  if (volume){\r\n    fnStep.push(_fnAddVolume.bind(null, {\r\n      volume, open, close, low, high\r\n    }));\r\n  }\r\n\r\n  const _isTransform = dataset.transform && dataset.transform !== 'none';\r\n  if (exDividend && !_isTransform) {\r\n    fnStep.push(_fnAddExDividend.bind(null, exDividend));\r\n  }\r\n\r\n  if (splitRatio && !_isTransform){\r\n    fnStep.push(_fnAddSplitRatio.bind(null, splitRatio));\r\n  }\r\n\r\n  if (open){\r\n    fnStep.push(_fnAddATH.bind(null, { open }));\r\n  }\r\n\r\n  if (high && low ){\r\n    fnStep.push(_fnAddHighLow.bind(null, { open, high, low }));\r\n  }\r\n\r\n  const { seriaColumnNames } = option;\r\n  if (seriaColumnNames) {\r\n    const { legendSeries, columns } = _fLegendConfig(seriaColumnNames, column_names);\r\n\r\n    if (legendSeries.length !== 0){\r\n      result.legendSeries = legendSeries\r\n      fnStep.push(_fnAddCustomSeries.bind(null, columns))\r\n    }\r\n  }\r\n\r\n  return {\r\n    //fnPointsFlow : flow(fnStep),\r\n    fnPointsFlow : pipe(...fnStep),\r\n    result : result\r\n  };\r\n}\r\n\r\n\r\nconst _fnSeriesPipe = function(json, yPointIndex, option){\r\n  const { fnPointsFlow, result } = _fnCreatePointFlow(json, yPointIndex, option)\r\n      , data = getData(json)\r\n      , points = data.sort(AdapterFn.compareByDate);\r\n\r\n  let i=0, _max=points.length;\r\n  for(; i<_max; i++) {\r\n    fnPointsFlow(points[i], result)\r\n  }\r\n\r\n  _assign(result, {\r\n    zhPoints: points,\r\n    minY: Chart.calcMinY(result)\r\n  })\r\n\r\n  return result;\r\n}\r\n\r\nconst _fnSetYForPoints = function(data, y){\r\n  let i=0, max=data.length;\r\n  for (; i<max; i++ ){\r\n    data[i].y = y;\r\n  }\r\n}\r\n\r\nconst _fnAddSeriesExDivident = function(config, data, y){\r\n  if (data.length>0){\r\n    _fnSetYForPoints(data, y);\r\n    config.series.push(crDividendSeria(data));\r\n    config.chart.spacingBottom = 40;\r\n  }\r\n}\r\n\r\nconst _fnAddSeriesSplitRatio = function(config, data, y){\r\n  if (data.length>0){\r\n    _fnSetYForPoints(data, y);\r\n    config.series.push(crSplitRatioSeria(data));\r\n    config.chart.spacingBottom = 40;\r\n  }\r\n};\r\n\r\nconst _fnCheckIsMfi = function(config, json, zhPoints){\r\n  const names = getColumnNames(json);\r\n  if ( names[2] === C.HIGH && names[3] === C.LOW  &&\r\n       names[4] === C.CLOSE && names[5] === C.VOLUME) {\r\n    _assign(config, {\r\n      zhPoints: zhPoints,\r\n      zhIsMfi: true\r\n    })\r\n  }\r\n};\r\nconst _fnCheckIsMomAth = function(config, json, zhPoints) {\r\n  const names = getColumnNames(json)\r\n  if ( names[1] === C.OPEN && names[4] === C.CLOSE) {\r\n    _assign(config, {\r\n      zhPoints: zhPoints,\r\n      zhIsMomAth: true\r\n    })\r\n  }\r\n}\r\n\r\nconst _fnSetChartTitle = function(config, option){\r\n  const { title, subtitle } = option;\r\n  if (title){\r\n    Chart.setDefaultTitle(config, title, subtitle)\r\n  }\r\n}\r\n\r\nconst _fnSetLegendSeriesToConfig = function(legendSeries, config){\r\n  const legend = []\r\n      , _len = config.series.length;\r\n\r\n  if (_len !== 0){\r\n     legend.push({\r\n        name: config.series[0].zhValueText,\r\n        index: 0,\r\n        color: C.COLOR_BLUE,\r\n        isVisible : true\r\n    });\r\n  }\r\n\r\n  let i=0, max=legendSeries.length;\r\n  for (i; i<max; i++){\r\n    const { data, name, color, symbol, isSecondAxes } = legendSeries[i]\r\n        , seria = ChartConfig.crSeria({\r\n             zhValueText : name,\r\n             visible : false,\r\n             marker : Chart.fSeriaMarker({ color, symbol }),\r\n             color: color,\r\n             data : data\r\n          });\r\n\r\n     if (!isSecondAxes){\r\n        config.series.push(seria);\r\n        legend.push({\r\n          name : name,\r\n          index : config.series.length - 1,\r\n          color : color,\r\n          isVisible : false\r\n        });\r\n     } else {\r\n       legend.push({\r\n          name : name,\r\n          color : color,\r\n          isVisible : false,\r\n          isSecondAxes : true,\r\n          seria : seria\r\n        });\r\n     }\r\n  }\r\n\r\n  config.zhConfig.legend = legend;\r\n};\r\n\r\nconst fnGetSeries = function(config, json, option){\r\n   const {\r\n           dataColumn:yPointIndex,\r\n           value:chartId,\r\n           isDrawDeltaExtrems, isNotZoomToMinMax,\r\n           dfR\r\n         } = option;\r\n\r\n   _fnSetChartTitle(config, option);\r\n   config.zhConfig = QuandlFn.createZhConfig(option);\r\n   config.info = QuandlFn.createDatasetInfo(json);\r\n\r\n   const {\r\n     seria, minPoint, maxPoint, minY,\r\n     dataExDividend, dataSplitRatio,\r\n     dataVolume, dataVolumeColumn,\r\n     dataATH, dataHighLow,\r\n     legendSeries, zhPoints\r\n   } = _fnSeriesPipe(json, yPointIndex, option);\r\n\r\n   _fnCheckIsMfi(config, json, zhPoints);\r\n   _fnCheckIsMomAth(config, json, zhPoints);\r\n\r\n   config.series[0].data = seria;\r\n\r\n   _fnAddSeriesExDivident(config, dataExDividend, minY);\r\n   _fnAddSeriesSplitRatio(config, dataSplitRatio, minY);\r\n\r\n   config = ConfigBuilder()\r\n     .init(config)\r\n     .add({\r\n       valueMoving: AdapterFn.valueMoving(seria, dfR)\r\n     })\r\n     .addMiniVolume({\r\n       id: chartId,\r\n       dColumn: dataVolumeColumn,\r\n       dVolume: dataVolume\r\n     })\r\n     .addMiniATH({\r\n       id: chartId,\r\n       data: dataATH\r\n     })\r\n     .addMiniHL({\r\n       id: chartId,\r\n       data: dataHighLow\r\n     })\r\n     .toConfig();\r\n\r\n    if (legendSeries){\r\n      _fnSetLegendSeriesToConfig(legendSeries, config)\r\n    }\r\n\r\n   return {\r\n     config,\r\n     minPoint, maxPoint, minY,\r\n     isDrawDeltaExtrems, isNotZoomToMinMax\r\n   };\r\n}\r\n\r\nconst fnConfigAxes = function(result){\r\n  const {\r\n          config, minPoint, maxPoint, minY,\r\n          isDrawDeltaExtrems, isNotZoomToMinMax\r\n        } = result\r\n      , plotLines = config.yAxis.plotLines\r\n      , _data = config.series[0].data\r\n      , _maxIndex = _data.length - 1\r\n      , _recentValue = _maxIndex > -1\r\n           ? _data[_maxIndex][1]\r\n           : 0;\r\n\r\n  setMinMaxPlotLines({ plotLines,\r\n    min: minPoint, max: maxPoint,\r\n    value: _recentValue,\r\n    isDrawDeltaExtrems\r\n  })\r\n  if (!isNotZoomToMinMax){\r\n    config.yAxis.min = minY\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n//const fnQuandlFlow = flow(fnGetSeries, fnConfigAxes);\r\nconst fnQuandlFlow = pipe(fnGetSeries, fnConfigAxes);\r\n\r\nconst _fCreateAreaConfig = function(json, option){\r\n  const config = ChartConfig.crAreaConfig()\r\n      , { columnName } = option;\r\n\r\n  option.dataColumn = QuandlFn.getDataColumnIndex(json, option);\r\n  if ( columnName ){\r\n    config.series[0].zhValueText = columnName;\r\n  }\r\n\r\n  return fnQuandlFlow(config, json, option);\r\n}\r\n\r\nconst _fToConfig = builder => (json, option) => {\r\n  const data = getData(json);\r\n  return { config: builder.toConfig(data, option) };\r\n}\r\nconst _fToSeria = builder => (json, option, chart) => {\r\n  const data = getData(json);\r\n  return builder.toSeria(data, option, chart);\r\n}\r\n\r\nconst _rToConfig = {\r\n  [ChartType.AREA]: _fCreateAreaConfig,\r\n  [ChartType.SEMI_DONUT]: toSemiDonut,\r\n  [ChartType.STACKED_AREA]: toStackedArea,\r\n  [ChartType.STACKED_AREA_PERCENT]: toStackedArea,\r\n  [ChartType.STACKED_COLUMN]: toStackedColumn,\r\n  [ChartType.STACKED_COLUMN_PERCENT]: toStackedColumn,\r\n  [ChartType.TREE_MAP]: toTreeMap,\r\n  [ChartType.YEARLY]: _fToConfig(toYearly),\r\n  [ChartType.SCATTER]: _fToConfig(toScatter),\r\n  [ChartType.SCATTER_UP]: _fToConfig(toScatter),\r\n  [ChartType.SCATTER_DOWN]: _fToConfig(toScatter)\r\n}\r\n\r\nconst _crSeriaData = (data, yIndex) => {\r\n  return data\r\n    .map(p => [ AdapterFn.ymdToUTC(p[0]), p[yIndex] ])\r\n    .sort(AdapterFn.compareByDate);\r\n};\r\n\r\nconst _toSeria = (json, option) => {\r\n  const { value:chartId } = option\r\n  , yPointIndex = QuandlFn.getDataColumnIndex(json, option)\r\n  , data = _crSeriaData(getData(json), yPointIndex);\r\n  return ChartConfig.crSeria({\r\n      zhValueText: chartId.substring(0,12),\r\n      data: data,\r\n      minY: AdapterFn.findMinY(data)\r\n  });\r\n}\r\n\r\nconst _rToSeria = {\r\n  DF: _toSeria,\r\n  [ChartType.SCATTER]: _fToSeria(toScatter),\r\n  [ChartType.SCATTER_UP]: _fToSeria(toScatter),\r\n  [ChartType.SCATTER_DOWN]: _fToSeria(toScatter)\r\n}\r\n\r\nconst QuandlAdapter = {\r\n  toConfig(json, option){\r\n     const { seriaType=ChartType.AREA } = option\r\n         , config = _rToConfig[seriaType](json, option);\r\n     return config;\r\n  },\r\n\r\n  toSeries(json, option, chart){\r\n    const { seriaType } = option\r\n       , _toSeria = _rToSeria[seriaType] || _rToSeria.DF\r\n       , seria = _toSeria(json, option, chart);\r\n    return seria;\r\n  }\r\n\r\n}\r\n\r\nexport default QuandlAdapter;\r\n"],"file":"QuandlAdapter.js"}