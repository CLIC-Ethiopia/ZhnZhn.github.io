(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{mYKd:function(t,e,o){"use strict";o.r(e);var n,i=o("pVnL"),a=o.n(i),s=o("PJYZ"),r=o.n(s),c=o("VbXa"),l=o.n(c),u=o("q1tI"),h=o.n(u),d=function(){function t(t){void 0===t&&(t=5e3),this.mls=t,this.isLoading=!1}var e=t.prototype;return e.start=function(t){var e=this;return!this.isLoading&&(this.loadingUrl=t,this.isLoading=!0,this.timeoutId=setTimeout((function(){t===e.loadingUrl&&(e.isLoading=!1)}),this.mls),!0)},e.stop=function(){this.isLoading=!1,clearTimeout(this.timeoutId)},t}(),p=o("uYGB"),f=o.n(p),g=function(t,e){return fetch(t,e).then((function(t){var e=t.status,o=t.statusText;if(e>=200&&e<400)return t.json();if(403===e)throw Error("HTTP Code 403: Forbitten.\nMaybe, require API key.");throw Error("HTTP Code: "+e+" "+o)}))},m={selection:{filter:"all",values:["*"]}},v={code:"Tid",selection:{filter:"top",values:["1"]}},S=function(t,e){var o=t.map((function(t){return e=t.v,a()({code:e},m);var e}));return e||o.push(v),{method:"POST",body:JSON.stringify({query:o,response:{format:"json-stat"}})}},_=function(t,e){for(var o=[],n=e.v,i=t.Dimension(n),a=i.length,s=0;s<a;s++){var r;o.push({caption:i.Category(s).label,slice:(r={},r[n]=i.id[s],r)})}return o},C=new d,y=function(t){var e=t.metaUrl,o=t.dims,n=void 0===o?[]:o,i=t.noTime,a=t.timeId;if(C.isLoading)return Promise.resolve({errMsg:"Another dims are still loading"});var s=S(n,i);return C.start(e),g(e,s).then((function(t){var e=function(t,e,o){var n=f()(t).Dataset(0);return e.map((function(t){return{id:t.v,caption:t.c,options:_(n,t)}})).filter(function(t){return function(e){return e.id!==t}}(o))}(t,n,a);return C.stop(),{configs:e}})).catch((function(t){return C.stop(),{errMsg:t.message}}))},w=Array.isArray,T=function(t){var e=t.values,o=t.valueTexts,n=t.code;if(w(e)&&w(o)&&e.length===o.length){for(var i=[],a=0;a<o.length;a++){var s;i.push({caption:o[a],slice:(s={},s[n]=e[a],s)})}return i}},D=["Tid","Year","Month","Vuosi","VuosineljÃ¤nnes"],b={month:"M",quarter:"K"},L=function(t){var e,o=[],n=t.variables,i="Y";return(void 0===n?[]:n).forEach((function(t){var n,a=t.code,s=t.time,r=t.text||"";s||-1!==D.indexOf(a)?(e=a,i=b[r.toLowerCase()]):o.push({c:(n=r,n.charAt(0).toUpperCase()+n.substring(1)),v:a,options:T(t)})})),{mapFrequency:i,dims:o,timeId:e}},I=function(t){return g(t).then(L)},M=function(t){return t.map((function(t){var e=t.c;return{id:t.v,caption:e,options:t.options}}))},O=new d,F=function(t){if(O.isLoading)return Promise.resolve({errMsg:"Another dialog are still loading"});var e=function(t){return t.metaUrl||""+(void 0===(o=(e=t).proxy)?"":o)+e.baseMeta+"/"+e.dfId;var e,o}(t);return t.dims?y(a()({metaUrl:e},t)):(O.start(e),I(e).then((function(o){var n=o.dims,i=o.mapFrequency,a=o.timeId;return O.stop(),function(t){for(var e=t.length,o=0;o<e&&t[o].options;o++);return o===e}(n)?{timeId:a,mapFrequency:i,configs:M(n)}:y({noTime:t.noTime,metaUrl:e,dims:n,mapFrequency:i,timeId:a})})).catch((function(t){var e=t.errMsg,o=t.message;return O.stop(),{errMsg:e||o}})))},E=o("uwae"),N=o("CrGp"),q=o("4Fsi"),P=q.a.Decor,A=q.a.crMenuMore,k=q.a.crDateConfig,B={SPINNER_LOADING:{position:"relative",display:"block",textAlign:"middle",margin:"16px auto 32px",width:32,height:32},SPINNER_FAILED:{borderColor:"#f44336",animation:"none"}},W=E.a.isCategory,x=E.a.crOptions,R=function(t){return"is"+t+"Select"},U={StatN:(0,P.dialog)(n=function(t){function e(e){var o;return(o=t.call(this,e)||this)._toggleStateBy=function(t){o.setState((function(e){var o;return(o={})[t]=!e[t],o}))},o._checkCaptionBy=function(t){o._titles.push(t)},o._uncheckCaption=function(t){o._titles=o._titles.filter((function(e){return e!==t}))},o._setConfigs=function(t){var e=t.configs,n=t.timeId,i=t.mapFrequency,a=t.errMsg;if(e){var s=o.props,r=s.chartsType,c=s.mapFrequency;o.setState({isLoading:!1,isLoadFailed:!1,timeId:n,configs:e,mapFrequency:i||c,selectOptions:e.map((function(t){return t.options})),chartOptions:x({configs:e,chartsType:r})})}else o.setState({isLoading:!1,isLoadFailed:!0,validationMessages:[a]})},o._loadDims=function(){var t=o.props,e=t.dims,n=t.proxy,i=t.baseMeta,s=t.dfProps;F(a()({dims:e,proxy:n,baseMeta:i},s)).then(o._setConfigs).catch((function(t){o._setConfigs({errMsg:t.message})}))},o._updateForDate=function(t){o.date=null;var e=o.props.mapDateDf,n=o.state.mapFrequency,i=k(n||"M",e);o.setState(a()({isShowDate:!0},i,{chartType:t}))},o._handleLoad=function(){var t=o._crValidationMessages();if(0===t.length){var e=r()(o),n=e._items,i=e.dialogOptions,s=e.colorComp,c=e.date,l=o.state,u=l.timeId,h=l.chartType,d=l.selectOptions,p=s?s.getConf():{},f=p.seriaColor,g=p.seriaWidth,m=o.state.dateDefault,v=a()({},o.props,{timeId:u}),S=o.props.loadFn(v,{dialogOptions:i,chartType:h,seriaColor:f,seriaWidth:g,date:c,dateDefault:m,items:n,titles:o._titles,selectOptions:d});o.props.onLoad(S)}o.setState({validationMessages:t})},o._crValidationMessages=function(){var t=[],e=o.state,n=e.configs,i=e.isLoadFailed,a=e.chartType,s=void 0===a?{}:a,r=W(s),c=s.dim;return i?t.push("Dims for request haven't been loaded.\nClose, open dialog for trying load again."):n.forEach((function(e,n){var i=e.caption;r&&i===c||o._items[n]||t.push(o.props.msgOnNotSelected(i))})),t},o._handleClose=function(){o._handleWithValidationClose()},o._hSelectChartType=function(t){W(t)?o._updateForDate(t):o.setState({chartType:t,isShowDate:!1})},o._onRegColor=function(t){o.colorComp=t},o._fSelect=function(t){return function(e){this._items[t]=e}},o._hSelectDate=function(t){o.date=t},o._renderSelectInputs=function(){var t=o.state,e=t.isShowLabels;return t.configs.map((function(t,n){var i=t.id,a=t.caption,s=t.options,c=!o.state[R(i)];return h.a.createElement(q.a.ShowHide,{key:i,isShow:c},h.a.createElement(q.a.RowInputSelect,{isShowLabels:e,caption:a,options:s,onSelect:o._fSelect(n).bind(r()(o))}))}))},o._menuMore=A(r()(o),{toggleToolBar:o._toggleWithToolbar,onAbout:o._clickInfoWithToolbar}),o.toolbarButtons=o._createType2WithToolbar(e,{noDate:!0,isOptions:!0,isToggle:!0}),o._commandButtons=o._crCommandsWithLoad(r()(o)),o._items=[],o._titles=[],o.state=a()({},o._isWithInitialState(),{isLoading:!0,isLoadFailed:!1,isShowChart:!0,isShowDate:!1},k("EMPTY"),{isOptions:!1,isToggle:!1,configs:[],selectOptions:[],mapFrequency:e.mapFrequency,chartOptions:x(e)}),o}l()(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return this.props===t||this.props.isShow!==t.isShow},o.componentDidMount=function(){this._loadDims()},o.componentDidUpdate=function(t){(function(t,e,o){return e!==t&&!t.isShow&&e.isShow&&o.isLoadFailed})(t,this.props,this.state)&&(this.setState({isLoading:!0,isLoadFailed:!1}),this._loadDims())},o.render=function(){var t=this.props,e=t.caption,o=t.isShow,n=t.onShow,i=t.onFront,s=this.state,r=s.chartType,c=s.isToolbar,l=s.isOptions,u=s.isToggle,d=s.isShowLabels,p=s.isLoading,f=s.isLoadFailed,g=s.isShowChart,m=s.isShowDate,v=s.dateDefault,S=s.dateOptions,_=s.configs,C=s.chartOptions,y=s.validationMessages,w=f?a()({},B.SPINNER_LOADING,B.SPINNER_FAILED):B.SPINNER_LOADING;return h.a.createElement(q.a.DraggableDialog,{isShow:o,caption:e,menuModel:this._menuMore,commandButtons:this._commandButtons,onShowChart:n,onFront:i,onClose:this._handleClose},h.a.createElement(q.a.Toolbar,{isShow:c,buttons:this.toolbarButtons}),h.a.createElement(q.a.ModalOptions,{isShow:l,toggleOption:this._toggleOptionWithToolbar,onClose:this._hideOptionsWithToolbar}),h.a.createElement(q.a.ModalToggle,{isShow:u,selectProps:_,isShowChart:g,isShowDate:m,crIsId:R,onToggle:this._toggleStateBy,onCheckCaption:this._checkCaptionBy,onUnCheckCaption:this._uncheckCaption,onClose:this._hideToggleWithToolbar}),(p||f)&&h.a.createElement(N.a,{style:w}),!p&&!f&&this._renderSelectInputs(),h.a.createElement(q.a.RowChartDate,{chartType:r,isShowLabels:d,isShowChart:g,chartOptions:C,onSelectChart:this._hSelectChartType,onRegColor:this._onRegColor,isShowDate:m,dateDefault:v,dateOptions:S,onSelecDate:this._hSelectDate}),h.a.createElement(q.a.ValidationMessages,{validationMessages:y}))},e}(u.Component))||n};e.default=U}}]);