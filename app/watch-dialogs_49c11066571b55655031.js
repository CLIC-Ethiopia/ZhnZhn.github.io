(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[437],{7147:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>It});var n,s,i,r=o(7154),a=o.n(r),u=o(5354),c=o.n(u),l=o(5893),p=o(9679),d=o(1398),m=o(7020),f=o(8596),h=o(3014),C=o(6485),T=o(5138),g=o(377),x=o(2276),v=o(837),j=d.Z.getFromDate,S=d.Z.getToDate,y=d.Z.isYmd,w=d.Z.mlsToDmy,I={DIALOG:{width:365},DIALOG_SHORT:{width:265},ITEM_TEXT:{display:"inline-block",maxWidth:250,height:32,verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden"}};const L=(0,v.Z.dialog)((i=s=function(t){function e(e){var o;(o=t.call(this,e)||this)._handleLoad=function(){var t=o._createValidationMessages();if(t.isValid){var e=o.props,n=e.data,s=e.onClose,i=n.id,r=n.title,u=n.subtitle,c=n.caption,l=n.columnName,p=n.dataColumn,d=n.seriaColumnNames,m=n.itemConf,T=void 0===m?{}:m,g=o.datesFragment.getValues(),x=g.fromDate,v=g.toDate,j=a()({id:i,title:r,subtitle:u,value:c,item:c,fromDate:x,toDate:v,columnName:l,dataColumn:p,seriaColumnNames:d,loadId:T.loadId||h.L2.WL},T);f.Z.loadStock({chartType:C.Z.WATCH_LIST,browserType:h.Aq.WATCH_LIST},j),s()}o._updateValidationMessages(t)},o._createValidationMessages=function(){var t=[],e=o.datesFragment.getValidation(),n=e.isValid,s=e.datesMsg;return n||(t=t.concat(s)),t.isValid=0===t.length,t},o._handleClose=function(){o._handleWithValidationClose(o._createValidationMessages),o.props.onClose()},o._refDates=function(t){return o.datesFragment=t};var n=e.data,s=n.fromDate,i=n.initToDate,r=n.onTestDate,u=n.itemConf,c=!!(void 0===u?{}:u).x;return o.toolbarButtons=o._createType2WithToolbar(e,{isValue:c}),o._commandButtons=[(0,l.jsx)(g.Z.Button.Load,{onClick:o._handleLoad},"load")],o.state=a()({},o._isWithInitialState(),{isShowDate:!1,isValue:c,initFromDate:s||j(2),initToDate:i||S(),onTestDate:r||y}),o}c()(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.data,n=o.caption,s=o.itemConf,i=void 0===s?{}:s,r=i.dataSource,a=i.x,u=i.y,c=this.state,p=c.isShowLabels,d=c.isShowDate,f=c.isValue,h=c.initFromDate,C=c.initToDate,v=c.onTestDate,j=c.validationMessages,S=p?I.DIALOG:I.DIALOG_SHORT,y=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),((0,m.Z)(e)+" "+w(t)).trim()}(a,u);return(0,l.jsxs)(T.Z,{style:S,isShow:e,caption:"Load Item",commandButtons:this._commandButtons,onClose:this._handleClose,children:[(0,l.jsx)(g.Z.Toolbar,{isShow:!0,buttons:this.toolbarButtons}),(0,l.jsx)(g.Z.Row.Text,{isShowLabels:p,styleText:I.ITEM_TEXT,caption:"Item:",text:n}),(0,l.jsx)(g.Z.ShowHide,{isShow:f,children:(0,l.jsx)(g.Z.Row.Text,{isShowLabels:p,styleText:I.ITEM_TEXT,caption:"Value:",text:y})}),(0,l.jsx)(g.Z.ShowHide,{isShow:d,children:(0,l.jsx)(g.Z.DatesFragment,{ref:this._refDates,isShowLabels:p,initFromDate:h,initToDate:C,onTestDate:v})}),(0,l.jsx)(g.Z.Row.Text,{isShowLabels:p,styleText:I.ITEM_TEXT,caption:"Source:",text:r}),(0,l.jsx)(x.Z,{validationMessages:j})]})},e}(p.Component),s.defaultProps={data:{}},n=i))||n;var Z=o(3218),D=o(2125),E=o(8580),G=o(2302),R=o(795),A=o(5313),O=o(7376),_={ROW:a()({},O.Z.ROW,{lineHeight:2}),CAPTION:a()({},O.Z.CAPTION,{width:120}),INPUT_TEXT:{width:250,height:30,paddingLeft:10,marginLeft:0,marginRight:0}};const N=(0,p.forwardRef)((function(t,e){var o=t.caption;return(0,l.jsxs)("div",{style:_.ROW,children:[(0,l.jsx)("span",{style:_.CAPTION,children:o}),(0,l.jsx)(A.Z,{ref:e,style:_.INPUT_TEXT})]})}));var M=o(6614),V={CAPTION:a()({},O.Z.CAPTION,{width:120})};const W=function(t){var e=t.caption,o=t.options,n=t.onSelect;return(0,l.jsxs)("div",{style:O.Z.ROW,children:[(0,l.jsx)("span",{style:V.CAPTION,children:e}),(0,l.jsx)(M.Z,{width:"250",options:o,onSelect:n})]})};var b=o(5868);const P=function(){var t=(0,p.useRef)(),e=(0,p.useCallback)((function(e){var o=(e||{}).caption;t.current=o}),[]);return[t,e]};const F=(0,p.forwardRef)((function(t,e){var o=(0,b.Z)(t),n=o[0],s=o[1],i=t.store,r=t.groupCaption,a=t.groupOptions,u=t.listCaption,c=(0,p.useRef)(),d=P(),m=d[0],f=d[1],h=(0,p.useState)([]),C=h[0],T=h[1],g=(0,p.useCallback)((function(t){var e=(t||{}).caption;t&&e?(c.current=e,m.current=null,T(t.lists||[])):c.current=null}),[]);return(0,p.useEffect)((function(){var e=s();if(e!==t){if(e.groupOptions!==a)c.current=null,m.current=null,T([]);else if(c.current){var o=i.getWatchListsByGroup(c.current);o!==C&&(m.current=null,T(o))}n(t)}}),[t]),(0,p.useImperativeHandle)(e,(function(){return{getValue:function(){return{captionGroup:c.current,captionList:m.current}}}})),(0,l.jsxs)("div",{children:[(0,l.jsx)(W,{caption:r,options:a,onSelect:g}),(0,l.jsx)(W,{caption:u,options:C,onSelect:f})]})}));var B=o(481);const k={COMMAND_DIV:{cursor:"default",float:"right",marginTop:"8px",marginBottom:"10px",marginRight:"4px"}};const H=function(t){var e=t.Primary,o=t.withoutClear,n=t.onClear,s=t.onClose;return(0,l.jsxs)("div",{style:k.COMMAND_DIV,children:[e,!o&&(0,l.jsx)(B.Z.Clear,{onClick:n}),(0,l.jsx)(B.Z.Close,{onClick:s})]})};const J={RowInputText:N,RowInputSelect:W,SelectGroupList:F,Button:B.Z,RowButtons:H,ValidationMessages:x.Z};const U=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onCreate,r=t.msgOnIsEmptyName,a=t.onClose,u=(0,p.useRef)(),c=(0,p.useState)([]),d=c[0],m=c[1],f=function(t,e,o,n){return(0,l.jsx)(J.Button.Primary,{caption:"Create",title:"Create New Group",onClick:function(){var s=t.current.getValue();s?o({caption:s}):(t.current.setValue(""),e([n("Group")]))}})}(u,m,i,r),h=function(){u.current.setValue(""),m([])};return(0,R.Z)(e,(function(t,e){t===o&&e.forActionType===s?h():t===n&&e.forActionType===s&&m(e.messages)})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.RowInputText,{ref:u,caption:"Group:"}),(0,l.jsx)(J.ValidationMessages,{validationMessages:d}),(0,l.jsx)(J.RowButtons,{Primary:f,onClear:h,onClose:a})]})};const X=function(t){var e=(0,p.useRef)(),o=(0,p.useCallback)((function(){var o=e.current;o&&(o.setValue(""),t([]))}),[]);return[e,o]};const q=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onRename,r=t.msgOnNotSelect,a=t.msgOnIsEmptyName,u=t.onClose,c=(0,p.useState)((function(){return e.getWatchGroups()})),d=c[0],m=c[1],f=(0,p.useState)([]),h=f[0],C=f[1],T=X(C),g=T[0],x=T[1],v=P(),j=v[0],S=v[1],y=(0,p.useCallback)((function(){var t=g.current.getValue(),e=j.current;if(t&&e)i({captionFrom:e,captionTo:t});else{var o=[];e||o.push(r("Group From")),t||o.push(a("Group To")),C(o)}}),[]),w=(0,p.useMemo)((function(){return(0,l.jsx)(J.Button.Primary,{caption:"Edit",title:"Edit Group Name",onClick:y})}),[y]);return(0,R.Z)(e,(function(t,i){t===o?(i.forActionType===s&&x(),m(e.getWatchGroups())):t===n&&i.forActionType===s&&C(i.messages)})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.RowInputSelect,{caption:"Group From:",options:d,onSelect:S}),(0,l.jsx)(J.RowInputText,{ref:g,caption:"Group To:"}),(0,l.jsx)(J.ValidationMessages,{validationMessages:h}),(0,l.jsx)(J.RowButtons,{Primary:w,onClear:x,onClose:u})]})};var Y=function(t){return{groups:t.getWatchGroups,errs:[]}},z=function(t,e){return{type:t,payload:e}},K=function(t,e){var o=e.type,n=e.payload;switch(o){case"a":return{groups:n,errs:[]};case"b":return a()({},t,{errs:n});default:return t}};const Q=function(t){var e=t.store,o=t.actionCompleted,n=(t.forActionType,t.onDelete),s=t.msgOnNotSelect,i=t.onClose,r=(0,p.useRef)(null),a=function(t,e){var o=(0,p.useReducer)(K,t,Y),n=o[0],s=n.groups,i=n.errs,r=o[1];return[s,i,function(t){return r(z("a",t))},function(){return r(z("b",[e("Group")]))}]}(e,s),u=a[0],c=a[1],d=a[2],m=a[3],f=function(t,e,o){return(0,l.jsx)(J.Button.Primary,{caption:"Delete",title:"Delete Group",onClick:function(){var n=t.current;n?(e({caption:n}),t.current=null):o()}})}(r,n,m);return(0,R.Z)(e,(function(t,n){t===o&&d(e.getWatchGroups())})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.RowInputSelect,{caption:"Group:",options:u,onSelect:function(t){r.current=t&&t.caption||null}}),(0,l.jsx)(J.ValidationMessages,{validationMessages:c}),(0,l.jsx)(J.RowButtons,{Primary:f,withoutClear:!0,onClose:i})]})};var $=Z.Z.addGroup,tt=Z.Z.renameGroup,et=Z.Z.deleteGroup,ot=Z.J.EDIT_WATCH_COMPLETED,nt=Z.J.EDIT_WATCH_FAILED,st=Z.J.ADD_GROUP,it=Z.J.RENAME_GROUP,rt=Z.J.DELETE_GROUP,at=D.Z.notSelected,ut=D.Z.emptyName,ct=function(t,e){return t.isShow===e.isShow};const lt=(0,p.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,l.jsx)(T.Z,{caption:"Watch Groups Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,l.jsxs)(E.Z,{width:380,children:[(0,l.jsx)(G.Z,{title:"Create",children:(0,l.jsx)(U,{store:o,actionCompleted:ot,actionFailed:nt,forActionType:st,msgOnIsEmptyName:ut,onCreate:$,onClose:n})}),(0,l.jsx)(G.Z,{title:"Rename",children:(0,l.jsx)(q,{store:o,actionCompleted:ot,actionFailed:nt,forActionType:it,msgOnNotSelect:at,msgOnIsEmptyName:ut,onRename:tt,onClose:n})}),(0,l.jsx)(G.Z,{title:"Delete",children:(0,l.jsx)(Q,{store:o,actionCompleted:ot,forActionType:rt,msgOnNotSelect:at,onDelete:et,onClose:n})})]})})}),ct);const pt=function(t){var e=t.store,o=t.onCreate,n=t.msgOnNotSelect,s=t.msgOnIsEmptyName,i=t.actionCompleted,r=t.actionFailed,a=t.forActionType,u=t.onClose,c=(0,p.useState)((function(){return e.getWatchGroups()})),d=c[0],m=c[1],f=(0,p.useState)([]),h=f[0],C=f[1],T=X(C),g=T[0],x=T[1],v=P(),j=v[0],S=v[1],y=(0,p.useCallback)((function(){var t=g.current.getValue(),e=j.current;if(e&&t)o({captionGroup:e,captionList:t});else{var i=[];e||i.push(n("In Group")),t||i.push(s("List")),C(i)}}),[]),w=(0,p.useMemo)((function(){return(0,l.jsx)(J.Button.Primary,{caption:"Create",title:"Create New List",onClick:y})}),[y]);return(0,R.Z)(e,(function(t,o){t===i?(o.forActionType===a&&x(),m(e.getWatchGroups())):t===r&&o.forActionType===a&&C(o.messages)})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.RowInputSelect,{caption:"In Group:",options:d,onSelect:S}),(0,l.jsx)(J.RowInputText,{ref:g,caption:"List:"}),(0,l.jsx)(J.ValidationMessages,{validationMessages:h}),(0,l.jsx)(J.RowButtons,{Primary:w,onClear:x,onClose:u})]})};const dt=function(t){var e=t.store,o=t.onRename,n=t.msgOnIsEmptyName,s=t.msgOnNotSelect,i=t.actionCompleted,r=t.actionFailed,a=t.forActionType,u=t.onClose,c=(0,p.useState)((function(){return e.getWatchGroups()})),d=c[0],m=c[1],f=(0,p.useState)([]),h=f[0],C=f[1],T=(0,p.useRef)(),g=X(C),x=g[0],v=g[1],j=(0,p.useCallback)((function(){var t=T.current.getValue(),e=t.captionGroup,i=t.captionList,r=x.current.getValue();if(e&&i&&r)o({captionGroup:e,captionListFrom:i,captionListTo:r});else{var a=[];e||a.push(s("Group")),i||a.push(s("List From")),r||a.push(n("List To")),C(a)}}),[]),S=(0,p.useMemo)((function(){return(0,l.jsx)(J.Button.Primary,{caption:"Edit",title:"Edit List Name",onClick:j})}),[j]);return(0,R.Z)(e,(function(t,o){t===i?(o.forActionType===a&&v(),m(e.getWatchGroups())):t===r&&o.forActionType===a&&C(o.messages)})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.SelectGroupList,{ref:T,store:e,groupCaption:"In Group:",groupOptions:d,listCaption:"List From:"}),(0,l.jsx)(J.RowInputText,{ref:x,caption:"List To:"}),(0,l.jsx)(J.ValidationMessages,{validationMessages:h}),(0,l.jsx)(J.RowButtons,{Primary:S,onClear:v,onClose:u})]})};const mt=function(t){var e=t.store,o=t.actionCompleted,n=t.forActionType,s=t.onDelete,i=t.msgOnNotSelect,r=t.onClose,a=(0,p.useState)((function(){return e.getWatchGroups()})),u=a[0],c=a[1],d=(0,p.useState)([]),m=d[0],f=d[1],h=(0,p.useRef)(),C=(0,p.useCallback)((function(){return f([])}),[]),T=(0,p.useCallback)((function(){var t=h.current.getValue(),e=t.captionGroup,o=t.captionList;if(e&&o)s({captionGroup:e,captionList:o});else{var n=[];e||n.push(i("Group")),o||n.push(i("List")),f(n)}}),[]),g=(0,p.useMemo)((function(){return(0,l.jsx)(J.Button.Primary,{caption:"Delete",title:"Delete List",onClick:T})}),[T]);return(0,R.Z)(e,(function(t,s){t===o&&(s.forActionType===n&&C(),c(e.getWatchGroups()))})),(0,l.jsxs)("div",{children:[(0,l.jsx)(J.SelectGroupList,{ref:h,store:e,groupCaption:"In Group:",groupOptions:u,listCaption:"List:"}),(0,l.jsx)(J.ValidationMessages,{validationMessages:m}),(0,l.jsx)(J.RowButtons,{Primary:g,onClear:C,onClose:r})]})};var ft=Z.Z.createList,ht=Z.Z.renameList,Ct=Z.Z.deleteList,Tt=Z.J.EDIT_WATCH_COMPLETED,gt=Z.J.EDIT_WATCH_FAILED,xt=Z.J.CREATE_LIST,vt=Z.J.RENAME_LIST,jt=Z.J.DELETE_LIST,St=D.Z.notSelected,yt=D.Z.emptyName,wt=function(t,e){return t.isShow===e.isShow};const It={LoadItem:L,EditGroup:lt,EditList:(0,p.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,l.jsx)(T.Z,{caption:"Watch Lists Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,l.jsxs)(E.Z,{width:380,children:[(0,l.jsx)(G.Z,{title:"Create",children:(0,l.jsx)(pt,{store:o,actionCompleted:Tt,actionFailed:gt,forActionType:xt,msgOnNotSelect:St,msgOnIsEmptyName:yt,onCreate:ft,onClose:n})}),(0,l.jsx)(G.Z,{title:"Rename",children:(0,l.jsx)(dt,{store:o,actionCompleted:Tt,actionFailed:gt,forActionType:vt,msgOnNotSelect:St,msgOnIsEmptyName:yt,onRename:ht,onClose:n})}),(0,l.jsx)(G.Z,{title:"Delete",children:(0,l.jsx)(mt,{store:o,actionCompleted:Tt,actionFailed:gt,forActionType:jt,msgOnNotSelect:St,onDelete:Ct,onClose:n})})]})})}),wt)}}}]);