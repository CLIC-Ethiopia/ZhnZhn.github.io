(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[437],{3662:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>xt});var n,s,i,a=o(7154),r=o.n(a),l=o(5354),p=o.n(l),u=o(5893),c=o(9679),d=o(1398),h=o(7020),m=o(9761),f=o(3014),g=o(6485),C=o(5138),T=o(377),v=o(2276),x=o(8806),S=d.Z.getFromDate,_=d.Z.getToDate,y=d.Z.isYmd,j=d.Z.mlsToDmy,O={DIALOG:{width:365},DIALOG_SHORT:{width:265},ITEM_TEXT:{display:"inline-block",maxWidth:250,height:32,verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden"}};const w=(0,x.Z.dialog)((i=s=function(t){function e(e){var o;(o=t.call(this,e)||this)._handleLoad=function(){var t=o._createValidationMessages();if(t.isValid){var e=o.props,n=e.data,s=e.onClose,i=n.id,a=n.title,l=n.subtitle,p=n.caption,u=n.columnName,c=n.dataColumn,d=n.seriaColumnNames,h=n.itemConf,C=void 0===h?{}:h,T=o.datesFragment.getValues(),v=T.fromDate,x=T.toDate,S=r()({id:i,title:a,subtitle:l,value:p,item:p,fromDate:v,toDate:x,columnName:u,dataColumn:c,seriaColumnNames:d,loadId:C.loadId||f.L2.WL},C);m.Z.loadStock({chartType:g.Z.WATCH_LIST,browserType:f.Aq.WATCH_LIST},S),s()}o._updateValidationMessages(t)},o._createValidationMessages=function(){var t=[],e=o.datesFragment.getValidation(),n=e.isValid,s=e.datesMsg;return n||(t=t.concat(s)),t.isValid=0===t.length,t},o._handleClose=function(){o._handleWithValidationClose(o._createValidationMessages),o.props.onClose()},o._refDates=function(t){return o.datesFragment=t};var n=e.data,s=n.fromDate,i=n.initToDate,a=n.onTestDate,l=n.itemConf,p=!!(void 0===l?{}:l).x;return o.toolbarButtons=o._createType2WithToolbar(e,{isValue:p}),o._commandButtons=[(0,u.jsx)(T.Z.Button.Load,{onClick:o._handleLoad},"load")],o.state=r()({},o._isWithInitialState(),{isShowDate:!1,isValue:p,initFromDate:s||S(2),initToDate:i||_(),onTestDate:a||y}),o}p()(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.data,n=o.caption,s=o.itemConf,i=void 0===s?{}:s,a=i.dataSource,r=i.x,l=i.y,p=this.state,c=p.isShowLabels,d=p.isShowDate,m=p.isValue,f=p.initFromDate,g=p.initToDate,x=p.onTestDate,S=p.validationMessages,_=c?O.DIALOG:O.DIALOG_SHORT,y=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),((0,h.Z)(e)+" "+j(t)).trim()}(r,l);return(0,u.jsxs)(C.Z,{style:_,isShow:e,caption:"Load Item",commandButtons:this._commandButtons,onClose:this._handleClose,children:[(0,u.jsx)(T.Z.Toolbar,{isShow:!0,buttons:this.toolbarButtons}),(0,u.jsx)(T.Z.Row.Text,{isShowLabels:c,styleText:O.ITEM_TEXT,caption:"Item:",text:n}),(0,u.jsx)(T.Z.ShowHide,{isShow:m,children:(0,u.jsx)(T.Z.Row.Text,{isShowLabels:c,styleText:O.ITEM_TEXT,caption:"Value:",text:y})}),(0,u.jsx)(T.Z.ShowHide,{isShow:d,children:(0,u.jsx)(T.Z.DatesFragment,{ref:this._refDates,isShowLabels:c,initFromDate:f,initToDate:g,onTestDate:x})}),(0,u.jsx)(T.Z.Row.Text,{isShowLabels:c,styleText:O.ITEM_TEXT,caption:"Source:",text:a}),(0,u.jsx)(v.Z,{validationMessages:S})]})},e}(c.Component),s.defaultProps={data:{}},n=i))||n;var G=o(3218),L=o(2125),D=o(8580),I=o(2302),M=o(795),Z=o(5313),E=o(7376),A={ROW:r()({},E.Z.ROW,{lineHeight:2}),CAPTION:r()({},E.Z.CAPTION,{width:120}),INPUT_TEXT:{width:250,height:30,paddingLeft:10,marginLeft:0,marginRight:0}};const R=(0,c.forwardRef)((function(t,e){var o=t.caption;return(0,u.jsxs)("div",{style:A.ROW,children:[(0,u.jsx)("span",{style:A.CAPTION,children:o}),(0,u.jsx)(Z.Z,{ref:e,style:A.INPUT_TEXT})]})}));var N=o(4298),b={CAPTION:r()({},E.Z.CAPTION,{width:120})};const V=function(t){var e=t.caption,o=t.options,n=t.onSelect;return(0,u.jsxs)("div",{style:E.Z.ROW,children:[(0,u.jsx)("span",{style:b.CAPTION,children:e}),(0,u.jsx)(N.Z,{width:"250",options:o,onSelect:n})]})};const W=function(t){function e(e){var o;return(o=t.call(this)||this)._handleSelectGroup=function(t){t&&t.caption?(o.groupCaption=t.caption,t.lists?o.setState({listOptions:t.lists}):o.setState({listOptions:[]})):o.groupCaption=null},o._handleSelectList=function(t){o.listCaption=t&&t.caption||null},o.groupCaption=null,o.listCaption=null,o.state={listOptions:[]},o}p()(e,t);var o=e.prototype;return o.UNSAFE_componentWillReceiveProps=function(t){if(t!==this.props)if(t.groupOptions!==this.props.groupOptions)this.groupCaption=null,this.listCaption=null,this.setState({listOptions:[]});else if(this.groupCaption){var e=this.props.store.getWatchListsByGroup(this.groupCaption);e!==this.state.listOptions&&(this.listCaption=null),this.setState({listOptions:e})}},o.render=function(){var t=this.props,e=t.groupCaption,o=t.groupOptions,n=t.listCaption,s=this.state.listOptions;return(0,u.jsxs)("div",{children:[(0,u.jsx)(V,{caption:e,options:o,onSelect:this._handleSelectGroup}),(0,u.jsx)(V,{caption:n,options:s,onSelect:this._handleSelectList})]})},o.getValue=function(){return{captionGroup:this.groupCaption,captionList:this.listCaption}},o.setValueNull=function(){this.groupCaption=null,this.listCaption=null},e}(c.Component);var F=o(481);const B={COMMAND_DIV:{cursor:"default",float:"right",marginTop:"8px",marginBottom:"10px",marginRight:"4px"}};const P=function(t){var e=t.Primary,o=t.withoutClear,n=t.onClear,s=t.onClose;return(0,u.jsxs)("div",{style:B.COMMAND_DIV,children:[e,!o&&(0,u.jsx)(F.Z.Clear,{onClick:n}),(0,u.jsx)(F.Z.Close,{onClick:s})]})};const k={RowInputText:R,RowInputSelect:V,FragmentSelectGroupList:W,Button:F.Z,RowButtons:P,ValidationMessages:v.Z};const U=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onCreate,a=t.msgOnIsEmptyName,r=t.onClose,l=(0,c.useRef)(),p=(0,c.useState)([]),d=p[0],h=p[1],m=function(t,e,o,n){return(0,u.jsx)(k.Button.Primary,{caption:"Create",title:"Create New Group",onClick:function(){var s=t.current.getValue();s?o({caption:s}):(t.current.setValue(""),e([n("Group")]))}})}(l,h,i,a),f=function(){l.current.setValue(""),h([])};return(0,M.Z)(e,(function(t,e){t===o&&e.forActionType===s?f():t===n&&e.forActionType===s&&h(e.messages)})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputText,{ref:l,caption:"Group:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:d}),(0,u.jsx)(k.RowButtons,{Primary:m,onClear:f,onClose:r})]})};const H=function(t){function e(e){var o;return(o=t.call(this)||this)._onStore=function(t,e){var n=o.props,s=n.actionCompleted,i=n.actionFailed,a=n.forActionType,r=n.store;t===s?(e.forActionType===a&&o._handleClear(),o.setState({groupOptions:r.getWatchGroups()})):t===i&&e.forActionType===a&&o.setState({validationMessages:e.messages})},o._handleSelectGroup=function(t){o.captionFrom=t&&t.caption||null},o._handleClear=function(){o.inputText.setValue(""),o.state.validationMessages.length>0&&o.setState({validationMessages:[]})},o._handleRename=function(){var t=o.props,e=t.onRename,n=t.msgOnNotSelect,s=t.msgOnIsEmptyName,i=o.inputText.getValue();if(i&&o.captionFrom)e({captionFrom:o.captionFrom,captionTo:i});else{var a=[];o.captionFrom||a.push(n("Group From")),i||a.push(s("Group To")),o.setState({validationMessages:a})}},o._refInputText=function(t){return o.inputText=t},o.captionFrom=null,o._primaryBt=(0,u.jsx)(k.Button.Primary,{caption:"Edit",title:"Edit Group Name",onClick:o._handleRename}),o.state={groupOptions:e.store.getWatchGroups(),validationMessages:[]},o}p()(e,t);var o=e.prototype;return o.componentDidMount=function(){this.unsubscribe=this.props.store.listen(this._onStore)},o.componentWillUnmount=function(){this.unsubscribe()},o.render=function(){var t=this.props.onClose,e=this.state,o=e.groupOptions,n=e.validationMessages;return(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"Group From:",options:o,onSelect:this._handleSelectGroup}),(0,u.jsx)(k.RowInputText,{ref:this._refInputText,caption:"Group To:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:n}),(0,u.jsx)(k.RowButtons,{Primary:this._primaryBt,onClear:this._handleClear,onClose:t})]})},e}(c.Component);var J=function(t){return{groups:t.getWatchGroups,errs:[]}},X=function(t,e){return{type:t,payload:e}},q=function(t,e){var o=e.type,n=e.payload;switch(o){case"a":return{groups:n,errs:[]};case"b":return r()({},t,{errs:n});default:return t}};const Y=function(t){var e=t.store,o=t.actionCompleted,n=(t.forActionType,t.onDelete),s=t.msgOnNotSelect,i=t.onClose,a=(0,c.useRef)(null),r=function(t,e){var o=(0,c.useReducer)(q,t,J),n=o[0],s=n.groups,i=n.errs,a=o[1];return[s,i,function(t){return a(X("a",t))},function(){return a(X("b",[e("Group")]))}]}(e,s),l=r[0],p=r[1],d=r[2],h=r[3],m=function(t,e,o){return(0,u.jsx)(k.Button.Primary,{caption:"Delete",title:"Delete Group",onClick:function(){var n=t.current;n?(e({caption:n}),t.current=null):o()}})}(a,n,h);return(0,M.Z)(e,(function(t,n){t===o&&d(e.getWatchGroups())})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"Group:",options:l,onSelect:function(t){a.current=t&&t.caption||null}}),(0,u.jsx)(k.ValidationMessages,{validationMessages:p}),(0,u.jsx)(k.RowButtons,{Primary:m,withoutClear:!0,onClose:i})]})};var z=G.Z.addGroup,K=G.Z.renameGroup,Q=G.Z.deleteGroup,$=G.J.EDIT_WATCH_COMPLETED,tt=G.J.EDIT_WATCH_FAILED,et=G.J.ADD_GROUP,ot=G.J.RENAME_GROUP,nt=G.J.DELETE_GROUP,st=L.Z.notSelected,it=L.Z.emptyName;const at=function(t){function e(){return t.apply(this,arguments)||this}p()(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.store,n=t.onClose;return(0,u.jsx)(C.Z,{caption:"Watch Groups Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,u.jsxs)(D.Z,{width:380,children:[(0,u.jsx)(I.Z,{title:"Create",children:(0,u.jsx)(U,{store:o,actionCompleted:$,actionFailed:tt,forActionType:et,msgOnIsEmptyName:it,onCreate:z,onClose:n})}),(0,u.jsx)(I.Z,{title:"Rename",children:(0,u.jsx)(H,{store:o,actionCompleted:$,actionFailed:tt,forActionType:ot,msgOnNotSelect:st,msgOnIsEmptyName:it,onRename:K,onClose:n})}),(0,u.jsx)(I.Z,{title:"Delete",children:(0,u.jsx)(Y,{store:o,actionCompleted:$,forActionType:nt,msgOnNotSelect:st,onDelete:Q,onClose:n})})]})})},e}(c.Component);const rt=function(t){function e(e){var o;return(o=t.call(this)||this)._onStore=function(t,e){var n=o.props,s=n.actionCompleted,i=n.actionFailed,a=n.forActionType,r=n.store;t===s?(e.forActionType===a&&o._handleClear(),o.setState({groupOptions:r.getWatchGroups()})):t===i&&e.forActionType===a&&o.setState({validationMessages:e.messages})},o._handleSelectGroup=function(t){o.captionGroup=t&&t.caption||null},o._handleClear=function(){o.inputText.setValue(""),o.state.validationMessages.length>0&&o.setState({validationMessages:[]})},o._handleCreate=function(){var t=o.props,e=t.onCreate,n=t.msgOnNotSelect,s=t.msgOnIsEmptyName,i=o.inputText.getValue();if(o.captionGroup&&i)e({captionGroup:o.captionGroup,captionList:i});else{var a=[];o.captionGroup||a.push(n("In Group")),i||a.push(s("List")),o.setState({validationMessages:a})}},o._refInputText=function(t){return o.inputText=t},o.captionGroup=null,o._primaryBt=(0,u.jsx)(k.Button.Primary,{caption:"Create",title:"Create New List",onClick:o._handleCreate}),o.state={groupOptions:e.store.getWatchGroups(),validationMessages:[]},o}p()(e,t);var o=e.prototype;return o.componentDidMount=function(){this.unsubscribe=this.props.store.listen(this._onStore)},o.componentWillUnmount=function(){this.unsubscribe()},o.render=function(){var t=this.props.onClose,e=this.state,o=e.groupOptions,n=e.validationMessages;return(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"In Group:",options:o,onSelect:this._handleSelectGroup}),(0,u.jsx)(k.RowInputText,{ref:this._refInputText,caption:"List:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:n}),(0,u.jsx)(k.RowButtons,{Primary:this._primaryBt,onClear:this._handleClear,onClose:t})]})},e}(c.Component);const lt=function(t){function e(e){var o;return(o=t.call(this)||this)._onStore=function(t,e){var n=o.props,s=n.actionCompleted,i=n.actionFailed,a=n.forActionType,r=n.store;t===s?(e.forActionType===a&&o._handleClear(),o.setState({groupOptions:r.getWatchGroups()})):t===i&&e.forActionType===a&&o.setState({validationMessages:e.messages})},o._handleClear=function(){o.inputText.setValue(""),o.state.validationMessages.length>0&&o.setState({validationMessages:[]})},o._handleRename=function(){var t=o.props,e=t.onRename,n=t.msgOnIsEmptyName,s=t.msgOnNotSelect,i=o.selectGroupList.getValue(),a=i.captionGroup,r=i.captionList,l=o.inputText.getValue();if(a&&r&&l)e({captionGroup:a,captionListFrom:r,captionListTo:l});else{var p=[];a||p.push(s("Group")),r||p.push(s("List From")),l||p.push(n("List To")),o.setState({validationMessages:p})}},o._primaryBt=(0,u.jsx)(k.Button.Primary,{caption:"Edit",title:"Edit List Name",onClick:o._handleRename}),o.state={groupOptions:e.store.getWatchGroups(),listOptions:[],validationMessages:[]},o}p()(e,t);var o=e.prototype;return o.componentDidMount=function(){this.unsubscribe=this.props.store.listen(this._onStore)},o.componentWillUnmount=function(){this.unsubscribe()},o.render=function(){var t=this,e=this.props,o=e.store,n=e.onClose,s=this.state,i=s.groupOptions,a=s.validationMessages;return(0,u.jsxs)("div",{children:[(0,u.jsx)(k.FragmentSelectGroupList,{ref:function(e){return t.selectGroupList=e},store:o,groupCaption:"In Group:",groupOptions:i,listCaption:"List From:"}),(0,u.jsx)(k.RowInputText,{ref:function(e){return t.inputText=e},caption:"List To:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:a}),(0,u.jsx)(k.RowButtons,{Primary:this._primaryBt,onClear:this._handleClear,onClose:n})]})},e}(c.Component);const pt=function(t){function e(e){var o;return(o=t.call(this)||this)._onStore=function(t,e){var n=o.props,s=n.actionCompleted,i=n.forActionType,a=n.store;t===s&&(e.forActionType===i&&o._handleClear(),o.setState({groupOptions:a.getWatchGroups()}))},o._handleClear=function(){o.state.validationMessages.length>0&&o.setState({validationMessages:[]})},o._handleDelete=function(){var t=o.props,e=t.onDelete,n=t.msgOnNotSelect,s=o.selectGroupList.getValue(),i=s.captionGroup,a=s.captionList;if(i&&a)e({captionGroup:i,captionList:a});else{var r=[];i||r.push(n("Group")),a||r.push(n("List")),o.setState({validationMessages:r})}},o._primaryBt=(0,u.jsx)(k.Button.Primary,{caption:"Delete",title:"Delete List",onClick:o._handleDelete}),o.state={groupOptions:e.store.getWatchGroups(),validationMessages:[]},o}p()(e,t);var o=e.prototype;return o.componentDidMount=function(){this.unsubscribe=this.props.store.listen(this._onStore)},o.componentWillUnmount=function(){this.unsubscribe()},o.render=function(){var t=this,e=this.props,o=e.store,n=e.onClose,s=this.state,i=s.groupOptions,a=s.validationMessages;return(0,u.jsxs)("div",{children:[(0,u.jsx)(k.FragmentSelectGroupList,{ref:function(e){return t.selectGroupList=e},store:o,groupCaption:"In Group:",groupOptions:i,listCaption:"List:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:a}),(0,u.jsx)(k.RowButtons,{Primary:this._primaryBt,onClear:this._handleClear,onClose:n})]})},e}(c.Component);var ut=G.Z.createList,ct=G.Z.renameList,dt=G.Z.deleteList,ht=G.J.EDIT_WATCH_COMPLETED,mt=G.J.EDIT_WATCH_FAILED,ft=G.J.CREATE_LIST,gt=G.J.RENAME_LIST,Ct=G.J.DELETE_LIST,Tt=L.Z.notSelected,vt=L.Z.emptyName;const xt={LoadItem:w,EditGroup:at,EditList:function(t){function e(){return t.apply(this,arguments)||this}p()(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.store,n=t.onClose;return(0,u.jsx)(C.Z,{caption:"Watch Lists Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,u.jsxs)(D.Z,{width:380,children:[(0,u.jsx)(I.Z,{title:"Create",children:(0,u.jsx)(rt,{store:o,actionCompleted:ht,actionFailed:mt,forActionType:ft,msgOnNotSelect:Tt,msgOnIsEmptyName:vt,onCreate:ut,onClose:n})}),(0,u.jsx)(I.Z,{title:"Rename",children:(0,u.jsx)(lt,{store:o,actionCompleted:ht,actionFailed:mt,forActionType:gt,msgOnNotSelect:Tt,msgOnIsEmptyName:vt,onRename:ct,onClose:n})}),(0,u.jsx)(I.Z,{title:"Delete",children:(0,u.jsx)(pt,{store:o,actionCompleted:ht,actionFailed:mt,forActionType:Ct,msgOnNotSelect:Tt,onDelete:dt,onClose:n})})]})})},e}(c.Component)}}}]);