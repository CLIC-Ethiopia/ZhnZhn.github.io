(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[437],{7147:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>yt});var n,s,i,r=o(2122),a=o(3552),u=o(5893),c=o(9679),l=o(1398),p=o(7020),d=o(7900),m=o(3014),f=o(6485),h=o(5138),C=o(377),T=o(2276),g=o(837),x=l.Z.getFromDate,v=l.Z.getToDate,j=l.Z.isYmd,S=l.Z.mlsToDmy,y={DIALOG:{width:365},DIALOG_SHORT:{width:265},ITEM_TEXT:{display:"inline-block",maxWidth:250,height:32,verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden"}};const w=(0,g.Z.dialog)((i=s=function(t){function e(e){var o;(o=t.call(this,e)||this)._handleLoad=function(){var t=o._createValidationMessages();if(t.isValid){var e=o.props,n=e.data,s=e.onClose,i=n.id,a=n.title,u=n.subtitle,c=n.caption,l=n.columnName,p=n.dataColumn,h=n.seriaColumnNames,C=n.itemConf,T=void 0===C?{}:C,g=o.datesFragment.getValues(),x=g.fromDate,v=g.toDate,j=(0,r.Z)({id:i,title:a,subtitle:u,value:c,item:c,fromDate:x,toDate:v,columnName:l,dataColumn:p,seriaColumnNames:h,loadId:T.loadId||m.L2.WL},T);d.Z.loadStock({chartType:f.Z.WATCH_LIST,browserType:m.Aq.WATCH_LIST},j),s()}o._updateValidationMessages(t)},o._createValidationMessages=function(){var t=[],e=o.datesFragment.getValidation(),n=e.isValid,s=e.datesMsg;return n||(t=t.concat(s)),t.isValid=0===t.length,t},o._handleClose=function(){o._handleWithValidationClose(o._createValidationMessages),o.props.onClose()},o._refDates=function(t){return o.datesFragment=t};var n=e.data,s=n.fromDate,i=n.initToDate,a=n.onTestDate,c=n.itemConf,l=!!(void 0===c?{}:c).x;return o.toolbarButtons=o._createType2WithToolbar(e,{isValue:l}),o._commandButtons=[(0,u.jsx)(C.Z.Button.Load,{onClick:o._handleLoad},"load")],o.state=(0,r.Z)({},o._isWithInitialState(),{isShowDate:!1,isValue:l,initFromDate:s||x(2),initToDate:i||v(),onTestDate:a||j}),o}(0,a.Z)(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.data,n=o.caption,s=o.itemConf,i=void 0===s?{}:s,r=i.dataSource,a=i.x,c=i.y,l=this.state,d=l.isShowLabels,m=l.isShowDate,f=l.isValue,g=l.initFromDate,x=l.initToDate,v=l.onTestDate,j=l.validationMessages,w=d?y.DIALOG:y.DIALOG_SHORT,Z=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),((0,p.Z)(e)+" "+S(t)).trim()}(a,c);return(0,u.jsxs)(h.Z,{style:w,isShow:e,caption:"Load Item",commandButtons:this._commandButtons,onClose:this._handleClose,children:[(0,u.jsx)(C.Z.Toolbar,{isShow:!0,buttons:this.toolbarButtons}),(0,u.jsx)(C.Z.Row.Text,{isShowLabels:d,styleText:y.ITEM_TEXT,caption:"Item:",text:n}),(0,u.jsx)(C.Z.ShowHide,{isShow:f,children:(0,u.jsx)(C.Z.Row.Text,{isShowLabels:d,styleText:y.ITEM_TEXT,caption:"Value:",text:Z})}),(0,u.jsx)(C.Z.ShowHide,{isShow:m,children:(0,u.jsx)(C.Z.DatesFragment,{ref:this._refDates,isShowLabels:d,initFromDate:g,initToDate:x,onTestDate:v})}),(0,u.jsx)(C.Z.Row.Text,{isShowLabels:d,styleText:y.ITEM_TEXT,caption:"Source:",text:r}),(0,u.jsx)(T.Z,{validationMessages:j})]})},e}(c.Component),s.defaultProps={data:{}},n=i))||n;var Z=o(3218),I=o(2125),L=o(8580),D=o(2302),E=o(795),G=o(5313),R=o(7376),A={ROW:(0,r.Z)({},R.Z.ROW,{lineHeight:2}),CAPTION:(0,r.Z)({},R.Z.CAPTION,{width:120}),INPUT_TEXT:{width:250,height:30,paddingLeft:10,marginLeft:0,marginRight:0}};const O=(0,c.forwardRef)((function(t,e){var o=t.caption;return(0,u.jsxs)("div",{style:A.ROW,children:[(0,u.jsx)("span",{style:A.CAPTION,children:o}),(0,u.jsx)(G.Z,{ref:e,style:A.INPUT_TEXT})]})}));var _=o(6614),N={CAPTION:(0,r.Z)({},R.Z.CAPTION,{width:120})};const M=function(t){var e=t.caption,o=t.options,n=t.onSelect;return(0,u.jsxs)("div",{style:R.Z.ROW,children:[(0,u.jsx)("span",{style:N.CAPTION,children:e}),(0,u.jsx)(_.Z,{width:"250",options:o,onSelect:n})]})};var V=o(5868);const W=function(){var t=(0,c.useRef)(),e=(0,c.useCallback)((function(e){var o=(e||{}).caption;t.current=o}),[]);return[t,e]};const b=(0,c.forwardRef)((function(t,e){var o=(0,V.Z)(t),n=o[0],s=o[1],i=t.store,r=t.groupCaption,a=t.groupOptions,l=t.listCaption,p=(0,c.useRef)(),d=W(),m=d[0],f=d[1],h=(0,c.useState)([]),C=h[0],T=h[1],g=(0,c.useCallback)((function(t){var e=(t||{}).caption;t&&e?(p.current=e,m.current=null,T(t.lists||[])):p.current=null}),[]);return(0,c.useEffect)((function(){var e=s();if(e!==t){if(e.groupOptions!==a)p.current=null,m.current=null,T([]);else if(p.current){var o=i.getWatchListsByGroup(p.current);o!==C&&(m.current=null,T(o))}n(t)}}),[t]),(0,c.useImperativeHandle)(e,(function(){return{getValue:function(){return{captionGroup:p.current,captionList:m.current}}}})),(0,u.jsxs)("div",{children:[(0,u.jsx)(M,{caption:r,options:a,onSelect:g}),(0,u.jsx)(M,{caption:l,options:C,onSelect:f})]})}));var P=o(481);const F={COMMAND_DIV:{cursor:"default",float:"right",marginTop:"8px",marginBottom:"10px",marginRight:"4px"}};const B=function(t){var e=t.Primary,o=t.withoutClear,n=t.onClear,s=t.onClose;return(0,u.jsxs)("div",{style:F.COMMAND_DIV,children:[e,!o&&(0,u.jsx)(P.Z.Clear,{onClick:n}),(0,u.jsx)(P.Z.Close,{onClick:s})]})};const k={RowInputText:O,RowInputSelect:M,SelectGroupList:b,Button:P.Z,RowButtons:B,ValidationMessages:T.Z};const H=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onCreate,r=t.msgOnIsEmptyName,a=t.onClose,l=(0,c.useRef)(),p=(0,c.useState)([]),d=p[0],m=p[1],f=function(t,e,o,n){return(0,u.jsx)(k.Button.Primary,{caption:"Create",title:"Create New Group",onClick:function(){var s=t.current.getValue();s?o({caption:s}):(t.current.setValue(""),e([n("Group")]))}})}(l,m,i,r),h=function(){l.current.setValue(""),m([])};return(0,E.Z)(e,(function(t,e){t===o&&e.forActionType===s?h():t===n&&e.forActionType===s&&m(e.messages)})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputText,{ref:l,caption:"Group:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:d}),(0,u.jsx)(k.RowButtons,{Primary:f,onClear:h,onClose:a})]})};const J=function(t){var e=(0,c.useRef)(),o=(0,c.useCallback)((function(){var o=e.current;o&&(o.setValue(""),t([]))}),[]);return[e,o]};const U=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onRename,r=t.msgOnNotSelect,a=t.msgOnIsEmptyName,l=t.onClose,p=(0,c.useState)((function(){return e.getWatchGroups()})),d=p[0],m=p[1],f=(0,c.useState)([]),h=f[0],C=f[1],T=J(C),g=T[0],x=T[1],v=W(),j=v[0],S=v[1],y=(0,c.useCallback)((function(){var t=g.current.getValue(),e=j.current;if(t&&e)i({captionFrom:e,captionTo:t});else{var o=[];e||o.push(r("Group From")),t||o.push(a("Group To")),C(o)}}),[]),w=(0,c.useMemo)((function(){return(0,u.jsx)(k.Button.Primary,{caption:"Edit",title:"Edit Group Name",onClick:y})}),[y]);return(0,E.Z)(e,(function(t,i){t===o?(i.forActionType===s&&x(),m(e.getWatchGroups())):t===n&&i.forActionType===s&&C(i.messages)})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"Group From:",options:d,onSelect:S}),(0,u.jsx)(k.RowInputText,{ref:g,caption:"Group To:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:h}),(0,u.jsx)(k.RowButtons,{Primary:w,onClear:x,onClose:l})]})};var X=function(t){return{groups:t.getWatchGroups,errs:[]}},q=function(t,e){return{type:t,payload:e}},Y=function(t,e){var o=e.type,n=e.payload;switch(o){case"a":return{groups:n,errs:[]};case"b":return(0,r.Z)({},t,{errs:n});default:return t}};const z=function(t){var e=t.store,o=t.actionCompleted,n=(t.forActionType,t.onDelete),s=t.msgOnNotSelect,i=t.onClose,r=(0,c.useRef)(null),a=function(t,e){var o=(0,c.useReducer)(Y,t,X),n=o[0],s=n.groups,i=n.errs,r=o[1];return[s,i,function(t){return r(q("a",t))},function(){return r(q("b",[e("Group")]))}]}(e,s),l=a[0],p=a[1],d=a[2],m=a[3],f=function(t,e,o){return(0,u.jsx)(k.Button.Primary,{caption:"Delete",title:"Delete Group",onClick:function(){var n=t.current;n?(e({caption:n}),t.current=null):o()}})}(r,n,m);return(0,E.Z)(e,(function(t,n){t===o&&d(e.getWatchGroups())})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"Group:",options:l,onSelect:function(t){r.current=t&&t.caption||null}}),(0,u.jsx)(k.ValidationMessages,{validationMessages:p}),(0,u.jsx)(k.RowButtons,{Primary:f,withoutClear:!0,onClose:i})]})};var K=Z.Z.addGroup,Q=Z.Z.renameGroup,$=Z.Z.deleteGroup,tt=Z.J.EDIT_WATCH_COMPLETED,et=Z.J.EDIT_WATCH_FAILED,ot=Z.J.ADD_GROUP,nt=Z.J.RENAME_GROUP,st=Z.J.DELETE_GROUP,it=I.Z.notSelected,rt=I.Z.emptyName,at=function(t,e){return t.isShow===e.isShow};const ut=(0,c.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,u.jsx)(h.Z,{caption:"Watch Groups Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,u.jsxs)(L.Z,{width:380,children:[(0,u.jsx)(D.Z,{title:"Create",children:(0,u.jsx)(H,{store:o,actionCompleted:tt,actionFailed:et,forActionType:ot,msgOnIsEmptyName:rt,onCreate:K,onClose:n})}),(0,u.jsx)(D.Z,{title:"Rename",children:(0,u.jsx)(U,{store:o,actionCompleted:tt,actionFailed:et,forActionType:nt,msgOnNotSelect:it,msgOnIsEmptyName:rt,onRename:Q,onClose:n})}),(0,u.jsx)(D.Z,{title:"Delete",children:(0,u.jsx)(z,{store:o,actionCompleted:tt,forActionType:st,msgOnNotSelect:it,onDelete:$,onClose:n})})]})})}),at);const ct=function(t){var e=t.store,o=t.onCreate,n=t.msgOnNotSelect,s=t.msgOnIsEmptyName,i=t.actionCompleted,r=t.actionFailed,a=t.forActionType,l=t.onClose,p=(0,c.useState)((function(){return e.getWatchGroups()})),d=p[0],m=p[1],f=(0,c.useState)([]),h=f[0],C=f[1],T=J(C),g=T[0],x=T[1],v=W(),j=v[0],S=v[1],y=(0,c.useCallback)((function(){var t=g.current.getValue(),e=j.current;if(e&&t)o({captionGroup:e,captionList:t});else{var i=[];e||i.push(n("In Group")),t||i.push(s("List")),C(i)}}),[]),w=(0,c.useMemo)((function(){return(0,u.jsx)(k.Button.Primary,{caption:"Create",title:"Create New List",onClick:y})}),[y]);return(0,E.Z)(e,(function(t,o){t===i?(o.forActionType===a&&x(),m(e.getWatchGroups())):t===r&&o.forActionType===a&&C(o.messages)})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.RowInputSelect,{caption:"In Group:",options:d,onSelect:S}),(0,u.jsx)(k.RowInputText,{ref:g,caption:"List:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:h}),(0,u.jsx)(k.RowButtons,{Primary:w,onClear:x,onClose:l})]})};const lt=function(t){var e=t.store,o=t.onRename,n=t.msgOnIsEmptyName,s=t.msgOnNotSelect,i=t.actionCompleted,r=t.actionFailed,a=t.forActionType,l=t.onClose,p=(0,c.useState)((function(){return e.getWatchGroups()})),d=p[0],m=p[1],f=(0,c.useState)([]),h=f[0],C=f[1],T=(0,c.useRef)(),g=J(C),x=g[0],v=g[1],j=(0,c.useCallback)((function(){var t=T.current.getValue(),e=t.captionGroup,i=t.captionList,r=x.current.getValue();if(e&&i&&r)o({captionGroup:e,captionListFrom:i,captionListTo:r});else{var a=[];e||a.push(s("Group")),i||a.push(s("List From")),r||a.push(n("List To")),C(a)}}),[]),S=(0,c.useMemo)((function(){return(0,u.jsx)(k.Button.Primary,{caption:"Edit",title:"Edit List Name",onClick:j})}),[j]);return(0,E.Z)(e,(function(t,o){t===i?(o.forActionType===a&&v(),m(e.getWatchGroups())):t===r&&o.forActionType===a&&C(o.messages)})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.SelectGroupList,{ref:T,store:e,groupCaption:"In Group:",groupOptions:d,listCaption:"List From:"}),(0,u.jsx)(k.RowInputText,{ref:x,caption:"List To:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:h}),(0,u.jsx)(k.RowButtons,{Primary:S,onClear:v,onClose:l})]})};const pt=function(t){var e=t.store,o=t.actionCompleted,n=t.forActionType,s=t.onDelete,i=t.msgOnNotSelect,r=t.onClose,a=(0,c.useState)((function(){return e.getWatchGroups()})),l=a[0],p=a[1],d=(0,c.useState)([]),m=d[0],f=d[1],h=(0,c.useRef)(),C=(0,c.useCallback)((function(){return f([])}),[]),T=(0,c.useCallback)((function(){var t=h.current.getValue(),e=t.captionGroup,o=t.captionList;if(e&&o)s({captionGroup:e,captionList:o});else{var n=[];e||n.push(i("Group")),o||n.push(i("List")),f(n)}}),[]),g=(0,c.useMemo)((function(){return(0,u.jsx)(k.Button.Primary,{caption:"Delete",title:"Delete List",onClick:T})}),[T]);return(0,E.Z)(e,(function(t,s){t===o&&(s.forActionType===n&&C(),p(e.getWatchGroups()))})),(0,u.jsxs)("div",{children:[(0,u.jsx)(k.SelectGroupList,{ref:h,store:e,groupCaption:"In Group:",groupOptions:l,listCaption:"List:"}),(0,u.jsx)(k.ValidationMessages,{validationMessages:m}),(0,u.jsx)(k.RowButtons,{Primary:g,onClear:C,onClose:r})]})};var dt=Z.Z.createList,mt=Z.Z.renameList,ft=Z.Z.deleteList,ht=Z.J.EDIT_WATCH_COMPLETED,Ct=Z.J.EDIT_WATCH_FAILED,Tt=Z.J.CREATE_LIST,gt=Z.J.RENAME_LIST,xt=Z.J.DELETE_LIST,vt=I.Z.notSelected,jt=I.Z.emptyName,St=function(t,e){return t.isShow===e.isShow};const yt={LoadItem:w,EditGroup:ut,EditList:(0,c.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,u.jsx)(h.Z,{caption:"Watch Lists Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,u.jsxs)(L.Z,{width:380,children:[(0,u.jsx)(D.Z,{title:"Create",children:(0,u.jsx)(ct,{store:o,actionCompleted:ht,actionFailed:Ct,forActionType:Tt,msgOnNotSelect:vt,msgOnIsEmptyName:jt,onCreate:dt,onClose:n})}),(0,u.jsx)(D.Z,{title:"Rename",children:(0,u.jsx)(lt,{store:o,actionCompleted:ht,actionFailed:Ct,forActionType:gt,msgOnNotSelect:vt,msgOnIsEmptyName:jt,onRename:mt,onClose:n})}),(0,u.jsx)(D.Z,{title:"Delete",children:(0,u.jsx)(pt,{store:o,actionCompleted:ht,actionFailed:Ct,forActionType:xt,msgOnNotSelect:vt,onDelete:ft,onClose:n})})]})})}),St)}}}]);