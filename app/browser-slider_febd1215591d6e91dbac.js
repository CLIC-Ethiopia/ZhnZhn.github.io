(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[30],{817:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var s=r(9679),i=r(795),n=r(8685),o=r(6462),l=r(2038);const a={dialogConf:!0,dialogType:"DialogStatN",dialogProps:{chartsType:"t2a",dfProps:{},isProxy:!0}},c=e=>{const t=e.text||"",r=t.length>35?t.substring(0,35)+"...":t;return{menuTitle:t.substring(0,27),contFullCaption:e.sP+": "+r}},d=e=>()=>{const{rootUrl:t,id:r,proxy:s,bT:i,lT:n,dU:o,noTime:d,dS:p}=e,h=(({rootUrl:e,id:t,proxy:r})=>{const s=e+"/"+t;return r?""+r+s:s})(e),u=Object.assign({},a,{type:i+"_"+r,...c(e)});Object.assign(u.dialogProps,{loadId:n,descrUrl:o,dataSource:p,dfProps:{metaUrl:h,baseMeta:t,dfId:r,proxy:s,noTime:d}}),l.Z.showDialog(i+"_"+r,i,u)},p=(e,t)=>e.text<t.text?-1:e.text>t.text?1:0,h=(e,t)=>fetch(t?t+e:e,{cache:"default"}).then((e=>e.json())).then((e=>(Array.isArray(e)&&e.sort(p),e)));var u=r(2306);const f={MSG_ERR:{paddingLeft:"12px",color:"#f44336",fontFamily:'Roboto, "Arial Unicode MS", Arial, sans-serif',fontWeight:"bold",fontSize:"16px"},TITLE:{position:"relative",color:"silver",paddingLeft:"32px",paddingTop:"8px",paddingBottom:"4px",fontFamily:'Roboto, "Arial Unicode MS", Arial, sans-serif',fontWeight:"bold",fontSize:"16px",cursor:"pointer"},TITLE_ARROW:{position:"absolute",top:"8px",left:"16px"},ITEM_L:{color:"#1b2836",fontFamily:'Roboto, "Arial Unicode MS", Arial, sans-serif',fontWeight:"bold",fontSize:"16px",padding:"8px",paddingLeft:"12px",cursor:"pointer"},ITEM_T:{color:"black",fontFamily:'Roboto, "Arial Unicode MS", Arial, sans-serif',fontWeight:"bold",fontSize:"16px",padding:"8px",cursor:"pointer"}};var g=r(5893);const x="menu-item",m=({innerRef:e,title:t,onClick:r})=>(0,g.jsxs)("div",{ref:e,className:x,style:f.TITLE,role:"menuitem",tabIndex:"0",onClick:r,onKeyDown:e=>{(0,u.Z)(e)&&(e.preventDefault(),r())},children:[t,(0,g.jsx)("span",{style:f.TITLE_ARROW,children:"<"})]});var C=r(2554);const y="menu-item",P=({innerRef:e,item:t,onClick:r})=>{const{text:i,type:n}=t,o="l"===n?f.ITEM_L:f.ITEM_T,l=(0,s.useCallback)((e=>{(0,u.Z)(e)&&(e.preventDefault(),r())}),[r]);return(0,g.jsx)("div",{ref:e,className:y,style:o,tabIndex:"0",role:"menuitem",onClick:r,onKeyDown:l,children:i})},b=(0,s.memo)((({refFirstItem:e,model:t=[],fOnClickItem:r})=>(0,g.jsx)("div",{children:t.map(((t,s)=>(0,g.jsx)(P,{innerRef:0===s?e:void 0,item:t,onClick:r(t)},t.id)))}))),_=({errMsg:e})=>e?(0,g.jsx)("div",{style:f.MSG_ERR,children:e}):null,T=({refFirstItem:e,model:t,fOnClickItem:r,errMsg:s})=>(0,g.jsxs)(g.Fragment,{children:[!(t||s)&&(0,g.jsx)(C.Z,{}),(0,g.jsx)(b,{refFirstItem:e,model:t,fOnClickItem:r}),(0,g.jsx)(_,{errMsg:s})]}),I=Array.isArray,R=(e,t,r,s,i,n,o)=>{const{text:l,id:a,type:c}=o;return"l"===c?i.bind(null,t+"/"+a,l,s):n({id:t+"/"+a,...r,text:l,proxy:e})},k=({style:e,store:t,title:r,id:i="",dfProps:n={},pageNumber:o,pageCurrent:l,onClickPrev:a,onClickNext:c,fOnClickItem:d,loadItems:p})=>{const h=(0,s.useRef)(),u=(0,s.useRef)(),[f,x]=(0,s.useState)({}),{model:C,errMsg:y}=f,P=((e,t)=>e.getProxy(t.lT))(t,n),b=(0,s.useCallback)(R.bind(null,P,i,n,o,c,d),[P]),_=r&&a,k=o===l&&(_||!_&&C);return(0,s.useEffect)((()=>(r&&p(n.rootUrl+"/"+i,P).then((e=>{const t=I(e)?{model:e}:{errMsg:"Response is not array"};x(t)})).catch((e=>x({errMsg:e.message}))),()=>{clearTimeout(u.current),h.current=null})),[]),(0,s.useEffect)((()=>{k&&(clearTimeout(u.current),u.current=setTimeout((()=>{const e=h.current;e&&e.focus()}),1e3))}),[k]),(0,g.jsxs)("div",{style:e,children:[_&&(0,g.jsx)(m,{innerRef:h,title:r,onClick:a.bind(null,o)}),(0,g.jsx)(T,{refFirstItem:_?void 0:h,model:C,fOnClickItem:b,errMsg:y})]})},S=({pages:e,pageCurrent:t})=>e.map(((e,r)=>(0,s.cloneElement)(e,{pageCurrent:t,pageNumber:r+1}))),j={ROOT:{width:300,overflow:"hidden"},PAGES:{width:1500,overflowX:"hidden",display:"flex",flexFlow:"row nowrap",alignItems:"flex-start",transition:"all 750ms ease-out"},PAGE:{width:300}},v=e=>{const t=e.style.transform.substring(11).replace("px","").replace(")","");return parseInt(t,10)};class M extends s.Component{constructor(e){super(e),this.hPrevPage=e=>{this.setState((({pageCurrent:t})=>0===t||t!==e?null:(this._direction=-1,{pageCurrent:e-1})))},this._addPage=(e,t,r)=>{const{dfProps:s,store:i}=this.props;e.push((0,g.jsx)(k,{id:t,style:j.PAGE,store:i,title:r,dfProps:s,onClickPrev:this.hPrevPage,onClickNext:this.hNextPage,loadItems:h,fOnClickItem:d},t))},this.hNextPage=(e,t,r)=>{this.setState((({pageCurrent:s,pages:i})=>r!==s?null:(r<i.length?i[r]&&i[r].key!==e&&(r>0?i.splice(r):i=[],this._addPage(i,e,t)):this._addPage(i,e,t),this._direction=1,{pages:i,pageCurrent:r+1})))},this._crTransform=()=>{let e="0";const t=this._refMenu.current;if(0!==this._direction&&t){const r=v(t);e=1===this._direction?r-300:r+300,this._direction=0}else 0===this._direction&&t&&(e=v(t));return{transform:"translateX("+e+"px)"}},this.hNextPage=(0,o.Z)(this.hNextPage.bind(this)),this.hPrevPage=(0,o.Z)(this.hPrevPage.bind(this)),this._refMenu=(0,s.createRef)(),this._direction=0,this._fOnClickItem=({id:e,text:t})=>this.hNextPage.bind(null,e,t,0),this.state={pageCurrent:0,pages:[]}}render(){const{dfProps:e,store:t}=this.props,{pages:r,pageCurrent:s}=this.state,i=this._crTransform(),n={...j.PAGES,...i};return(0,g.jsx)("div",{style:j.ROOT,children:(0,g.jsxs)("div",{ref:this._refMenu,style:n,children:[(0,g.jsx)(k,{style:j.PAGE,title:"Main Menu",store:t,dfProps:e,pageCurrent:s,pageNumber:0,onClickNext:this.hNextPage,loadItems:h,fOnClickItem:d}),(0,g.jsx)(S,{pages:r,pageCurrent:s})]})})}}const A=M,E={BROWSER:{paddingRight:0},SCROLL_PANE:{height:"92%"}},w=(0,s.memo)((e=>{const{isInitShow:t,caption:r,store:o,browserType:l,showAction:a}=e,[c,d]=(0,s.useState)(!!t),p=(0,s.useCallback)((()=>{d(!1)}),[]);return(0,i.Z)(o,((e,t)=>{e===a&&t===l&&d(!0)})),(0,g.jsxs)(n.Z.Browser,{isShow:c,style:E.BROWSER,children:[(0,g.jsx)(n.Z.BrowserCaption,{caption:r,onClose:p}),(0,g.jsx)(n.Z.ScrollPane,{className:"scroll-container-y",style:E.SCROLL_PANE,children:(0,g.jsx)(A,{...e})})]})}))}}]);