"use strict";(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[437],{7147:(t,e,o)=>{o.r(e),o.d(e,{default:()=>wt});var n,s,i,a=o(1721),r=o(9679),c=o(1398),u=o(7020),l=o(7933),p=o(3014),d=o(6485),m=o(5138),f=o(4827),h=o(2276),C=o(837),g=o(5893),x=c.Z.getFromDate,T=c.Z.getToDate,j=c.Z.isYmd,v=c.Z.mlsToDmy,S={width:365},y={width:265},w={display:"inline-block",maxWidth:250,height:32,verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden"};const Z=(0,C.Z.dialog)((i=s=function(t){function e(e){var o;(o=t.call(this,e)||this)._handleLoad=function(){var t=o._createValidationMessages();if(t.isValid){var e=o.props,n=e.data,s=e.onClose,i=n.id,a=n.title,r=n.subtitle,c=n.caption,u=n.columnName,m=n.dataColumn,f=n.seriaColumnNames,h=n.itemConf,C=void 0===h?{}:h,g=o.datesFragment.getValues(),x=g.fromDate,T=g.toDate,j=Object.assign({id:i,title:a,subtitle:r,value:c,item:c,fromDate:x,toDate:T,columnName:u,dataColumn:m,seriaColumnNames:f,loadId:C.loadId||p.L2.WL},C);l.ZP[l.SX]({chartType:d.Z.WATCH_LIST,browserType:p.Aq.WATCH_LIST},j),s()}o._updateValidationMessages(t)},o._createValidationMessages=function(){var t=[],e=o.datesFragment.getValidation(),n=e.isValid,s=e.datesMsg;return n||(t=t.concat(s)),t.isValid=0===t.length,t},o._handleClose=function(){o._handleWithValidationClose(o._createValidationMessages),o.props.onClose()},o._refDates=function(t){return o.datesFragment=t};var n=e.data,s=n.fromDate,i=n.initToDate,a=n.onTestDate,r=n.itemConf,c=!!(void 0===r?{}:r).x;return o.toolbarButtons=o._createType2WithToolbar(e,{isValue:c}),o._commandButtons=[(0,g.jsx)(f.Z.Button.Load,{onClick:o._handleLoad},"load")],o.state=Object.assign({},o._isWithInitialState(),{isShowDate:!1,isValue:c,initFromDate:s||x(2),initToDate:i||T(),onTestDate:a||j}),o}(0,a.Z)(e,t);var o=e.prototype;return o.shouldComponentUpdate=function(t,e){return t===this.props||t.isShow!==this.props.isShow},o.render=function(){var t=this.props,e=t.isShow,o=t.data,n=o.caption,s=o.itemConf,i=void 0===s?{}:s,a=i.dataSource,r=i.x,c=i.y,l=this.state,p=l.isShowLabels,d=l.isShowDate,C=l.isValue,x=l.initFromDate,T=l.initToDate,j=l.onTestDate,Z=l.validationMessages,L=p?S:y,D=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),((0,u.Z)(e)+" "+v(t)).trim()}(r,c);return(0,g.jsxs)(m.Z,{style:L,isShow:e,caption:"Load Item",commandButtons:this._commandButtons,onClose:this._handleClose,children:[(0,g.jsx)(f.Z.Toolbar,{isShow:!0,buttons:this.toolbarButtons}),(0,g.jsx)(f.Z.Row.Text,{isShowLabels:p,styleText:w,caption:"Item:",text:n}),(0,g.jsx)(f.Z.ShowHide,{isShow:C,children:(0,g.jsx)(f.Z.Row.Text,{isShowLabels:p,styleText:w,caption:"Value:",text:D})}),(0,g.jsx)(f.Z.ShowHide,{isShow:d,children:(0,g.jsx)(f.Z.DatesFragment,{ref:this._refDates,isShowLabels:p,initFromDate:x,initToDate:T,onTestDate:j})}),(0,g.jsx)(f.Z.Row.Text,{isShowLabels:p,styleText:w,caption:"Source:",text:a}),(0,g.jsx)(h.Z,{validationMessages:Z})]})},e}(r.Component),s.defaultProps={data:{}},n=i))||n;var L=o(3218),D=o(2125),I=o(5854),R=o(3297),O=o(795),G=o(5313),A=o(7376),E={ROW:Object.assign({},A.Z.ROW,{lineHeight:2}),CAPTION:Object.assign({},A.Z.CAPTION,{width:120}),INPUT_TEXT:{width:250,height:30,paddingLeft:10,marginLeft:0,marginRight:0}};const N=(0,r.forwardRef)((function(t,e){var o=t.caption;return(0,g.jsxs)("div",{style:E.ROW,children:[(0,g.jsx)("span",{style:E.CAPTION,children:o}),(0,g.jsx)(G.Z,{ref:e,style:E.INPUT_TEXT})]})}));var _=o(6614),b={CAPTION:Object.assign({},A.Z.CAPTION,{width:120})};const V=function(t){var e=t.caption,o=t.options,n=t.onSelect;return(0,g.jsxs)("div",{style:A.Z.ROW,children:[(0,g.jsx)("span",{style:b.CAPTION,children:e}),(0,g.jsx)(_.Z,{width:"250",options:o,onSelect:n})]})};var M=o(5868);const W=function(){var t=(0,r.useRef)(),e=(0,r.useCallback)((function(e){var o=(e||{}).caption;t.current=o}),[]);return[t,e]};const P=(0,r.forwardRef)((function(t,e){var o=(0,M.Z)(t),n=o[0],s=o[1],i=t.store,a=t.groupCaption,c=t.groupOptions,u=t.listCaption,l=(0,r.useRef)(),p=W(),d=p[0],m=p[1],f=(0,r.useState)([]),h=f[0],C=f[1],x=(0,r.useCallback)((function(t){var e=(t||{}).caption;t&&e?(l.current=e,d.current=null,C(t.lists||[])):l.current=null}),[]);return(0,r.useEffect)((function(){var e=s();if(e!==t){if(e.groupOptions!==c)l.current=null,d.current=null,C([]);else if(l.current){var o=i.getWatchListsByGroup(l.current);o!==h&&(d.current=null,C(o))}n(t)}}),[t]),(0,r.useImperativeHandle)(e,(function(){return{getValue:function(){return{captionGroup:l.current,captionList:d.current}}}})),(0,g.jsxs)("div",{children:[(0,g.jsx)(V,{caption:a,options:c,onSelect:x}),(0,g.jsx)(V,{caption:u,options:h,onSelect:m})]})}));var F=o(481);const B={COMMAND_DIV:{cursor:"default",float:"right",marginTop:"8px",marginBottom:"10px",marginRight:"4px"}};const k=function(t){var e=t.Primary,o=t.withoutClear,n=t.onClear,s=t.onClose;return(0,g.jsxs)("div",{style:B.COMMAND_DIV,children:[e,!o&&(0,g.jsx)(F.Z.Clear,{onClick:n}),(0,g.jsx)(F.Z.Close,{onClick:s})]})};const H={RowInputText:N,RowInputSelect:V,SelectGroupList:P,Button:F.Z,RowButtons:k,ValidationMessages:h.Z};const J=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onCreate,a=t.msgOnIsEmptyName,c=t.onClose,u=(0,r.useRef)(),l=(0,r.useState)([]),p=l[0],d=l[1],m=function(t,e,o,n){return(0,g.jsx)(H.Button.Primary,{caption:"Create",title:"Create New Group",onClick:function(){var s=t.current.getValue();s?o({caption:s}):(t.current.setValue(""),e([n("Group")]))}})}(u,d,i,a),f=function(){u.current.setValue(""),d([])};return(0,O.Z)(e,(function(t,e){t===o&&e.forActionType===s?f():t===n&&e.forActionType===s&&d(e.messages)})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.RowInputText,{ref:u,caption:"Group:"}),(0,g.jsx)(H.ValidationMessages,{validationMessages:p}),(0,g.jsx)(H.RowButtons,{Primary:m,onClear:f,onClose:c})]})};const U=function(t){var e=(0,r.useRef)(),o=(0,r.useCallback)((function(){var o=e.current;o&&(o.setValue(""),t([]))}),[]);return[e,o]};const X=function(t){var e=t.store,o=t.actionCompleted,n=t.actionFailed,s=t.forActionType,i=t.onRename,a=t.msgOnNotSelect,c=t.msgOnIsEmptyName,u=t.onClose,l=(0,r.useState)((function(){return e.getWatchGroups()})),p=l[0],d=l[1],m=(0,r.useState)([]),f=m[0],h=m[1],C=U(h),x=C[0],T=C[1],j=W(),v=j[0],S=j[1],y=(0,r.useCallback)((function(){var t=x.current.getValue(),e=v.current;if(t&&e)i({captionFrom:e,captionTo:t});else{var o=[];e||o.push(a("Group From")),t||o.push(c("Group To")),h(o)}}),[]),w=(0,r.useMemo)((function(){return(0,g.jsx)(H.Button.Primary,{caption:"Edit",title:"Edit Group Name",onClick:y})}),[y]);return(0,O.Z)(e,(function(t,i){t===o?(i.forActionType===s&&T(),d(e.getWatchGroups())):t===n&&i.forActionType===s&&h(i.messages)})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.RowInputSelect,{caption:"Group From:",options:p,onSelect:S}),(0,g.jsx)(H.RowInputText,{ref:x,caption:"Group To:"}),(0,g.jsx)(H.ValidationMessages,{validationMessages:f}),(0,g.jsx)(H.RowButtons,{Primary:w,onClear:T,onClose:u})]})};var q=function(t){return{groups:t.getWatchGroups,errs:[]}},Y=function(t,e){return{type:t,payload:e}},z=function(t,e){var o=e.type,n=e.payload;switch(o){case"a":return{groups:n,errs:[]};case"b":return Object.assign({},t,{errs:n});default:return t}};const K=function(t){var e=t.store,o=t.actionCompleted,n=(t.forActionType,t.onDelete),s=t.msgOnNotSelect,i=t.onClose,a=(0,r.useRef)(null),c=function(t,e){var o=(0,r.useReducer)(z,t,q),n=o[0],s=n.groups,i=n.errs,a=o[1];return[s,i,function(t){return a(Y("a",t))},function(){return a(Y("b",[e("Group")]))}]}(e,s),u=c[0],l=c[1],p=c[2],d=c[3],m=function(t,e,o){return(0,g.jsx)(H.Button.Primary,{caption:"Delete",title:"Delete Group",onClick:function(){var n=t.current;n?(e({caption:n}),t.current=null):o()}})}(a,n,d);return(0,O.Z)(e,(function(t,n){t===o&&p(e.getWatchGroups())})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.RowInputSelect,{caption:"Group:",options:u,onSelect:function(t){a.current=t&&t.caption||null}}),(0,g.jsx)(H.ValidationMessages,{validationMessages:l}),(0,g.jsx)(H.RowButtons,{Primary:m,withoutClear:!0,onClose:i})]})};var Q=L.Z.addGroup,$=L.Z.renameGroup,tt=L.Z.deleteGroup,et=L.J.EDIT_WATCH_COMPLETED,ot=L.J.EDIT_WATCH_FAILED,nt=L.J.ADD_GROUP,st=L.J.RENAME_GROUP,it=L.J.DELETE_GROUP,at=D.Z.notSelected,rt=D.Z.emptyName,ct=function(t,e){return t.isShow===e.isShow};const ut=(0,r.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,g.jsx)(m.Z,{caption:"Watch Groups Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,g.jsxs)(I.Z,{width:380,children:[(0,g.jsx)(R.Z,{title:"Create",children:(0,g.jsx)(J,{store:o,actionCompleted:et,actionFailed:ot,forActionType:nt,msgOnIsEmptyName:rt,onCreate:Q,onClose:n})}),(0,g.jsx)(R.Z,{title:"Rename",children:(0,g.jsx)(X,{store:o,actionCompleted:et,actionFailed:ot,forActionType:st,msgOnNotSelect:at,msgOnIsEmptyName:rt,onRename:$,onClose:n})}),(0,g.jsx)(R.Z,{title:"Delete",children:(0,g.jsx)(K,{store:o,actionCompleted:et,forActionType:it,msgOnNotSelect:at,onDelete:tt,onClose:n})})]})})}),ct);const lt=function(t){var e=t.store,o=t.onCreate,n=t.msgOnNotSelect,s=t.msgOnIsEmptyName,i=t.actionCompleted,a=t.actionFailed,c=t.forActionType,u=t.onClose,l=(0,r.useState)((function(){return e.getWatchGroups()})),p=l[0],d=l[1],m=(0,r.useState)([]),f=m[0],h=m[1],C=U(h),x=C[0],T=C[1],j=W(),v=j[0],S=j[1],y=(0,r.useCallback)((function(){var t=x.current.getValue(),e=v.current;if(e&&t)o({captionGroup:e,captionList:t});else{var i=[];e||i.push(n("In Group")),t||i.push(s("List")),h(i)}}),[]),w=(0,r.useMemo)((function(){return(0,g.jsx)(H.Button.Primary,{caption:"Create",title:"Create New List",onClick:y})}),[y]);return(0,O.Z)(e,(function(t,o){t===i?(o.forActionType===c&&T(),d(e.getWatchGroups())):t===a&&o.forActionType===c&&h(o.messages)})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.RowInputSelect,{caption:"In Group:",options:p,onSelect:S}),(0,g.jsx)(H.RowInputText,{ref:x,caption:"List:"}),(0,g.jsx)(H.ValidationMessages,{validationMessages:f}),(0,g.jsx)(H.RowButtons,{Primary:w,onClear:T,onClose:u})]})};const pt=function(t){var e=t.store,o=t.onRename,n=t.msgOnIsEmptyName,s=t.msgOnNotSelect,i=t.actionCompleted,a=t.actionFailed,c=t.forActionType,u=t.onClose,l=(0,r.useState)((function(){return e.getWatchGroups()})),p=l[0],d=l[1],m=(0,r.useState)([]),f=m[0],h=m[1],C=(0,r.useRef)(),x=U(h),T=x[0],j=x[1],v=(0,r.useCallback)((function(){var t=C.current.getValue(),e=t.captionGroup,i=t.captionList,a=T.current.getValue();if(e&&i&&a)o({captionGroup:e,captionListFrom:i,captionListTo:a});else{var r=[];e||r.push(s("Group")),i||r.push(s("List From")),a||r.push(n("List To")),h(r)}}),[]),S=(0,r.useMemo)((function(){return(0,g.jsx)(H.Button.Primary,{caption:"Edit",title:"Edit List Name",onClick:v})}),[v]);return(0,O.Z)(e,(function(t,o){t===i?(o.forActionType===c&&j(),d(e.getWatchGroups())):t===a&&o.forActionType===c&&h(o.messages)})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.SelectGroupList,{ref:C,store:e,groupCaption:"In Group:",groupOptions:p,listCaption:"List From:"}),(0,g.jsx)(H.RowInputText,{ref:T,caption:"List To:"}),(0,g.jsx)(H.ValidationMessages,{validationMessages:f}),(0,g.jsx)(H.RowButtons,{Primary:S,onClear:j,onClose:u})]})};const dt=function(t){var e=t.store,o=t.actionCompleted,n=t.forActionType,s=t.onDelete,i=t.msgOnNotSelect,a=t.onClose,c=(0,r.useState)((function(){return e.getWatchGroups()})),u=c[0],l=c[1],p=(0,r.useState)([]),d=p[0],m=p[1],f=(0,r.useRef)(),h=(0,r.useCallback)((function(){return m([])}),[]),C=(0,r.useCallback)((function(){var t=f.current.getValue(),e=t.captionGroup,o=t.captionList;if(e&&o)s({captionGroup:e,captionList:o});else{var n=[];e||n.push(i("Group")),o||n.push(i("List")),m(n)}}),[]),x=(0,r.useMemo)((function(){return(0,g.jsx)(H.Button.Primary,{caption:"Delete",title:"Delete List",onClick:C})}),[C]);return(0,O.Z)(e,(function(t,s){t===o&&(s.forActionType===n&&h(),l(e.getWatchGroups()))})),(0,g.jsxs)("div",{children:[(0,g.jsx)(H.SelectGroupList,{ref:f,store:e,groupCaption:"In Group:",groupOptions:u,listCaption:"List:"}),(0,g.jsx)(H.ValidationMessages,{validationMessages:d}),(0,g.jsx)(H.RowButtons,{Primary:x,onClear:h,onClose:a})]})};var mt=L.Z.createList,ft=L.Z.renameList,ht=L.Z.deleteList,Ct=L.J.EDIT_WATCH_COMPLETED,gt=L.J.EDIT_WATCH_FAILED,xt=L.J.CREATE_LIST,Tt=L.J.RENAME_LIST,jt=L.J.DELETE_LIST,vt=D.Z.notSelected,St=D.Z.emptyName,yt=function(t,e){return t.isShow===e.isShow};const wt={LoadItem:Z,EditGroup:ut,EditList:(0,r.memo)((function(t){var e=t.isShow,o=t.store,n=t.onClose;return(0,g.jsx)(m.Z,{caption:"Watch Lists Edit",isShow:e,isWithButton:!1,onClose:n,children:(0,g.jsxs)(I.Z,{width:380,children:[(0,g.jsx)(R.Z,{title:"Create",children:(0,g.jsx)(lt,{store:o,actionCompleted:Ct,actionFailed:gt,forActionType:xt,msgOnNotSelect:vt,msgOnIsEmptyName:St,onCreate:mt,onClose:n})}),(0,g.jsx)(R.Z,{title:"Rename",children:(0,g.jsx)(pt,{store:o,actionCompleted:Ct,actionFailed:gt,forActionType:Tt,msgOnNotSelect:vt,msgOnIsEmptyName:St,onRename:ft,onClose:n})}),(0,g.jsx)(R.Z,{title:"Delete",children:(0,g.jsx)(dt,{store:o,actionCompleted:Ct,actionFailed:gt,forActionType:jt,msgOnNotSelect:vt,onDelete:ht,onClose:n})})]})})}),yt)}}}]);