"use strict";(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[437],{7147:(t,e,o)=>{o.r(e),o.d(e,{default:()=>it});var s,n,i,a=o(9679),r=o(1398),l=o(7020),c=o(6519),u=o(3115),p=o(4485),d=o(5138),h=o(4827),m=o(2276),C=o(837),x=o(5893);const g={width:365},f={width:265},j={display:"inline-block",maxWidth:250,height:32,verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden"};const T=(0,C.Z.dialog)((i=n=class extends a.Component{constructor(t){super(t),this._handleLoad=()=>{const t=this._createValidationMessages();if(t.isValid){const{data:t,onClose:e}=this.props,{id:o,title:s,subtitle:n,caption:i,columnName:a,dataColumn:r,seriaColumnNames:l,itemConf:d={}}=t,{fromDate:h,toDate:m}=this.datesFragment.getValues(),C={id:o,title:s,subtitle:n,value:i,item:i,fromDate:h,toDate:m,columnName:a,dataColumn:r,seriaColumnNames:l,loadId:d.loadId||u.O8,...d};c.ZP[c.SX]({chartType:u.e9,browserType:p.lx},C),e()}this._updateValidationMessages(t)},this._createValidationMessages=()=>{let t=[];const{isValid:e,datesMsg:o}=this.datesFragment.getValidation();return e||(t=t.concat(o)),t.isValid=0===t.length,t},this._handleClose=()=>{this._handleWithValidationClose(this._createValidationMessages),this.props.onClose()},this._refDates=t=>this.datesFragment=t;const{fromDate:e,initToDate:o,onTestDate:s,itemConf:n={}}=t.data,i=!!n.x;this.toolbarButtons=this._createType2WithToolbar(t,{isValue:i}),this._commandButtons=[(0,x.jsx)(h.Z.Button.Load,{onClick:this._handleLoad},"load")],this.state={...this._isWithInitialState(),isShowDate:!1,isValue:i,initFromDate:e||(0,r.QS)(2),initToDate:o||(0,r.TP)(),onTestDate:s||r.RB}}shouldComponentUpdate(t,e){return t===this.props||t.isShow!==this.props.isShow}render(){const{isShow:t,data:e}=this.props,{caption:o,itemConf:s={}}=e,{dataSource:n,x:i,y:a}=s,{isShowLabels:c,isShowDate:u,isValue:p,initFromDate:C,initToDate:T,onTestDate:w,validationMessages:S}=this.state,y=c?g:f,R=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),((0,l.Z)(e)+" "+(0,r.P9)(t)).trim()}(i,a);return(0,x.jsxs)(d.Z,{style:y,isShow:t,caption:"Load Item",commandButtons:this._commandButtons,onClose:this._handleClose,children:[(0,x.jsx)(h.Z.Toolbar,{isShow:!0,buttons:this.toolbarButtons}),(0,x.jsx)(h.Z.Row.Text,{isShowLabels:c,styleText:j,caption:"Item:",text:o}),(0,x.jsx)(h.Z.ShowHide,{isShow:p,children:(0,x.jsx)(h.Z.Row.Text,{isShowLabels:c,styleText:j,caption:"Value:",text:R})}),(0,x.jsx)(h.Z.ShowHide,{isShow:u,children:(0,x.jsx)(h.Z.DatesFragment,{ref:this._refDates,isShowLabels:c,initFromDate:C,initToDate:T,onTestDate:w})}),(0,x.jsx)(h.Z.Row.Text,{isShowLabels:c,styleText:j,caption:"Source:",text:n}),(0,x.jsx)(m.Z,{validationMessages:S})]})}},n.defaultProps={data:{}},s=i))||s;var w=o(3218),S=o(2125),y=o(5854),R=o(3297),Z=o(795),G=o(5313),I=o(7376);const N={ROW:{...I.Z.ROW,lineHeight:2},CAPTION:{...I.Z.CAPTION,width:120},INPUT_TEXT:{width:250,height:30,paddingLeft:10,marginLeft:0,marginRight:0}},L=(0,a.forwardRef)(((t,e)=>{let{caption:o}=t;return(0,x.jsxs)("div",{style:N.ROW,children:[(0,x.jsx)("span",{style:N.CAPTION,children:o}),(0,x.jsx)(G.Z,{ref:e,style:N.INPUT_TEXT})]})}));var O=o(6614);const D={CAPTION:{...I.Z.CAPTION,width:120}},b=t=>{let{caption:e,options:o,onSelect:s}=t;return(0,x.jsxs)("div",{style:I.Z.ROW,children:[(0,x.jsx)("span",{style:D.CAPTION,children:e}),(0,x.jsx)(O.Z,{width:"250",options:o,onSelect:s})]})};var V=o(5868);const v=()=>{const t=(0,a.useRef)(),e=(0,a.useCallback)((e=>{const{caption:o}=e||{};t.current=o}),[]);return[t,e]},A=(0,a.forwardRef)(((t,e)=>{const[o,s]=(0,V.Z)(t),{store:n,groupCaption:i,groupOptions:r,listCaption:l}=t,c=(0,a.useRef)(),[u,p]=v(),[d,h]=(0,a.useState)([]),m=(0,a.useCallback)((t=>{const{caption:e}=t||{};t&&e?(c.current=e,u.current=null,h(t.lists||[])):c.current=null}),[]);return(0,a.useEffect)((()=>{const e=s();if(e!==t){if(e.groupOptions!==r)c.current=null,u.current=null,h([]);else if(c.current){const t=n.getWatchListsByGroup(c.current);t!==d&&(u.current=null,h(t))}o(t)}}),[t]),(0,a.useImperativeHandle)(e,(()=>({getValue:()=>({captionGroup:c.current,captionList:u.current})}))),(0,x.jsxs)("div",{children:[(0,x.jsx)(b,{caption:i,options:r,onSelect:m}),(0,x.jsx)(b,{caption:l,options:d,onSelect:p})]})}));var M=o(481);const W={COMMAND_DIV:{cursor:"default",float:"right",marginTop:"8px",marginBottom:"10px",marginRight:"4px"}},B=t=>{let{Primary:e,withoutClear:o,onClear:s,onClose:n}=t;return(0,x.jsxs)("div",{style:W.COMMAND_DIV,children:[e,!o&&(0,x.jsx)(M.Z.Clear,{onClick:s}),(0,x.jsx)(M.Z.Close,{onClick:n})]})},P={RowInputText:L,RowInputSelect:b,SelectGroupList:A,Button:M.Z,RowButtons:B,ValidationMessages:m.Z},_=t=>{let{actionCompleted:e,actionFailed:o,forActionType:s,onCreate:n,msgOnIsEmptyName:i,onClose:r}=t;const l=(0,a.useRef)(),[c,u]=(0,a.useState)([]),p=((t,e,o,s)=>(0,x.jsx)(P.Button.Primary,{caption:"Create",title:"Create New Group",onClick:()=>{const n=t.current.getValue();n?o({caption:n}):(t.current.setValue(""),e([s("Group")]))}}))(l,u,n,i),d=()=>{l.current.setValue(""),u([])};return(0,Z.Z)(((t,n)=>{t===e&&n.forActionType===s?d():t===o&&n.forActionType===s&&u(n.messages)})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.RowInputText,{ref:l,caption:"Group:"}),(0,x.jsx)(P.ValidationMessages,{validationMessages:c}),(0,x.jsx)(P.RowButtons,{Primary:p,onClear:d,onClose:r})]})},k=t=>{const e=(0,a.useRef)(),o=(0,a.useCallback)((()=>{const{current:o}=e;o&&(o.setValue(""),t([]))}),[]);return[e,o]},F=t=>{let{store:e,actionCompleted:o,actionFailed:s,forActionType:n,onRename:i,msgOnNotSelect:r,msgOnIsEmptyName:l,onClose:c}=t;const[u,p]=(0,a.useState)((()=>e.getWatchGroups())),[d,h]=(0,a.useState)([]),[m,C]=k(h),[g,f]=v(),j=(0,a.useCallback)((()=>{const t=m.current.getValue(),e=g.current;if(t&&e)i({captionFrom:e,captionTo:t});else{const o=[];e||o.push(r("Group From")),t||o.push(l("Group To")),h(o)}}),[]),T=(0,a.useMemo)((()=>(0,x.jsx)(P.Button.Primary,{caption:"Edit",title:"Edit Group Name",onClick:j})),[j]);return(0,Z.Z)(((t,i)=>{t===o?(i.forActionType===n&&C(),p(e.getWatchGroups())):t===s&&i.forActionType===n&&h(i.messages)})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.RowInputSelect,{caption:"Group From:",options:u,onSelect:f}),(0,x.jsx)(P.RowInputText,{ref:m,caption:"Group To:"}),(0,x.jsx)(P.ValidationMessages,{validationMessages:d}),(0,x.jsx)(P.RowButtons,{Primary:T,onClear:C,onClose:c})]})},E=t=>({groups:t.getWatchGroups,errs:[]}),$=(t,e)=>({type:t,payload:e}),H=(t,e)=>{let{type:o,payload:s}=e;switch(o){case"a":return{groups:s,errs:[]};case"b":return{...t,errs:s};default:return t}},U=t=>{let{store:e,actionCompleted:o,forActionType:s,onDelete:n,msgOnNotSelect:i,onClose:r}=t;const l=(0,a.useRef)(null),[c,u,p,d]=((t,e)=>{const[{groups:o,errs:s},n]=(0,a.useReducer)(H,t,E);return[o,s,t=>n($("a",t)),()=>n($("b",[e("Group")]))]})(e,i),h=((t,e,o)=>(0,x.jsx)(P.Button.Primary,{caption:"Delete",title:"Delete Group",onClick:()=>{const{current:s}=t;s?(e({caption:s}),t.current=null):o()}}))(l,n,d);return(0,Z.Z)(((t,s)=>{t===o&&p(e.getWatchGroups())})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.RowInputSelect,{caption:"Group:",options:c,onSelect:t=>{l.current=t&&t.caption||null}}),(0,x.jsx)(P.ValidationMessages,{validationMessages:u}),(0,x.jsx)(P.RowButtons,{Primary:h,withoutClear:!0,onClose:r})]})},X=w.e4[w.R2],Q=w.e4[w.Bv],q=w.e4[w.E2],z=(t,e)=>t.isShow===e.isShow,J=(0,a.memo)((t=>{let{isShow:e,store:o,onClose:s}=t;return(0,x.jsx)(d.Z,{caption:"Watch Groups Edit",isShow:e,isWithButton:!1,onClose:s,children:(0,x.jsxs)(y.Z,{width:380,children:[(0,x.jsx)(R.Z,{title:"Create",children:(0,x.jsx)(_,{store:o,actionCompleted:w.$0,actionFailed:w.db,forActionType:w.R2,msgOnIsEmptyName:S.eT,onCreate:X,onClose:s})}),(0,x.jsx)(R.Z,{title:"Rename",children:(0,x.jsx)(F,{store:o,actionCompleted:w.$0,actionFailed:w.db,forActionType:w.Bv,msgOnNotSelect:S.xW,msgOnIsEmptyName:S.eT,onRename:Q,onClose:s})}),(0,x.jsx)(R.Z,{title:"Delete",children:(0,x.jsx)(U,{store:o,actionCompleted:w.$0,forActionType:w.E2,msgOnNotSelect:S.xW,onDelete:q,onClose:s})})]})})}),z),K=t=>{let{store:e,onCreate:o,msgOnNotSelect:s,msgOnIsEmptyName:n,actionCompleted:i,actionFailed:r,forActionType:l,onClose:c}=t;const[u,p]=(0,a.useState)((()=>e.getWatchGroups())),[d,h]=(0,a.useState)([]),[m,C]=k(h),[g,f]=v(),j=(0,a.useCallback)((()=>{const t=m.current.getValue(),e=g.current;if(e&&t)o({captionGroup:e,captionList:t});else{const o=[];e||o.push(s("In Group")),t||o.push(n("List")),h(o)}}),[]),T=(0,a.useMemo)((()=>(0,x.jsx)(P.Button.Primary,{caption:"Create",title:"Create New List",onClick:j})),[j]);return(0,Z.Z)(((t,o)=>{t===i?(o.forActionType===l&&C(),p(e.getWatchGroups())):t===r&&o.forActionType===l&&h(o.messages)})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.RowInputSelect,{caption:"In Group:",options:u,onSelect:f}),(0,x.jsx)(P.RowInputText,{ref:m,caption:"List:"}),(0,x.jsx)(P.ValidationMessages,{validationMessages:d}),(0,x.jsx)(P.RowButtons,{Primary:T,onClear:C,onClose:c})]})},Y=t=>{let{store:e,onRename:o,msgOnIsEmptyName:s,msgOnNotSelect:n,actionCompleted:i,actionFailed:r,forActionType:l,onClose:c}=t;const[u,p]=(0,a.useState)((()=>e.getWatchGroups())),[d,h]=(0,a.useState)([]),m=(0,a.useRef)(),[C,g]=k(h),f=(0,a.useCallback)((()=>{const{captionGroup:t,captionList:e}=m.current.getValue(),i=C.current.getValue();if(t&&e&&i)o({captionGroup:t,captionListFrom:e,captionListTo:i});else{const o=[];t||o.push(n("Group")),e||o.push(n("List From")),i||o.push(s("List To")),h(o)}}),[]),j=(0,a.useMemo)((()=>(0,x.jsx)(P.Button.Primary,{caption:"Edit",title:"Edit List Name",onClick:f})),[f]);return(0,Z.Z)(((t,o)=>{t===i?(o.forActionType===l&&g(),p(e.getWatchGroups())):t===r&&o.forActionType===l&&h(o.messages)})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.SelectGroupList,{ref:m,store:e,groupCaption:"In Group:",groupOptions:u,listCaption:"List From:"}),(0,x.jsx)(P.RowInputText,{ref:C,caption:"List To:"}),(0,x.jsx)(P.ValidationMessages,{validationMessages:d}),(0,x.jsx)(P.RowButtons,{Primary:j,onClear:g,onClose:c})]})},tt=t=>{let{store:e,actionCompleted:o,forActionType:s,onDelete:n,msgOnNotSelect:i,onClose:r}=t;const[l,c]=(0,a.useState)((()=>e.getWatchGroups())),[u,p]=(0,a.useState)([]),d=(0,a.useRef)(),h=(0,a.useCallback)((()=>p([])),[]),m=(0,a.useCallback)((()=>{const{captionGroup:t,captionList:e}=d.current.getValue();if(t&&e)n({captionGroup:t,captionList:e});else{const o=[];t||o.push(i("Group")),e||o.push(i("List")),p(o)}}),[]),C=(0,a.useMemo)((()=>(0,x.jsx)(P.Button.Primary,{caption:"Delete",title:"Delete List",onClick:m})),[m]);return(0,Z.Z)(((t,n)=>{t===o&&(n.forActionType===s&&h(),c(e.getWatchGroups()))})),(0,x.jsxs)("div",{children:[(0,x.jsx)(P.SelectGroupList,{ref:d,store:e,groupCaption:"In Group:",groupOptions:l,listCaption:"List:"}),(0,x.jsx)(P.ValidationMessages,{validationMessages:u}),(0,x.jsx)(P.RowButtons,{Primary:C,onClear:h,onClose:r})]})},et=w.e4[w.Nf],ot=w.e4[w.gm],st=w.e4[w.of],nt=(t,e)=>t.isShow===e.isShow,it={LoadItem:T,EditGroup:J,EditList:(0,a.memo)((t=>{let{isShow:e,store:o,onClose:s}=t;return(0,x.jsx)(d.Z,{caption:"Watch Lists Edit",isShow:e,isWithButton:!1,onClose:s,children:(0,x.jsxs)(y.Z,{width:380,children:[(0,x.jsx)(R.Z,{title:"Create",children:(0,x.jsx)(K,{store:o,actionCompleted:w.$0,actionFailed:w.db,forActionType:w.Nf,msgOnNotSelect:S.xW,msgOnIsEmptyName:S.eT,onCreate:et,onClose:s})}),(0,x.jsx)(R.Z,{title:"Rename",children:(0,x.jsx)(Y,{store:o,actionCompleted:w.$0,actionFailed:w.db,forActionType:w.gm,msgOnNotSelect:S.xW,msgOnIsEmptyName:S.eT,onRename:ot,onClose:s})}),(0,x.jsx)(R.Z,{title:"Delete",children:(0,x.jsx)(tt,{store:o,actionCompleted:w.$0,actionFailed:w.db,forActionType:w.of,msgOnNotSelect:S.xW,onDelete:st,onClose:s})})]})})}),nt)}}}]);